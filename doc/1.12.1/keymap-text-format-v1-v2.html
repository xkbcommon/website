<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libxkbcommon: The XKB keymap text format, V1 and V2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libxkbcommon<span id="projectnumber">&#160;1.12.1</span>
   </div>
   <div id="projectbrief">Library implementing the XKB specification for parsing                           keyboard descriptions and handling keyboard state</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">The XKB keymap text format, V1 and V2 </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#terminology">Terminology </a>
  </li>
  <li class="level1">
    <a href="#introduction-to-the-xkb-text-format">Introduction to the XKB text format </a>
    <ul>
      <li class="level2">
        <a href="#xkb-file">XKB file </a>
      </li>
      <li class="level2">
        <a href="#keymap-components-intro">Keymap components </a>
      </li>
      <li class="level2">
        <a href="#comments">Comments </a>
      </li>
      <li class="level2">
        <a href="#literals">Literals </a>
      </li>
      <li class="level2">
        <a href="#keysym-syntax">Keysyms </a>
      </li>
      <li class="level2">
        <a href="#keywords">Keywords </a>
      </li>
      <li class="level2">
        <a href="#built-in-settings">Built-in settings </a>
      </li>
      <li class="level2">
        <a href="#merge-mode-def">Merge modes </a>
      </li>
      <li class="level2">
        <a href="#xkb-include">The include mechanism </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_keymap-block">The ‚Äúxkb_keymap‚Äù block </a>
  </li>
  <li class="level1">
    <a href="#section-flags-def">Section flags </a>
    <ul>
      <li class="level2">
        <a href="#generic-flags">Generic flags </a>
      </li>
      <li class="level2">
        <a href="#symbols-flags">Symbols flags </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_keycodes-section">The ‚Äúxkb_keycodes‚Äù section </a>
    <ul>
      <li class="level2">
        <a href="#keycode-statements">Keycode statements </a>
      </li>
      <li class="level2">
        <a href="#keycode-alias">Alias statements </a>
      </li>
      <li class="level2">
        <a href="#indicator-name">LED name statements </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_types-section">The ‚Äúxkb_types‚Äù section </a>
    <ul>
      <li class="level2">
        <a href="#how-key-types-work">How key types work </a>
      </li>
      <li class="level2">
        <a href="#key-type-statement">Type definitions </a>
      </li>
      <li class="level2">
        <a href="#key-type-examples">Key types examples </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_compat-section">The ‚Äúxkb_compat‚Äù section </a>
    <ul>
      <li class="level2">
        <a href="#interpret-statements">Interpret statements </a>
      </li>
      <li class="level2">
        <a href="#indicator-effect">LED map statements </a>
      </li>
      <li class="level2">
        <a href="#set-default-values-1">Set default values </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_symbols-section">The ‚Äúxkb_symbols‚Äù section </a>
    <ul>
      <li class="level2">
        <a href="#name-statements">Name statements </a>
      </li>
      <li class="level2">
        <a href="#key-statement">Key statement </a>
      </li>
      <li class="level2">
        <a href="#modmap-statement">Real Modifier map </a>
      </li>
      <li class="level2">
        <a href="#set-default-values-2">Set default values </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#modifiers-declaration-and-binding">Modifiers declaration and binding </a>
    <ul>
      <li class="level2">
        <a href="#real-and-virtual-modifiers">Real and virtual modifiers </a>
      </li>
      <li class="level2">
        <a href="#virtual-modifier-statements">Modifiers declarations </a>
      </li>
      <li class="level2">
        <a href="#modifiers-bindings">Modifiers key bindings </a>
      </li>
      <li class="level2">
        <a href="#modifiers-encoding">Modifiers encoding </a>
      </li>
      <li class="level2">
        <a href="#canonical-and-non-canonical-modifiers">Canonical and non-canonical modifiers </a>
      </li>
      <li class="level2">
        <a href="#usual-modifiers-keysyms">Usual modifiers and associated keysyms </a>
      </li>
      <li class="level2">
        <a href="#modifiers-portability">Modifiers portability </a>
      </li>
      <li class="level2">
        <a href="#example-define-and-use-a-modifier-step-by-step">Example: define and use a modifier, step by step </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#key-actions">Key actions </a>
    <ul>
      <li class="level2">
        <a href="#ineffectual-actions">Ineffectual actions </a>
      </li>
      <li class="level2">
        <a href="#modifiers-actions">Modifiers actions </a>
      </li>
      <li class="level2">
        <a href="#group-actions">Group actions </a>
      </li>
      <li class="level2">
        <a href="#legacy-x11-actions">Legacy X11 actions </a>
      </li>
      <li class="level2">
        <a href="#unsupported-legacy-x11-actions">Unsupported legacy X11 actions </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_geometry-section">The ‚Äúxkb_geometry‚Äù section </a>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_2keymap-text-format-v1-v2"></a></p>
<p>This document describes the following <a class="el" href="#keymap-def">keymap</a> formats, as implemented by libxkbcommon:</p>
<dl>
<dt><span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3ad63ee709a87611a89b42c3e1275347ed" title="The classic XKB text format, as generated by xkbcomp -xkb.">XKB_KEYMAP_FORMAT_TEXT_V1</a></span><a class="anchor" id="keymap-text-format-v1"></a> </dt>
<dd><p class="startdd"></p>
<p class="enddd">The classic XKB text format, as generated by <span class="tt">xkbcomp -xkb</span>. See <a class="el" href="xkbcommon-compatibility.html">XKB Compatibility</a> for further information.  </p>
</dd>
<dt><span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span><a class="anchor" id="keymap-text-format-v2"></a> </dt>
<dd><p class="startdd"></p>
<p class="enddd">Xkbcommon extensions of the classic XKB text format, <b>incompatible with X11</b>. See <a class="el" href="xkbcommon-compatibility.html">XKB Compatibility</a> for further information.  </p>
</dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>For an overview of the role of this format, please see ‚Äú<a class="el" href="xkb-intro.html#xkb-the-config">XKB the keyboard keymap configuration</a>‚Äù.</dd>
<dd>
For examples of keymaps in this format, please see ‚Äú<a class="el" href="user-configuration.html">User-configuration</a>‚Äù. For further examples see <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a>, the standard database of keyboard configuration data.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Due to the complexity of the format, this document is still is construction. Some additional resources are:</dd>
<dd>
<ul>
<li><a href="https://web.archive.org/web/20190724015820/http://pascal.tsu.ru/en/xkb/">Ivan Pascal‚Äôs XKB documentation</a></li>
<li><a href="https://www.charvolant.org/doug/xkb/html/index.html">An Unreliable Guide to XKB Configuration</a></li>
<li><a href="https://www.x.org/releases/current/doc/kbproto/xkbproto.html">The X Keyboard Extension: Protocol Specification</a></li>
<li><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/master/docs/README.enhancing">How to enhance XKB configuration</a></li>
<li><a href="https://wiki.archlinux.org/index.php/X_keyboard_extension">ArchWiki XKB page</a></li>
</ul>
</dd></dl>
<h1 class="doxsection"><a class="anchor" id="terminology"></a>
Terminology</h1>
<dl>
<dt><a class="anchor" id="keycode-def"></a>Keycode</dt>
<dd></dd>
<dt></dt>
<dd><p class="startdd">Code that identifies a physical key on a keyboard.</p>
<ul>
<li><em>Raw</em> keycodes are the numeric identifiers used as input in XKB. They are the result of the low-level processing of the data that keyboards send to a computer. For instance <span class="tt">36</span> may represent the return key.</li>
<li><em>XKB</em> keycodes are <em>symbolic</em> names assigned to raw keycodes in order to facilitate their mapping to symbols. For instance the keycode for the return key is the abbreviation <span class="tt">RTRN</span>.</li>
</ul>
<p class="enddd">See <a class="el" href="#the-xkb_keycodes-section">xkb_keycodes</a> for further details.  </p>
</dd>
<dt><a class="anchor" id="keysym-def"></a>Symbols </dt>
<dd><p class="startdd">A <em>keysym</em> (short for ‚Äúkey symbol‚Äù) is a numeric encoding of a symbol on the cap of a key.</p>
<p class="interdd">Some keysyms have a canonical name for convenience. The complete list of canonical names is defined in <span class="tt"><a class="el" href="xkbcommon-keysyms_8h.html" title="Key symbols (keysyms) definitions.">xkbcommon/xkbcommon-keysyms.h</a></span>.</p>
<p class="interdd">Common types of keysyms are:</p>
<ul>
<li>A <em>character:</em> e.g. <span class="tt">a</span> and <span class="tt">A</span> for Latin scripts, <span class="tt">alpha</span> ‚ÄúŒ±‚Äù and <span class="tt">ALPHA</span> ‚ÄúŒë‚Äù for Greek, etc.</li>
<li><p class="startli">A <em>dead key:</em> e.g. <span class="tt">dead_grave</span> and <span class="tt">dead_diaeresis</span>, corresponding respectively to the <a href="https://en.wikipedia.org/wiki/Grave_accent">grave accent</a> and the <a href="https://en.wikipedia.org/wiki/Diaeresis_%28diacritic%29">diaeresis</a> diacritics.</p>
<p class="startli">A <a href="https://en.wikipedia.org/wiki/Dead_key">dead key</a> is a special kind of key that does not generate a character by itself, but modifies the character generated by the key struck(s) immediately after.</p>
</li>
<li>A <em><a class="el" href="#modifier-def">modifier</a>‚Å†:</em> e.g. <span class="tt">Shift_L</span>, <span class="tt">Control_R</span>, <span class="tt">Caps_Lock</span>. See hereinafter.</li>
<li>A <em>system action:</em> e.g. the arrow <span class="tt">Left</span>, <span class="tt">Pause</span>, <span class="tt">Escape</span>, <span class="tt">F1</span>.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a> for further details on binding <a class="el" href="group__keysyms.html" title="Utility functions related to keysyms (short for ‚Äúkey symbols‚Äù).">Keysyms</a> to keycodes. </dd>
<dd>
[Keysym syntax][<a class="el" href="#keysym-syntax">Keysyms</a>]  </dd></dl>
</dd>
<dt><a class="anchor" id="modifier-def"></a>Modifier </dt>
<dd><p class="startdd">A <em>modifier key</em> is a key that modifies the effect of other keys: e.g. Shift, Control, Caps Lock, etc.</p>
<p class="interdd">The state of a modifier key (active/inactive) is encoded as a <em>modifier index</em> (or modifier bit or simply modifier) and has an associated <em>unique name</em>.</p>
<p class="interdd">For historical reasons, modifiers are divided in two categories:</p>
<dl>
<dt><a class="anchor" id="real-modifier-def"></a>Real modifiers </dt>
<dd><p class="startdd">They are the 8 <em>predefined</em> (AKA <em>core</em>, <em>X11</em>) modifiers (see <a class="el" href="#usual-modifiers">usual modifiers</a> hereinafter).</p>
<p class="interdd">Real modifiers ensure backward compatibility: indeed they are the actual bits used to compute the <a class="el" href="#level-def">levels</a> and are communicated via the API of xkbcommon.</p>
<p class="enddd">Some are generic modifiers (<span class="tt">Mod[1-5]</span>) that do not have a conventional interpretation and are the motivation of the introduction of <a class="el" href="#virtual-modifier-def">virtual modifiers</a>.  </p>
</dd>
<dt><a class="anchor" id="virtual-modifier-def"></a>Virtual modifiers </dt>
<dd>They are the modifiers that are <em>not</em> predefined.  </dd>
</dl>
<p class="interdd">Each modifier has an associated <a class="el" href="#modifiers-encoding">encoding</a>. In keymaps compatible with X11, the encoding can be interpreted as a <em>mapping</em> to one or multiple <em>real</em> modifier. Real modifiers map to themselves: they are <a class="el" href="#canonical-modifier-def">canonical modifiers</a>. See the ‚Äú<a class="el" href="#modifiers-encoding">Modifiers encoding</a>‚Äù section for further information.</p>
<p class="interdd">The following table lists the <a class="anchor" id="usual-modifiers"></a>usual modifiers present in the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">standard keyboard configuration</a>. Note that this is provided for information only, as it may change depending on the user configuration.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Modifier  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Usual mapping  </th><th class="markdownTableHeadNone">Comment  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span> (fixed)  </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Control_key">Shift</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> (fixed)  </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Caps_Lock">Caps Lock</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Control</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">Control</span> (fixed)  </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Control_key">Control</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod1</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">Mod1</span> (fixed)  </td><td class="markdownTableBodyNone">Not conventional  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Mod2</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">Mod2</span> (fixed)  </td><td class="markdownTableBodyNone">Not conventional  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod3</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">Mod3</span> (fixed)  </td><td class="markdownTableBodyNone">Not conventional  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Mod4</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">Mod4</span> (fixed)  </td><td class="markdownTableBodyNone">Not conventional  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod5</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">Mod5</span> (fixed)  </td><td class="markdownTableBodyNone">Not conventional  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Alt</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">Mod1</span>  </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Alt_key">Alt</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Meta</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">Mod1</span>  </td><td class="markdownTableBodyNone">The legacy <a href="https://en.wikipedia.org/wiki/Meta_key">Meta</a> key  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">NumLock</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">Mod2</span>  </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Num_Lock">NumLock</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Super</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">Mod4</span>  </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Super_key_(keyboard_button)">Super</a>/GUI  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">Mod5</span>  </td><td class="markdownTableBodyNone"><a href="https://en.wikipedia.org/wiki/ISO/IEC_9995">ISO</a> level 3, aka <a href="https://en.wikipedia.org/wiki/AltGr_key">AltGr</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelFive</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">Mod3</span>  </td><td class="markdownTableBodyNone"><a href="https://en.wikipedia.org/wiki/ISO/IEC_9995">ISO</a> level 5  </td></tr>
</table>
<p class="interdd">A modifier key can report its state in one of the following 3 ways:</p>
<dl>
<dt><a class="anchor" id="depressed-mod-def"></a>Depressed </dt>
<dd>Active while depressed; e.g. the usual Shift. </dd>
<dt><a class="anchor" id="latched-mod-def"></a>Latched </dt>
<dd>Activated when pressed and deactivated after the next non-modifier key press.  </dd>
<dt><a class="anchor" id="locked-mod-def"></a>Locked </dt>
<dd>Activated when pressed and deactivated when pressed again; e.g. the usual Caps Lock.  </dd>
</dl>
<p class="interdd">See <a class="el" href="#modifiers-declaration-and-binding">modifiers declaration and binding</a> for further details. </p>
<p class="enddd"></p>
</dd>
<dt><a class="anchor" id="level-def"></a>Shift Level </dt>
<dd><p class="startdd">A key may produce different results depending of the active modifiers: e.g. for a Latin script, pressing the key A produces ‚Äúa‚Äù and holding Shift while pressing A produces ‚ÄúA‚Äù.</p>
<p class="interdd">This various results are organized in an ordered list; the <em>index</em> of each entry is called a <a class="anchor" id="level-index-def"></a>shift level or simply level. By convention the lowest level is the result when no modifier is active. Example for the key <span class="tt">A</span> on a latin script keyboard:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Level  </th><th class="markdownTableHeadNone">Description  </th><th class="markdownTableHeadNone">Keysym  </th><th class="markdownTableHeadNone">Active key modifiers  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">Lower case letters  </td><td class="markdownTableBodyNone"><span class="tt">a</span>  </td><td class="markdownTableBodyNone">None  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone">Upper case letters.  </td><td class="markdownTableBodyNone"><span class="tt">A</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone">Alternative lower case letters  </td><td class="markdownTableBodyNone"><span class="tt">ae</span>  </td><td class="markdownTableBodyNone"><span class="tt">AltGr</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone">Alternative upper case letters  </td><td class="markdownTableBodyNone"><span class="tt">AE</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span> + <span class="tt">AltGr</span>  </td></tr>
</table>
<p class="interdd">A key shift level is the logical <em>state</em> of a key corresponding to the current shift level it used.</p>
<p class="interdd">Key shift levels are derived from the modifiers states, but not necessarily in the same way for all keys. For example, for Latin script the Caps Lock modifier selects the level 2 for alphabetic keys such as <span class="tt">A</span> but has no effect on a numeric key.</p>
<p class="enddd">There are groups of keys with the same characteristics: letters, punctuation, numeric keypad, etc. The meaning of their levels is identical and thus can be shared: this generalization is called a <em>key type</em> (see hereinafter).  </p>
</dd>
<dt><a class="anchor" id="key-type-def"></a>Key type </dt>
<dd><p class="startdd">A key type defines the levels available for a key and how to derive the active level from the modifiers states. Examples:</p><ul>
<li><span class="tt">ONE_LEVEL</span>: the key has only one level, i.e. it is not affected by any modifiers. Example: the modifiers themselves.</li>
<li><a class="el" href="#TWO_LEVEL"><span class="tt">TWO_LEVEL</span></a>: the key has two levels:<ul>
<li>Level 1: default level, active when the <span class="tt">Shift</span> modifier is <em>not</em> active.</li>
<li>Level 2: level activated with the <span class="tt">Shift</span> modifier.</li>
</ul>
</li>
<li><a class="el" href="#FOUR_LEVEL"><span class="tt">FOUR_LEVEL</span></a>: see the example in the previous section.</li>
</ul>
<p class="enddd">See <a class="el" href="#the-xkb_types-section">xkb_types</a> for further details.  </p>
</dd>
<dt><a class="anchor" id="layout-def"></a>Layout </dt>
<dd><p class="startdd">A mapping of keycodes to symbols, actions and key types.</p>
<p class="interdd">A user who deals with multiple languages may need two or more different layouts: e.g. a layout for Arabic and another one for English. In this context, layouts are called <em>groups</em> in XKB, as defined in the <a href="https://en.wikipedia.org/wiki/ISO/IEC_9995">standard ISO/IEC&#160;9995</a>.</p>
<p class="interdd">Layouts are ordered and identified by their index. Example:</p>
<ul>
<li>Layout 1: Arabic</li>
<li>Layout 2: English</li>
</ul>
<p class="enddd"></p>
</dd>
<dt><a class="anchor" id="key-action-def"></a>Key Action </dt>
<dd><p class="startdd">In XKB world, a key action defines the effect a key has on the state of the keyboard or the state of the display server. Examples:</p>
<ul>
<li>Change the state of a modifier.</li>
<li>Change the active group.</li>
<li>Move the mouse pointer.</li>
</ul>
<p class="enddd">See the section ‚Äú<a class="el" href="#key-actions">Key actions</a>‚Äù for further details.  </p>
</dd>
<dt><a class="anchor" id="indicator-def"></a>Indicator </dt>
<dd><p class="startdd">A keyboard indicator is a mean to report a specific aspect of the keyboard state.</p>
<dl>
<dt><em>Physical</em> indicator </dt>
<dd>Typically a labelled LED on the keyboard, e.g. ‚ÄúCaps Lock‚Äù and ‚ÄúNum Lock‚Äù.  </dd>
<dt><em>Logical</em> indicator </dt>
<dd><p class="startdd">A customizable derived state of the keyboard. Its changes creates events that can be monitored.</p>
<p class="interdd">There are two categories:</p>
<ul>
<li><p class="startli"><em>Real</em> indicators are those associated to a physical indicator. For example, the ‚ÄúCaps Lock‚Äù logical modifier controls the corresponding physical LED.</p>
<p class="startli">Because indicators are customizable, if one misses a ‚ÄúNum Lock‚Äù LED, one could define instead the ‚ÄúCaps Lock‚Äù <em>indicator</em> to activate its LED when the ‚ÄúNum Lock‚Äù <em>modifier</em> is active.</p>
</li>
<li><em>Virtual</em> indicators are not associated to a physical indicator. Their effect is only visible for programs monitoring them.</li>
</ul>
<p class="enddd">Note that the meanings of <em>real</em> and <em>virtual</em> is slightly different than the one used for <a class="el" href="#modifier-def">modifier</a>.  </p>
</dd>
</dl>
<p class="enddd">See: <code><a class="el" href="#indicator-name">xkb_keycodes</a></code> to define indicators and <code><a class="el" href="#indicator-effect">xkb_compat</a></code> to define their effects.  </p>
</dd>
<dt><a class="anchor" id="keymap-def"></a>Keymap </dt>
<dd><p class="startdd">The <em>complete</em> definition of the mapping of raw keycodes to symbols and actions. It fully defines the behavior of a keyboard.</p>
<p class="interdd">Depending of the context, a keymap may refer to:</p>
<ul>
<li>the software object defined and managed by libxkbcommon;</li>
<li>the text configuration used to create this software object.</li>
</ul>
<p class="enddd">See <a class="el" href="#keymap-components-intro">Keymap components</a> and <a class="el" href="#the-xkb_keymap-block">xkb_keymap</a> for further details.  </p>
</dd>
<dt>Keyboard configuration database<a class="anchor" id="database-def"></a> </dt>
<dd>A database that provides the <a class="el" href="#keymap-components-intro">keymap components</a>. *nix OSs uses the <em>standard</em> database <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a>. One may extend this database with <em>custom</em> layouts: see ‚Äú<a class="el" href="user-configuration.html">User-configuration</a>‚Äù for further details.  </dd>
</dl>
<h1 class="doxsection"><a class="anchor" id="introduction-to-the-xkb-text-format"></a>
Introduction to the XKB text format</h1>
<p>The XKB text format uses a syntax similar to the <a href="https://en.wikipedia.org/wiki/C_(programming_language)#Syntax">C programming language</a>. Note that the similarity with C stops here: the XKB text format is only a <em>configuration</em> format and is not intended for programming.</p>
<p>The XKB text format is used to configure a <em>keyboard keymap</em>, which is introduced in ‚Äú<a class="el" href="xkb-intro.html#xkb-the-config">XKB the keyboard keymap configuration</a>‚Äù. It has the following two main use cases, illustrated in the <a class="el" href="#xkb-keymap-components-diagram">diagram hereinafter</a>:</p>
<ul>
<li><p class="startli"><b>Server:</b> Load a keymap from the keymap configuration database, then handle input events by updating the keyboard state. The keymap is assembled from an <a class="el" href="xkb-intro.html#RMLVO-intro">RMLVO configuration</a> and its corresponding <b><a class="el" href="xkb-intro.html#KcCGST-intro">KcCGST components</a></b> files.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keymap.html#gab500a4d834bb839067c5c5fc2144d457" title="Create a keymap from RMLVO names.">xkb_keymap::xkb_keymap_new_from_names2</a></dd>
<dd>
<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> for the implementation of the <em>standard</em> <a class="el" href="group__keymap.html" title="Creating and destroying keymaps.">Keymap Creation</a> configuration database.</dd>
<dd>
‚Äú<a class="el" href="user-configuration.html">User-configuration</a>‚Äù to add a <em>custom</em> layout or option.</dd></dl>
</li>
<li><p class="startli"><b>Client:</b> Load the active keymap from the server, then handle update events sent by the server. The <b><a class="el" href="xkb-intro.html#keymap-intro">complete keymap</a></b> is directly available in a <em>self-contained</em> file.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keymap.html#ga8d47182d367aa041b380fb49a61660bd" title="Create a keymap from a keymap string.">xkb_keymap::xkb_keymap_new_from_string</a></dd></dl>
<p><a class="anchor" id="xkb-keymap-components-diagram"></a></p><div class="dotgraph">
<iframe scrolling="no" loading="lazy" frameborder="0" src="dot_xkb-keymap-components.svg" width="846" height="316"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
XKB text format use cases</div>
</div>
</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="xkb-file"></a>
XKB file</h2>
<p>There are two kinds of files for the XKB text format:</p>
<dl>
<dt>Keymap file<a class="anchor" id="keymap-file-def"></a> </dt>
<dd><p class="startdd">A file with the <em>complete</em> description of the <a class="el" href="#keymap-def">keymap</a> object. It is the kind of file that the server sends to the client (see the <a class="el" href="#xkb-keymap-components-diagram">diagram</a> above). Its top-level structure consists of the <a class="el" href="#the-xkb_keymap-block">xkb_keymap</a> block. </p>
<p class="enddd"></p>
</dd>
<dt>Keymap <em>component</em> file<a class="anchor" id="keymap-component-file-def"></a> </dt>
<dd>A file with the description of a <em>particular</em> <a class="el" href="xkb-intro.html#KcCGST-intro">KcCGST component</a>. It is the kind of file that the server uses to assemble a <a class="el" href="#keymap-file-def">keymap file</a>. Its top-level structure consists of a <em>single type</em> of <a class="el" href="#keymap-section-def">keymap sections</a>. A component file may contain multiple such sections.  </dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="keymap-components-intro"></a>
Keymap components</h2>
<p><a class="el" href="#keymap-component-def">Keymap components</a> are described with <a class="el" href="#keymap-section-def">keymap sections</a>. They are grouped in <a class="el" href="#keymap-component-file-def">keymap component files</a> to form a <a class="el" href="#database-def">keyboard configuration database</a>.</p>
<dl>
<dt>Keymap <em>component</em><a class="anchor" id="keymap-component-def"></a> </dt>
<dd>A part of the keymap <em>object</em>. The set of keymap components is referred as <a class="el" href="xkb-intro.html#KcCGST-intro">KcCGST</a>. They are presented in the <a class="el" href="#keymap-components-table">table hereinafter</a>.  </dd>
<dt>Keymap <em>section</em><a class="anchor" id="keymap-section-def"></a> </dt>
<dd>A part of the keymap <em>text configuration</em> dedicated to one of the <a class="el" href="#keymap-components-table">keymap components</a>.  </dd>
<dt>Component <em>folder</em> </dt>
<dd>A folder in the <a class="el" href="#database-def">keymap configuration database</a>, dedicated to files with partial definitions of the same keymap section.  </dd>
</dl>
<p><a class="anchor" id="keymap-components-table"></a></p><table class="doxtable">
<caption>Keymap components </caption>
<tr>
<th><a class="el" href="#keymap-component-def">Component</a></th><th><a class="el" href="#keymap-section-def">Section</a> in a <a class="el" href="#the-xkb_keymap-block">keymap</a></th><th>Folder in a keymap configuration database</th><th>Description</th></tr>
<tr>
<th><u>K</u>ey <u>c</u>odes</th><td><a class="el" href="#the-xkb_keycodes-section">xkb_keycodes</a></td><td><span class="tt">keycodes</span></td><td>A translation of the raw <a class="el" href="#keycode-def">key codes</a> from the keyboard into symbolic names. </td></tr>
<tr>
<th><u>C</u>ompatibility</th><td><a class="el" href="#the-xkb_compat-section">xkb_compat</a></td><td><span class="tt">compat</span></td><td>A specification of what internal actions modifiers and various special-purpose keys produce. </td></tr>
<tr>
<th>(<u>G</u>eometry)</th><td>xkb_geometry</td><td><span class="tt">geometry</span></td><td><p class="starttd">A description of the physical layout of a keyboard.</p>
<dl class="section attention"><dt>Attention</dt><dd>This legacy feature is <a class="el" href="xkbcommon-compatibility.html#geometry-support">not supported</a> by <em>xkbcommon</em>.</dd></dl>
</td></tr>
<tr>
<th>Key <u>s</u>ymbols</th><td><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a></td><td><span class="tt">symbols</span></td><td>A translation of symbolic <a class="el" href="#keycode-def">key codes</a> into actual <a class="el" href="#keysym-def">key symbols</a> (keysyms). </td></tr>
<tr>
<th>Key <u>t</u>ypes</th><td><a class="el" href="#the-xkb_types-section">xkb_types</a></td><td><span class="tt">types</span></td><td>Types describe how a pressed key is affected by active <a class="el" href="#modifier-def">modifiers</a> such as Shift, Control, Alt, etc. </td></tr>
</table>
<h2 class="doxsection"><a class="anchor" id="comments"></a>
Comments</h2>
<p>Comments are introduced following either <span class="tt">//</span> or <span class="tt">#</span> until the end of the line.</p>
<h2 class="doxsection"><a class="anchor" id="literals"></a>
Literals</h2>
<dl>
<dt>String literal<a class="anchor" id="keymap-string-literal"></a> </dt>
<dd><p class="startdd">A string is surrounded by double quotes: ‚Äú<code>&quot;</code>‚Äù. The following <em>escape sequences</em> are supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Escape sequence  </th><th class="markdownTableHeadNone">Meaning  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">\\</span>  </td><td class="markdownTableBodyNone">Backslash ‚Äú<span class="tt">\</span>‚Äù  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">\"</span>  </td><td class="markdownTableBodyNone">Double quote ‚Äú<span class="tt">"</span>‚Äù  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">\b</span>  </td><td class="markdownTableBodyNone">Backspace  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">\e</span>  </td><td class="markdownTableBodyNone">Escape  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">\f</span>  </td><td class="markdownTableBodyNone">Form feed  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">\n</span>  </td><td class="markdownTableBodyNone">Line feed (newline)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">\r</span>  </td><td class="markdownTableBodyNone">Carriage return  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">\t</span>  </td><td class="markdownTableBodyNone">Horizontal tabulation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">\v</span>  </td><td class="markdownTableBodyNone">Vertical tabulation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">\</span> + octal number  </td><td class="markdownTableBodyNone">Corresponding ASCII character: <span class="tt">\1</span> ‚Üí <span class="tt">SOH</span>, <span class="tt">\42</span> ‚Üí <span class="tt">"</span>. Up to <b>4</b> octal digits <span class="tt">0‚Ä•7</span> are parsed. The result must fit into a byte.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">\u{</span> + hexadecimal number + <span class="tt">}</span>  </td><td class="markdownTableBodyNone"><span class="tt">\u{NNNN}</span> produce the corresponding <a href="https://en.wikipedia.org/wiki/Unicode#Codespace_and_code_points">Unicode code point</a> <span class="tt">U+NNNN</span>, encoded in <a href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a>. Supported code points are in the range <span class="tt">U+0001‚Ä•U+10FFFF</span>.  </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>The string <em>encoding</em> is unspecified and not validated, but for best results, stick to ASCII.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>&lt;1.9.0: Octal escape sequences accept up to <b>3</b> digits.</dd>
<dd>
1.9.0: Octal escape sequences accept up to <b>4</b> digits. Added <code>\&quot;</code> and <span class="tt">\u{NNNN}</span> escape sequences.</dd></dl>
</dd>
<dt>Number literal </dt>
<dd><p class="startdd">A number can be written in three forms:</p>
<ul>
<li><em>decimal integer:</em> <span class="tt">1</span>, <span class="tt">123</span>, etc.</li>
<li><em>decimal floating-point number:</em> <span class="tt">1.23</span>, etc.</li>
<li><em>hexadecimal integer:</em> prefixed with <span class="tt">0x</span>: <span class="tt">0x123</span>, <span class="tt">0xff</span>, <span class="tt">0xAB</span>, etc. </li>
</ul>
</dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="keysym-syntax"></a>
Keysyms</h2>
<p><a class="el" href="#keysym-def">Keysyms</a> may be written in multiple ways:</p>
<dl>
<dt>Name </dt>
<dd><p class="startdd"></p>
<p class="interdd">Keysym names are defined in <span class="tt"><a class="el" href="xkbcommon-keysyms_8h.html" title="Key symbols (keysyms) definitions.">xkbcommon/xkbcommon-keysyms.h</a></span>; remove the <span class="tt">XKB_KEY_</span> prefix to get the name.</p>
<p class="enddd">Example: the keysym <span class="tt">0xffbe = XKB_KEY_F1</span> has the name <span class="tt">F1</span>.  </p>
</dd>
<dt>Unicode </dt>
<dd><p class="startdd"></p>
<p class="interdd">The <em>Unicode</em> syntax <span class="tt">Unnnn</span> denotes a keysym whose corresponding character is the Unicode code point <span class="tt">U+nnnn</span>, where <span class="tt">nnnn</span> is an hexadecimal number in the range <span class="tt">0x100 .. 0x10ffff</span>. The resulting keysym value is <span class="tt">0x01000000 + nnnn</span>.</p>
<p class="enddd">Example: <span class="tt">U1F3BA</span> has value <span class="tt">0x0101F3BA</span> and corresponds to the code point <span class="tt">U+1F3BA</span>: ‚Äòüé∫‚Äô (TRUMPET).  </p>
</dd>
<dt>String literal </dt>
<dd><p class="startdd"></p>
<p class="interdd">A keysym or list of keysyms can be written as a <em>string literal</em>, with the following semantics:</p>
<ol type="1">
<li>The string must be encoded in UTF-8.</li>
<li>If the encoding is invalid, it raises a syntax error.</li>
<li>If the string expands to 0 Unicode code point, the resulting keysym is <span class="tt">NoSymbol</span>.</li>
<li>If the string expands to 1 Unicode code point, the resulting keysym is the output of <span class="tt"><a class="el" href="group__keysyms.html#ga5fde9cc397ae996b4efac56c9cd6bd18" title="Get the keysym corresponding to a Unicode/UTF-32 codepoint.">xkb_utf32_to_keysym</a></span>.</li>
<li><p class="startli">Otherwise the string expands to a list <span class="tt">{ ... }</span> with each Unicode code point converted via <span class="tt"><a class="el" href="group__keysyms.html#ga5fde9cc397ae996b4efac56c9cd6bd18" title="Get the keysym corresponding to a Unicode/UTF-32 codepoint.">xkb_utf32_to_keysym</a></span>.</p>
<dl class="section note"><dt>Note</dt><dd>This is only possible where multiple keysyms is valid, e.g. in the <a class="el" href="#key-multiple-symbols-per-level">key symbols</a>.</dd></dl>
<p>Examples:</p>
</li>
</ol>
<table class="doxtable">
<tr>
<th>Keysym string</th><th>Keysym name</th><th>Keysym value</th></tr>
<tr>
<td><span class="tt">""</span></td><td><span class="tt">NoSymbol</span></td><td><span class="tt">0x0000</span></td></tr>
<tr>
<td><span class="tt">"a"</span></td><td><span class="tt">a</span></td><td><span class="tt">0x0061</span></td></tr>
<tr>
<td><span class="tt">"√º"</span></td><td><span class="tt">udiaeresis</span></td><td><span class="tt">0x00dc</span></td></tr>
<tr>
<td><span class="tt">"üé∫"</span></td><td><span class="tt">U1F3BA</span></td><td><span class="tt">0x0101F3BA</span></td></tr>
<tr>
<td><span class="tt">"gÃÉ"</span></td><td><span class="tt">{g, combining_tilde}</span></td><td><span class="tt">{0x0101F3BA, 0x01000303}</span></td></tr>
</table>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#keysyms-string">Keysym strings</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.9.0  </dd></dl>
</dd>
<dt>Numeric value </dt>
<dd><p class="startdd"></p>
<p class="interdd">A keysym can be written directly with its <em>numeric</em> value: e.g. <span class="tt">0x61</span> is <span class="tt">a</span>.</p>
<p class="interdd">This syntax is mostly useful in the following use cases:</p><ul>
<li>the corresponding keysym has no associated name nor is in the Unicode range;</li>
<li>the corresponding keysym has/had a name but it is not supported in all the ecosystem;</li>
<li>keymap serialization by tools.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Digits <span class="tt">0 .. 9</span> have a special treatment because they are interpreted as names, not values. E.g. <span class="tt">1</span> is the keysym with name <span class="tt">1</span> and value <span class="tt">0x31</span>.</dd>
<dd>
The previous special case does not apply to integers values in range <span class="tt">0 .. 9</span> that are written with <em>2+</em> characters: e.g. <span class="tt">01</span> and <span class="tt">0x1</span> are both interpreted as the <em>unnamed</em> keysym with value <span class="tt">0x01</span>, not the keysym named <span class="tt">1</span> and with value <span class="tt">0x31</span>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Do not use this syntax to <em>manually</em> write keymap files unless there is no other option: it is the least human-friendly syntax.  </dd></dl>
</dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="keywords"></a>
Keywords</h2>
<p>The following table presents the keywords used in the format. They are <em>case-sensitive</em>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Keyword  </th><th class="markdownTableHeadNone">Use  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">action</span>  </td><td class="markdownTableBodyNone">Action of an <a class="el" href="#interpret-action">interpret statement</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">alias</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#keycode-alias">Keycode alias</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">alphanumeric_keys</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#section-flag-alphanum">Section flag</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">alternate_group</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#section-flag-alt-group">Section flag</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">alternate</span>  </td><td class="markdownTableBodyNone">Merge mode qualifier for <a class="el" href="#xkb-include">include</a> statements  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">augment</span>  </td><td class="markdownTableBodyNone">Merge mode qualifier for <a class="el" href="#xkb-include">include</a> statements  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">default</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#section-flag-default">Section flag</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">function_keys</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#section-flag-function">Section flag</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">group</span>  </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">hidden</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#section-flag-hidden">Section flag</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">include</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#xkb-include">Include statement</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">indicator</span>  </td><td class="markdownTableBodyNone">Indicator statement in either the <a class="el" href="#indicator-name">keycode section</a> or the <a class="el" href="#indicator-effect">compatibility section</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">interpret</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#interpret-statements">Interpret statement</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">key</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#key-statement">Key statement</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">keypad_keys</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#section-flag-keypad">Section flag</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">keys</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">logo</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">mod_map</span>  </td><td class="markdownTableBodyNone">Alias of <span class="tt">modifier_map</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">modifier_keys</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#section-flag-modifier">Section flag</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">modmap</span>  </td><td class="markdownTableBodyNone">Alias of <span class="tt">modifier_map</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">modifier_map</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#modmap-statement">Real modifier bindings</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">outline</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">overlay</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">override</span>  </td><td class="markdownTableBodyNone">Merge mode qualifier for <a class="el" href="#xkb-include">include</a> statements  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">partial</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#section-flag-partial">Section flag</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">replace</span>  </td><td class="markdownTableBodyNone">Merge mode qualifier for <a class="el" href="#xkb-include">include</a> statements  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">row</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">section</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">shape</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">solid</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">text</span>  </td><td class="markdownTableBodyNone">Legacy <a class="el" href="#the-xkb_geometry-section">geometry element</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">type</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#key-type-statement">Key type statement</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">virtual_modifiers</span>  </td><td class="markdownTableBodyNone"><a class="el" href="#virtual-modifier-statements">Virtual modifiers mappings</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">virtual</span>  </td><td class="markdownTableBodyNone">Flag for the <a class="el" href="#indicator-name">indicator statement</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">xkb_compat_map</span>  </td><td class="markdownTableBodyNone">Alias of <span class="tt">xkb_compatibility_map</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">xkb_compat</span>  </td><td class="markdownTableBodyNone">Alias of <span class="tt">xkb_compatibility_map</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">xkb_compatibility_map</span>  </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_compat-section">compatibility section</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">xkb_compatibility</span>  </td><td class="markdownTableBodyNone">Alias of <span class="tt">xkb_compatibility_map</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">xkb_geometry</span>  </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_geometry-section">geometry section</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">xkb_keycodes</span>  </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_keycodes-section">keycodes section</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="structxkb__keymap.html" title="Opaque compiled keymap object.">xkb_keymap</a></span>  </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_keymap-block">keymap block</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">xkb_layout</span>  </td><td class="markdownTableBodyNone">Declare a legacy <a class="el" href="#legacy-layout-section">layout compound section</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">xkb_semantics</span>  </td><td class="markdownTableBodyNone">Declare a legacy <a class="el" href="#legacy-semantics-section">semantics compound section</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">xkb_symbols</span>  </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_symbols-section">symbols section</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">xkb_types</span>  </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_types-section">key types section </a>  </td></tr>
</table>
<h2 class="doxsection"><a class="anchor" id="built-in-settings"></a>
Built-in settings</h2>
<p>There are many built-in settings; they are explained in the following relevant sections.</p>
<p>These settings are <em>case-insensitive</em>, e.g. the following strings denote the same key word: <span class="tt">SETMODS</span>, <span class="tt">SetMods</span>, <span class="tt">setMods</span> and <span class="tt">setmods</span>.</p>
<h2 class="doxsection"><a class="anchor" id="merge-mode-def"></a>
Merge modes</h2>
<p>Each statement has a <b>merge mode</b> property that defines how to handle <em>conflicts</em> with previous statements. This property can be set explicitly by prefixing the statement with one of the merge modes presented hereinafter.</p>
<dl>
<dt><a class="anchor" id="merge-mode-augment"></a>augment </dt>
<dd><p class="startdd"></p>
<p class="interdd">If two declarations conflict, update the properties which are <em>explicitly</em> defined in the <em>new</em> declaration, <em>only</em> if they were <em>implicit</em> in the <em>old</em> declaration.</p>
<div class="fragment"><div class="line">key &lt;A&gt;         { [a          , NoSymbol   , ae          ] };</div>
<div class="line">augment key &lt;A&gt; { [Greek_alpha, Greek_ALPHA, NoSymbol, AE] };</div>
<div class="line"><span class="comment">// Result</span></div>
<div class="line">key &lt;A&gt;         { [a          , Greek_ALPHA, ae      , AE] };</div>
</div><!-- fragment -->  </dd>
<dt><a class="anchor" id="merge-mode-override"></a>override </dt>
<dd><p class="startdd"></p>
<p class="interdd">If two declarations conflict, update only the properties which are <em>explicitly</em> defined in the <em>new</em> declaration.</p>
<dl class="section note"><dt>Note</dt><dd><a class="anchor" id="merge-mode-default"></a>Override is the <em>default</em> merge mode.</dd></dl>
<div class="fragment"><div class="line">key &lt;A&gt;          { [a          , NoSymbol   , ae          ] };</div>
<div class="line"><span class="comment">// Explicit merge mode</span></div>
<div class="line"><span class="keyword">override</span> key &lt;A&gt; { [Greek_alpha, Greek_ALPHA, NoSymbol, AE] };</div>
<div class="line"><span class="comment">// Result</span></div>
<div class="line">key &lt;A&gt;          { [Greek_alpha, Greek_ALPHA, ae      , AE] };</div>
</div><!-- fragment --><div class="fragment"><div class="line">key &lt;A&gt;          { [a          , NoSymbol   , ae          ] };</div>
<div class="line"><span class="comment">// Implicit merge mode is override</span></div>
<div class="line">key &lt;A&gt;          { [Greek_alpha, Greek_ALPHA, NoSymbol, AE] };</div>
<div class="line"><span class="comment">// Result</span></div>
<div class="line">key &lt;A&gt;          { [Greek_alpha, Greek_ALPHA, ae      , AE] };</div>
</div><!-- fragment -->  </dd>
<dt><a class="anchor" id="merge-mode-replace"></a>replace </dt>
<dd><p class="startdd"></p>
<p class="interdd">If two declarations conflict, ignore the old declaration and use the new one.</p>
<div class="fragment"><div class="line">key &lt;A&gt;         { [a          , NoSymbol   , ae          ] };</div>
<div class="line">replace key &lt;A&gt; { [Greek_alpha, Greek_ALPHA, NoSymbol, AE] };</div>
<div class="line"><span class="comment">// Result</span></div>
<div class="line">key &lt;A&gt;         { [Greek_alpha, Greek_ALPHA, NoSymbol, AE] };</div>
</div><!-- fragment -->  </dd>
<dt><a class="anchor" id="merge-mode-alternate"></a>alternate </dt>
<dd><p class="startdd"></p>
<p class="interdd">Legacy merge mode for keycodes. Its purpose is to allow to assign the same key name to multiple key codes, which is not allowed otherwise. This is unfortunately poorly documented and not used in xkeyboard-config. The xkblib specification implies that this was part of the overlay functionality, which is currently not supported by libxkbcommon.</p>
<dl class="section warning"><dt>Warning</dt><dd>This merge mode is not supported by libxkbcommon and is ignored.  </dd></dl>
</dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="xkb-include"></a>
The include mechanism</h2>
<h3 class="doxsection"><a class="anchor" id="syntax"></a>
Syntax</h3>
<p>Statements of the form:</p>
<div class="fragment"><div class="line"><span class="comment">// Implicit section name: use the default map</span></div>
<div class="line">include <span class="stringliteral">&quot;&lt;PATH&gt;&quot;</span></div>
<div class="line"><span class="comment">// Explicit section name</span></div>
<div class="line">include <span class="stringliteral">&quot;&lt;PATH&gt;(&lt;SECTION_NAME&gt;)&quot;</span></div>
</div><!-- fragment --><p>will merge data from another <a class="el" href="#keymap-section-def">section</a> of the <em>same type</em>, possibly located in another file. Note that the statement does not have a trailing semicolon.</p>
<p>If no section name is provided, the <a class="el" href="#default-map-def">default map</a> is looked up.</p>
<p>The path is usually relative to its corresponding directory in a XKB configuration: e.g. given the configuration directory <span class="tt">&lt;XKB&gt;</span>, files of section type <span class="tt">xkb_symbols</span> are looked up in <span class="tt">&lt;XKB&gt;/symbols</span>. Since 1.11, the paths can also be absolute or use <b>%-expansion</b>: <a class="anchor" id="keymap-include-percent-expansion"></a>     </p><dl>
<dt><span class="tt">%%</span> </dt>
<dd>A literal %. </dd>
<dt><code>%H</code> </dt>
<dd>The value of the <span class="tt">$HOME</span> environment variable. </dd>
<dt><code>%S</code> </dt>
<dd><p class="startdd">The <em>main</em> system-installed XKB directory of the corresponding <a class="el" href="#keymap-components-table">component</a> (usually <span class="tt">/usr/share/X11/xkb/&lt;component&gt;</span>).</p>
<p class="interdd">This enables e.g. to override a system file using <a class="el" href="user-configuration.html">User-configuration</a> with the exact <em>same name</em>:</p>
<div class="fragment"><div class="line"><span class="comment">// File: ~/.config/xkb/symbols/de</span></div>
<div class="line">xkb_symbols <span class="stringliteral">&quot;basic&quot;</span> {</div>
<div class="line">    <span class="comment">// Include the system file /usr/share/X11/xkb.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Note that it is not be possible to use `include &quot;de(basic)&quot;` because</span></div>
<div class="line">    <span class="comment">// it would create an include *loop*.</span></div>
<div class="line">    include <span class="stringliteral">&quot;%S/de(basic)&quot;</span></div>
<div class="line">    <span class="comment">// Override the system file entries</span></div>
<div class="line">    key &lt;AB01&gt; { [z, Z] };</div>
<div class="line">    key &lt;AD06&gt; { [y, Y] };</div>
<div class="line">}</div>
</div><!-- fragment -->  </dd>
<dt><code>%E</code> </dt>
<dd>The <em>extra</em> system-wide XKB directory of the corresponding <a class="el" href="#keymap-components-table">component</a> (usually <span class="tt">/etc/xkb/&lt;component&gt;</span>).  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Absolute paths and <span class="tt">%</span>-expansion are supported by libxkbcommon but not by the legacy X11 tools.</dd></dl>
<p>The <span class="tt">include</span> keyword uses the <em>default</em> <a class="el" href="#merge-mode-def">merge mode</a>. The following keywords can be used instead to use the corresponding <em>explicit</em> <a class="el" href="#merge-mode-def">merge modes</a>:</p><ul>
<li><a class="el" href="#merge-mode-augment"><span class="tt">augment</span></a></li>
<li><a class="el" href="#merge-mode-override"><span class="tt">override</span></a></li>
<li><a class="el" href="#merge-mode-replace"><span class="tt">replace</span></a></li>
</ul>
<p><em>Multiple files</em> can be included using the same statement. They are separated using one of the following <a class="el" href="#merge-mode-def">merge mode</a> prefixes:</p><ul>
<li>‚Äò|‚Äô selects the <b><a class="el" href="#merge-mode-augment">augment</a></b> merge mode.</li>
<li>‚Äò+‚Äô selects the <b><a class="el" href="#merge-mode-override">override</a></b> merge mode (default).</li>
<li>‚Äò^‚Äô selects the <b><a class="el" href="#merge-mode-replace">replace</a></b> merge mode.</li>
</ul>
<p>The following example illustrates the complete syntax:</p>
<div class="fragment"><div class="line"><span class="comment">// Default merge mode, 1 file with an implicit section name</span></div>
<div class="line">include <span class="stringliteral">&quot;&lt;PATH&gt;&quot;</span></div>
<div class="line"><span class="comment">// Augment merge mode, 1 file with an implicit section name</span></div>
<div class="line">augment <span class="stringliteral">&quot;&lt;PATH&gt;(&lt;SECTION_NAME&gt;)&quot;</span></div>
<div class="line"><span class="comment">// Absolute path and %-expansion</span></div>
<div class="line">include <span class="stringliteral">&quot;/usr/share/X11/xkb/symbols/pc&quot;</span></div>
<div class="line">include <span class="stringliteral">&quot;%S/pc&quot;</span></div>
<div class="line"><span class="comment">// Override merge mode, 2 files: a first file with an implicit section name merged</span></div>
<div class="line"><span class="comment">// using the augment mode with a second file with an explicit section name</span></div>
<div class="line"><span class="keyword">override</span> <span class="stringliteral">&quot;&lt;PATH_1&gt;|&lt;PATH_2&gt;(&lt;SECTION_NAME&gt;)</span></div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="processing"></a>
Processing</h3>
<dl class="section important"><dt>Important</dt><dd>Since xkbcommon 1.9.0 the included files are processed in <em>isolation</em> and are not affected by the parent file (e.g. defaults), except for the virtual modifiers indices.</dd>
<dd>
Since xkbcommon 1.9.0 local merge modes are <em>not</em> propagated outside the section scope, i.e. an included file does not leaks its local merge modes to its parent.</dd></dl>
<p>The statement is processed as follow:</p><ol type="1">
<li>Set PARENT as the current <a class="el" href="#keymap-section-def">section</a> containing the include statement.</li>
<li>Set INCLUDED_MERGE_MODE to the merge mode corresponding to the keyword.</li>
<li>Initialize an empty <a class="el" href="#keymap-section-def">section</a> as INCLUDED.</li>
<li>Select the first file as the current file to process.</li>
<li>Set CURRENT_MERGE_MODE to the merge mode corresponding to the current file merge mode <em>prefix</em>.</li>
<li><p class="startli">The current file path is searched sequentially in the [XKB configuration path list]:</p><ul>
<li>If a section name is provided, select the first <em>exact match</em> of file + section.</li>
<li>If no section name is provided, select the first <em>explicit</em> <a class="el" href="#default-map-def">default map</a> in matched files, else if no exact match was found in the path list, then fallback to the first <em>implicit</em> <a class="el" href="#default-map-def">default map</a> as a weak match.</li>
</ul>
<p class="startli">Then if no match is found, raise an error; else go to the next step.</p>
</li>
<li>The current file is processed and results in the CURRENT <a class="el" href="#keymap-section-def">section</a>.</li>
<li>The INCLUDED <a class="el" href="#keymap-section-def">section</a> is merged with the CURRENT <a class="el" href="#keymap-section-def">section</a> using the merge mode CURRENT_MERGE_MODE.</li>
<li>If they are more files, select the next file as the current file and go to step 5). Else go to step 10).</li>
<li>Once all files have been processed, merge PARENT with INCLUDED using the merge mode INCLUDED_MERGE_MODE.</li>
</ol>
<h3 class="doxsection"><a class="anchor" id="example-include-path-list"></a>
Example: include path list</h3>
<p>Let‚Äôs illustrate using the following <a class="el" href="group__include-path.html#ga936bed6869d76fee6f432dfb9778a3b6">XKB configuration path list</a>:</p><ol type="1">
<li><span class="tt">/home/&lt;USER&gt;/.config/xkb</span>: user configuration directory (see <a class="el" href="user-configuration.html">User-configuration</a>).</li>
<li><span class="tt">/usr/share/X11/xkb</span>: system directory.</li>
</ol>
<p>The relevant directory structure is:</p><ul>
<li><span class="tt">/home/&lt;USER&gt;/.config/xkb</span><ul>
<li><span class="tt">symbols</span><ul>
<li><span class="tt">es</span></li>
<li><span class="tt">my_own_file</span></li>
</ul>
</li>
</ul>
</li>
<li><span class="tt">/usr/share/X11/xkb</span><ul>
<li><span class="tt">symbols</span><ul>
<li><span class="tt">es</span></li>
<li><span class="tt">it</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Then the following file:</p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    include <span class="stringliteral">&quot;it&quot;</span>          <span class="comment">// Exists only in system directory</span></div>
<div class="line">    include <span class="stringliteral">&quot;my_own_file&quot;</span> <span class="comment">// Exists only in user directory</span></div>
<div class="line">    include <span class="stringliteral">&quot;es&quot;</span>          <span class="comment">// Exists in both user and system directory</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>is equivalent to:</p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    include <span class="stringliteral">&quot;/usr/share/X11/xkb/symbols/it&quot;</span></div>
<div class="line">    include <span class="stringliteral">&quot;/home/&lt;USER&gt;/.config/xkb/symbols/my_own_file&quot;</span></div>
<div class="line">    include <span class="stringliteral">&quot;/home/&lt;USER&gt;/.config/xkb/symbols/es&quot;</span></div>
<div class="line">};</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="example-simple-include"></a>
Example: simple include</h3>
<p>Given the following files:</p>
<ul>
<li><p class="startli"><span class="tt">symbols/A</span></p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    key &lt;A&gt; { [a, A, ae, AE] };</div>
<div class="line">    include <span class="stringliteral">&quot;B(S2)&quot;</span></div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><p class="startli"><span class="tt">symbols/B</span></p>
<div class="fragment"><div class="line"><span class="comment">// This section is not used (does not match)</span></div>
<div class="line">xkb_symbols <span class="stringliteral">&quot;S1&quot;</span> {</div>
<div class="line">    key &lt;B&gt; { [b, B] };</div>
<div class="line">};</div>
<div class="line"><span class="comment">// This section will be included (match the included section name)</span></div>
<div class="line">xkb_symbols <span class="stringliteral">&quot;S2&quot;</span> {</div>
<div class="line">    key &lt;A&gt; { [Greek_alpha, Greek_ALPHA] };</div>
<div class="line">    key &lt;B&gt; { [Greek_beta , Greek_BETA ] };</div>
<div class="line">};</div>
</div><!-- fragment --></li>
</ul>
<p>the resulting section in <span class="tt">A</span> will be:</p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    <span class="comment">// Key overridden: mix of old + new</span></div>
<div class="line">    key &lt;A&gt; { [Greek_alpha, Greek_ALPHA, ae, AE] };</div>
<div class="line">    <span class="comment">// New key</span></div>
<div class="line">    key &lt;B&gt; { [Greek_beta , Greek_BETA         ] };</div>
<div class="line">};</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="example-merge-modes"></a>
Example: merge modes</h3>
<p>Given the same file <span class="tt">symbols/B</span> of the previous example, the following section:</p>
<table class="doxtable">
<tr>
<th>Input</th><th>Output</th></tr>
<tr>
<td><p class="starttd"></p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    key &lt;A&gt; { [a, A, ae, AE] };</div>
<div class="line">    augment <span class="stringliteral">&quot;B(S2)&quot;</span></div>
<div class="line">};</div>
</div><!-- fragment --> </td><td><p class="starttd"></p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    <span class="comment">// Key unchanged</span></div>
<div class="line">    key &lt;A&gt; { [a, A, ae, AE] };</div>
<div class="line">    <span class="comment">// New key</span></div>
<div class="line">    key &lt;B&gt; { [Greek_beta , Greek_BETA] };</div>
<div class="line">};</div>
</div><!-- fragment --> </td></tr>
<tr>
<td><p class="starttd"></p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    key &lt;A&gt; { [a, A, ae, AE] };</div>
<div class="line">    replace <span class="stringliteral">&quot;B(S2)&quot;</span></div>
<div class="line">};</div>
</div><!-- fragment --> </td><td><p class="starttd"></p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    <span class="comment">// Key replaced</span></div>
<div class="line">    key &lt;A&gt; { Greek_alpha, Greek_ALPHA] };</div>
<div class="line">    <span class="comment">// New key</span></div>
<div class="line">    key &lt;B&gt; { [Greek_beta , Greek_BETA ] };</div>
<div class="line">};</div>
</div><!-- fragment --> </td></tr>
<tr>
<td><p class="starttd"></p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    key &lt;A&gt; { [a, A, ae, AE] };</div>
<div class="line">    <span class="comment">// Two files merged together with the merge mode</span></div>
<div class="line">    <span class="comment">// augment, then the result is merged this the</span></div>
<div class="line">    <span class="comment">// statement above using the override merge mode</span></div>
<div class="line">    include <span class="stringliteral">&quot;B(S1)|B(S2)&quot;</span></div>
<div class="line">};</div>
</div><!-- fragment --> </td><td><p class="starttd"></p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    <span class="comment">// Key overridden: mix of old + new</span></div>
<div class="line">    key &lt;A&gt; { [Greek_alpha, Greek_ALPHA, ae, AE] };</div>
<div class="line">    <span class="comment">// New key; &quot;B(2)&quot; had no effect with the</span></div>
<div class="line">    <span class="comment">// merge mode augment &quot;|&quot;</span></div>
<div class="line">    key &lt;B&gt; { [b, B] };</div>
<div class="line">};</div>
</div><!-- fragment --> </td></tr>
</table>
<h1 class="doxsection"><a class="anchor" id="the-xkb_keymap-block"></a>
The ‚Äúxkb_keymap‚Äù block</h1>
<p>A <b><a class="el" href="#keymap-file-def">keymap file</a></b> consists of a single top-level <span class="tt"><a class="el" href="structxkb__keymap.html" title="Opaque compiled keymap object.">xkb_keymap</a></span> block, under which are nested the following sections:</p>
<dl>
<dt><code><a class="el" href="#the-xkb_keycodes-section">xkb_keycodes</a></code> </dt>
<dd>A translation of the hardware/evdev scancodes from the keyboard into XKB symbolic keycodes.  </dd>
<dt><code><a class="el" href="#the-xkb_types-section">xkb_types</a></code> </dt>
<dd>A specification of the modifier mask, target level and preserved modifiers various modifiers combination produce.  </dd>
<dt><code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> </dt>
<dd>A specification of what actions various special-purpose keys produce.  </dd>
<dt><code><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a></code> </dt>
<dd>A translation of symbolic key codes into actual symbols and actions.  </dd>
</dl>
<p>Overview of a keymap file:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structxkb__keymap.html">xkb_keymap</a> {</div>
<div class="line">  xkb_keycodes <span class="stringliteral">&quot;XXX&quot;</span> {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">  }</div>
<div class="line">  xkb_types <span class="stringliteral">&quot;XXX&quot;</span> {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">  };</div>
<div class="line">  xkb_compatibility <span class="stringliteral">&quot;XXX&quot;</span> {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">  };</div>
<div class="line">  xkb_symbols <span class="stringliteral">&quot;XXX&quot;</span> {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="ttc" id="astructxkb__keymap_html"><div class="ttname"><a href="structxkb__keymap.html">xkb_keymap</a></div><div class="ttdoc">Opaque compiled keymap object.</div></div>
</div><!-- fragment --><dl class="section since"><dt>Since</dt><dd>1.9.0 All the component are optional.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>The XKB file format historically supported the following compound section types: <div><ul>
<li><span class="tt">xkb_semantics</span>:<a class="anchor" id="legacy-semantics-section"></a><em>must</em> contain a <a class="el" href="#the-xkb_compat-section">xkb_compat</a> section and <em>can</em> contain a <a class="el" href="#the-xkb_types-section">xkb_types</a> section.</li>
<li><span class="tt">xkb_layout</span>:<a class="anchor" id="legacy-layout-section"></a><em>must</em> contain <a class="el" href="#the-xkb_keycodes-section">xkb_keycodes</a>, <a class="el" href="#the-xkb_types-section">xkb_types</a> and <a class="el" href="#the-xkb_symbols-section">xkb_symbols</a> sections and <em>can</em> contain <a class="el" href="#the-xkb_geometry-section">xkb_geometry</a> section.</li>
<li><span class="tt"><a class="el" href="structxkb__keymap.html" title="Opaque compiled keymap object.">xkb_keymap</a></span>: <em>must</em> contain <a class="el" href="#the-xkb_keycodes-section">xkb_keycodes</a>, <a class="el" href="#the-xkb_compat-section">xkb_compat</a>, <a class="el" href="#the-xkb_types-section">xkb_types</a> and <a class="el" href="#the-xkb_symbols-section">xkb_symbols</a> sections and <em>can</em> contain <a class="el" href="#the-xkb_geometry-section">xkb_geometry</a> section. </li>
</ul>
</div> Since such distinction is purely semantic and would have niche use cases lost to history, these compound sections are treated equally as <span class="tt"><a class="el" href="structxkb__keymap.html" title="Opaque compiled keymap object.">xkb_keymap</a></span> in libxkbcommon.</dd></dl>
<h1 class="doxsection"><a class="anchor" id="section-flags-def"></a>
Section flags</h1>
<p>A section can have various <b>flags</b> applied to it, separated by whitespaces: </p><pre class="fragment">partial alphanumeric_keys
xkb_symbols "basic" {
    ...
}
</pre><h2 class="doxsection"><a class="anchor" id="generic-flags"></a>
Generic flags</h2>
<p>The possible flags are:</p>
<dl>
<dt><code>partial</code><a class="anchor" id="section-flag-partial"></a> </dt>
<dd>Indicates that the map doesn‚Äôt cover a complete keyboard. </dd>
<dt><code>default</code><a class="anchor" id="section-flag-default"></a> </dt>
<dd><p class="startdd"></p>
<p class="enddd"><a class="anchor" id="default-map-def"></a>Marks the symbol map as the <em>explicit</em> <b>default map</b> in the file. If no map is marked as a default, the first map in the file is the <em>implicit</em> default. Only <b>one</b> section can be marked as the default in each file.  </p>
</dd>
<dt><code>hidden</code><a class="anchor" id="section-flag-hidden"></a> </dt>
<dd>Variant that can only be used internally. </dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="symbols-flags"></a>
Symbols flags</h2>
<p>Additionally, <span class="tt">xkb_symbols</span> may also have the following flags:</p>
<dl>
<dt><code>alphanumeric_keys</code><a class="anchor" id="section-flag-alphanum"></a> </dt>
<dd>Indicates that the map contains alphanumeric keys. </dd>
<dt><code>modifier_keys</code><a class="anchor" id="section-flag-modifier"></a> </dt>
<dd>Indicates that the map contains modifier keys: Control, Shift, Alt, Meta, etc. </dd>
<dt><code>keypad_keys</code><a class="anchor" id="section-flag-keypad"></a> </dt>
<dd>Indicates that the map contains keypad keys. </dd>
<dt><code>function_keys</code><a class="anchor" id="section-flag-function"></a> </dt>
<dd>Indicates that the map contains function keys: F1, F2, etc. </dd>
<dt><code>alternate_group</code><a class="anchor" id="section-flag-alt-group"></a> </dt>
<dd>Indicates that the map contains keys for an alternate group. </dd>
</dl>
<p>If no <span class="tt">*_keys</span> flags are supplied, then the symbols section is assumed to cover a complete keyboard.</p>
<p>At present, except for <span class="tt">default</span> (see: <a class="el" href="#default-map-def">default map</a>), none of the flags affect key processing in libxkbcommon, and only serve as <em>metadata</em>.</p>
<h1 class="doxsection"><a class="anchor" id="the-xkb_keycodes-section"></a>
The ‚Äúxkb_keycodes‚Äù section</h1>
<p>This is the simplest <a class="el" href="#keymap-section-def">section</a> type, and is the first one to be compiled. The purpose of this is mostly to map between the hardware/evdev scancodes and XKB <a class="el" href="#keycode-def">keycodes</a>. Each key is given a name by which it can be referred to later, e.g. in the symbols section.</p>
<h2 class="doxsection"><a class="anchor" id="keycode-statements"></a>
Keycode statements</h2>
<p>Statements of the form: </p><pre class="fragment">&lt;TLDE&gt; = 49;
&lt;AE01&gt; = 10;
</pre><p>The above would let 49 and 10 be valid keycodes in the keymap, and assign them the names <span class="tt">TLDE</span> and <span class="tt">AE01</span> respectively. The format <span class="tt">&lt;WXYZ&gt;</span> is always used to refer to a key by name.</p>
<p>The naming convention <span class="tt">&lt;AE01&gt;</span> is based on the <a href="https://en.wikipedia.org/wiki/ISO/IEC_9995#ISO/IEC_9995-1">standard ISO/IEC&#160;9995-1</a>. It denotes the position of the key in the keyboard grid. It means: the main alphanumeric section (<span class="tt">A</span>), row <span class="tt">E</span> and column <span class="tt">01</span>.</p>
<p>The following figure illustrates the grid on a staggered standard US QWERTY keyboard. <span class="tt">&lt;AE01&gt;</span> corresponds to the key <span class="tt">1</span>.</p>
<div class="fragment"><div class="line">   \ 99 \ 00 \ 01 \ 02 \ 03 \ 04 \ 05‚Ä¶</div>
<div class="line">    \    \    \    \    \    \    \</div>
<div class="line">-----------------------------------------</div>
<div class="line">E     \    \ ^  \ 1  \ 2  \ 3  \ 4  \ 5‚Ä¶</div>
<div class="line">------------------------------------------</div>
<div class="line">D      \     Tab \ Q  \ W  \ E  \ R  \ T‚Ä¶</div>
<div class="line">-------------------------------------------</div>
<div class="line">C       \Caps     \ A  \ S  \ D  \ F  \ G‚Ä¶</div>
<div class="line">--------------------------------------------</div>
<div class="line">B        \Shift    \ Z  \ X  \ C  \ V  \ B‚Ä¶</div>
<div class="line">---------------------------------------------</div>
<div class="line">A         \Ctrl\GUI \Alt \Space‚Ä¶</div>
<div class="line">----------------------------------------------</div>
</div><!-- fragment --><p>In the common case this just maps to the evdev scancodes from <span class="tt">/usr/include/linux/input.h</span>, e.g. the following definitions: </p><pre class="fragment">#define KEY_GRAVE            41
#define KEY_1                2
</pre><p>correspond to the ones above. Similar definitions appear in the xf86-input-keyboard driver. Note that in all current keymaps there‚Äôs a constant offset of 8 (for historical reasons).</p>
<p>Note that contrary to xkbcommon, the X11 protocol supports keycodes only up to <span class="tt">255</span>. Therefore, when interfacing with X11, keymaps and applications using keycodes beyond <span class="tt">255</span> should expect warnings.</p>
<p>If there‚Äôs a conflict, like the same name given to different keycodes, or same keycode given different names, it is resolved according to the <a class="el" href="#merge-mode-def">merge mode</a> which applies to the definitions.</p>
<h2 class="doxsection"><a class="anchor" id="keycode-alias"></a>
Alias statements</h2>
<p>Statements of the form: </p><pre class="fragment">alias &lt;MENU&gt; = &lt;COMP&gt;;
</pre><p>Allows to refer to a previously defined key (here <span class="tt">&lt;COMP&gt;</span>) by another name (here <span class="tt">&lt;MENU&gt;</span>). Conflicts are handled similarly to keycode statements.</p>
<h2 class="doxsection"><a class="anchor" id="indicator-name"></a>
LED name statements</h2>
<p>Statements of the form: </p><pre class="fragment">indicator 1 = "Caps Lock";
indicator 2 = "Num Lock";
indicator 3 = "Scroll Lock";
</pre><p>Assigns a name to the keyboard LED (AKA <a class="el" href="#indicator-def">indicator</a>) with the given index. The LED may be referred by this name later in the compat section and by the user.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo</a></b></dt><dd><span class="tt">virtual</span> flag</dd></dl>
<h1 class="doxsection"><a class="anchor" id="the-xkb_types-section"></a>
The ‚Äúxkb_types‚Äù section</h1>
<p>This <a class="el" href="#keymap-section-def">section</a> is the second to be processed, after <span class="tt">xkb_keycodes</span>. However, it is completely independent and could have been the first to be processed (it does not refer to specific keys as specified in the <span class="tt">xkb_keycodes</span> section).</p>
<p>This section defines <a class="el" href="#key-type-def">key types</a>, which, given a key and a keyboard state (i.e. modifier state and group), determine the <a class="el" href="#level-def">shift level</a> to be used in translating the key to <a class="el" href="#keysym-def">keysyms</a>. These types are assigned to each group in each key, in the <span class="tt">xkb_symbols</span> section.</p>
<p>Key types are called this way because, in a way, they really describe the ‚Äútype‚Äù of the key (or more correctly, a specific group of the key). For example, an ordinary keymap will provide a type called <span class="tt">KEYPAD</span>, which consists of two levels, with the second level being chosen according to the state of the Num Lock (or Shift) modifiers. Another example is a type called <span class="tt">ONE_LEVEL</span>, which is usually assigned to keys such as Escape; these have just one level and are not affected by the modifier state. Yet more common examples are <a class="el" href="#TWO_LEVEL"><span class="tt">TWO_LEVEL</span></a> (with Shift choosing the second level), <a class="el" href="#ALPHABETIC"><span class="tt">ALPHABETIC</span></a> (where Caps Lock may also choose the second level), etc.</p>
<h2 class="doxsection"><a class="anchor" id="how-key-types-work"></a>
How key types work</h2>
<p>Key types define a <em>mapping</em> between the <a class="el" href="#modifier-def">modifiers</a> and <a class="el" href="#level-def">shift levels</a>. Key types have four parameters:</p>
<dl>
<dt><a class="el" href="#key-type-level-name">Shift level names</a> </dt>
<dd>Declare <a class="el" href="#level-def">shift levels</a>. Mainly for documentation. </dd>
<dt><a class="el" href="#key-type-modifiers">Modifiers filter</a> </dt>
<dd>Declare what modifiers should be taken into account in the mapping. </dd>
<dt><a class="el" href="#key-type-map">Modifiers mapping</a> </dt>
<dd>Lookup table to translate modifiers combinations into shift levels. </dd>
<dt><a class="el" href="#key-type-preserve">Modifiers preservation</a> </dt>
<dd>Tweak the computation of <a class="el" href="group__state.html">consumed modifiers</a>. </dd>
</dl>
<p>Key types are used to compute:</p><ul>
<li>the <a class="el" href="#level-def">shift level</a>: see <a class="el" href="group__state.html#ga3d1c128c65206292778e56b9f8b03e6e" title="Get the effective shift level for a key in a given keyboard state and layout.">xkb_state::xkb_state_key_get_level()</a>.</li>
<li>the <a class="el" href="group__state.html">consumed modifiers</a>: see <a class="el" href="group__state.html#ga79e9babefa0c66ca3e35763790eb3ee0" title="Same as xkb_state_key_get_consumed_mods2() with mode XKB_CONSUMED_MODE_XKB.">xkb_state::xkb_state_key_get_consumed_mods()</a> and <a class="el" href="group__state.html#ga1b4fb57a80351cad6f723282b205df6a" title="Get the mask of modifiers consumed by translating a given key.">xkb_state::xkb_state_key_get_consumed_mods2()</a>.</li>
</ul>
<p>The following diagram presents an overview of theses computations:</p>
<p><a class="anchor" id="xkb-types-explanation-diagram"></a></p><div class="dotgraph">
<iframe scrolling="no" loading="lazy" frameborder="0" src="dot_xkb-types-explanation.svg" width="778" height="978"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
Use of key types to compute shift level and consumed modifiers</div>
</div>
<h2 class="doxsection"><a class="anchor" id="key-type-statement"></a>
Type definitions</h2>
<p>Statements of the form: </p><pre class="fragment">type "FOUR_LEVEL" { ... }
</pre><p>The above would create a new type named <a class="el" href="#FOUR_LEVEL"><span class="tt">FOUR_LEVEL</span></a>. The body of the definition may include statements of the following forms:</p>
<h3 class="doxsection"><a class="anchor" id="key-type-level-name"></a>
‚Äúlevel_name‚Äù statements</h3>
<pre class="fragment">level_name[Level1] = "Base";
</pre><p>Mandatory for each level in the type.</p>
<p>Gives each level in this type a descriptive name. It isn‚Äôt used for anything.</p>
<p>Note: A level may be specified as Level[1-8] or just a number (can be more than 8).</p>
<h3 class="doxsection"><a class="anchor" id="key-type-modifiers"></a>
‚Äúmodifiers‚Äù statement</h3>
<pre class="fragment">modifiers = Shift+Lock+LevelThree;
</pre><p>Mandatory, should be specified only once.</p>
<p>A mask of real and virtual <a class="el" href="#modifier-def">modifiers</a>. These are the only modifiers being considered when matching the modifier state against the type. The other modifiers, whether active or not, are masked out in the calculation.</p>
<h3 class="doxsection"><a class="anchor" id="key-type-map"></a>
‚Äúmap‚Äù entry statements</h3>
<pre class="fragment">map[Shift+LevelThree] = Level4;
</pre><p>Should have at least as many mappings as there are levels in the type.</p>
<p>If the active modifiers, masked with the type‚Äôs modifiers (as stated above), match (i.e. equal) the modifiers inside the <span class="tt">map[]</span> statement, then the level in the right hand side is chosen. For example, in the above, if in the current keyboard state the <span class="tt">Shift</span> and <span class="tt">LevelThree</span> modifiers are active, while the <span class="tt">Lock</span> modifier is not, then the keysym(s) in the 4th level of the group will be returned to the user.</p>
<h3 class="doxsection"><a class="anchor" id="key-type-preserve"></a>
‚Äúpreserve‚Äù statements</h3>
<pre class="fragment">map[Shift+Lock+LevelThree] = Level5;
preserve[Shift+Lock+LevelThree] = Lock;
</pre><p>When a key type is used for keysym translation, its modifiers are said to be <a class="el" href="group__state.html">consumed</a> in this translation. For example, in a simple US keymap, the ‚ÄúG‚Äù key is assigned an ordinary <a class="el" href="#ALPHABETIC"><span class="tt">ALPHABETIC</span></a> key type, whose modifiers are <span class="tt">Shift</span> and <span class="tt">Lock</span>; then for the ‚ÄúG‚Äù key, these two modifiers are consumed by the translation. This information is relevant for applications which further process the modifiers, since by then the consumed modifiers have already ‚Äúdone their part‚Äù and should be masked out.</p>
<p>However, sometimes even if a modifier had already affected the key translation through the type, it should <em>not</em> be reported as consumed, for various reasons. In this case, a <span class="tt">preserve[]</span> statement can be used to augment the map entry. The modifiers inside the square brackets should match one of the <span class="tt">map[]</span> statements in the type (if there is no matching map entry, one mapping to Level1 is implicitly added). The right hand side should consists of modifiers from the type‚Äôs modifiers; these modifiers are then ‚Äúpreserved‚Äù and not reported as consumed.</p>
<dl class="section attention"><dt>Attention</dt><dd>Consuming a <em>locked</em> modifier does <em>not</em> unlock it and it can be consumed again in further keysym translations.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Remember that <a class="el" href="group__keysyms.html">Keysym Transformations</a> may affect the resulting keysym when some modifiers are not <a class="el" href="group__state.html">consumed</a>.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><span class="tt">preserve</span> statements may be used to tweak keyboard shorcuts. </dd>
<dd>
<figure> <figcaption> Example of use of <span class="tt">preserve</span> to tweak <span class="tt">Control</span> shortcuts. Note it would require further work in order to support other modifiers. </figcaption> <div class="fragment"><div class="line">xkb_types {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    type <span class="stringliteral">&quot;TWO_LEVEL_PLUS_CONTROL&quot;</span> {</div>
<div class="line">        modifiers = Shift + Control;</div>
<div class="line">        map[None]          = Level1;</div>
<div class="line">        map[Shift]         = Level2;</div>
<div class="line">        map[Control]       = Level3;</div>
<div class="line">        map[Control+Shift] = Level4;</div>
<div class="line">        <span class="comment">// Using preserve will make Control not consumed and allow</span></div>
<div class="line">        <span class="comment">// applications to detect keyboard shortcuts with alternative</span></div>
<div class="line">        <span class="comment">// keysyms in levels 3 and 4 rather than the levels 1 and 2.</span></div>
<div class="line">        preserve[Control]       = Control;</div>
<div class="line">        preserve[Control+Shift] = Control;</div>
<div class="line">        level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">        level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">        level_name[Level3] = <span class="stringliteral">&quot;Tweaked Control&quot;</span>;</div>
<div class="line">        level_name[Level4] = <span class="stringliteral">&quot;Tweaked Control + Shift&quot;</span>;</div>
<div class="line">    };</div>
<div class="line">};</div>
<div class="line">xkb_symbols {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    <span class="comment">// The following key would produce Greek keysym on Base and Shift levels,</span></div>
<div class="line">    <span class="comment">// but will produce the corresponding ASCII Latin keysyms when using Control.</span></div>
<div class="line">    key &lt;AC01&gt; {</div>
<div class="line">        type[Group1]=<span class="stringliteral">&quot;TWO_LEVEL_PLUS_CONTROL&quot;</span>,</div>
<div class="line">        [Greek_alpha, Greek_ALPHA, a, A]</div>
<div class="line">    };</div>
<div class="line">};</div>
</div><!-- fragment --> </figure></dd></dl>
<h2 class="doxsection"><a class="anchor" id="key-type-examples"></a>
Key types examples</h2>
<h3 class="doxsection"><a class="anchor" id="definitions-examples"></a>
Definitions examples</h3>
<dl class="section note"><dt>Note</dt><dd>The convention is that <span class="tt">Lock</span> affect only ‚Äúalphabetic‚Äù types. For such types, <span class="tt">Lock</span> ‚Äúcancels‚Äù <span class="tt">Shift</span> by default, i.e. <span class="tt">Shift+Lock</span> has the same result as neither modifier. ‚Äú<em>semi</em>-alphabetic‚Äù types have an asymmetry: their first two levels are alphabetic while the next are not.</dd></dl>
<h4 class="doxsection"><a class="anchor" id="two-levels"></a>
Two levels</h4>
<p>The following examples compare two basic types with <em>two levels</em>: <a class="el" href="#TWO_LEVEL"><span class="tt">TWO_LEVEL</span></a> and <a class="el" href="#ALPHABETIC"><span class="tt">ALPHABETIC</span></a>. They differ on their handling of the <span class="tt">Lock</span> modifier. See the <a class="el" href="#key-type-mappings-examples">next section</a> for an illustration with concrete layouts.</p>
<div class="example-container"> <div class="example"> <div class="example-inner"> <div class="example-title"><span class="tt">TWO_LEVEL</span><a class="anchor" id="TWO_LEVEL"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/basic#L14">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;TWO_LEVEL&quot;</span> {</div>
<div class="line">    <span class="comment">// Only care about Shift; Lock will be filter out</span></div>
<div class="line">    modifiers = Shift;</div>
<div class="line">    <span class="comment">// Define mapping</span></div>
<div class="line">    map[None]  = Level1; <span class="comment">// No modifier   -&gt; level 1</span></div>
<div class="line">    map[Shift] = Level2; <span class="comment">// Exactly Shift -&gt; level 2</span></div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    <span class="comment">// Define level names</span></div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figure> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers  </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers  </th><th class="markdownTableHeadNone">Match?  </th><th class="markdownTableHeadNone">Shift level  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1 ¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift + Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2  </td></tr>
</table>
</figure> </div> </div> <div class="example"> <div class="example-inner"> <div class="example-title"><span class="tt">ALPHABETIC</span><a class="anchor" id="ALPHABETIC"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/basic#L21">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;ALPHABETIC&quot;</span> {</div>
<div class="line">    <span class="comment">// Only care about Shift and Lock</span></div>
<div class="line">    modifiers = Shift + Lock;</div>
<div class="line">    <span class="comment">// Define mapping</span></div>
<div class="line">    map[None]  = Level1; <span class="comment">// No modifier   -&gt; level 1</span></div>
<div class="line">    map[Shift] = Level2; <span class="comment">// Exactly Shift -&gt; level 2</span></div>
<div class="line">    map[Lock]  = Level2; <span class="comment">// Exactly Lock  -&gt; level 2</span></div>
<div class="line">    <span class="comment">// Define level names</span></div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Caps&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figure> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers  </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers  </th><th class="markdownTableHeadNone">Match?  </th><th class="markdownTableHeadNone">Shift level  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2 ¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift + Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift + Lock</span>  </td><td class="markdownTableBodyNone">No  </td><td class="markdownTableBodyNone">1  </td></tr>
</table>
</figure> </div> </div> </div><h4 class="doxsection"><a class="anchor" id="four-levels"></a>
Four levels</h4>
<p>The following examples compare basic types with <em>four levels</em>: <a class="el" href="#FOUR_LEVEL"><span class="tt">FOUR_LEVEL</span></a>, <a class="el" href="#FOUR_LEVEL_SEMIALPHABETIC"><span class="tt">FOUR_LEVEL_SEMIALPHABETIC</span></a> and <a class="el" href="#FOUR_LEVEL_ALPHABETIC"><span class="tt">FOUR_LEVEL_ALPHABETIC</span></a>. They differ on their handling of the <span class="tt">Lock</span> modifier. See the <a class="el" href="#key-type-mappings-examples">next section</a> for an illustration with concrete layouts.</p>
<div class="example-container"> <div class="example"> <div class="example-inner"> <div class="example-title"><span class="tt">FOUR_LEVEL</span><a class="anchor" id="FOUR_LEVEL"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/extra#L8">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;FOUR_LEVEL&quot;</span> {</div>
<div class="line">    modifiers = Shift + LevelThree;</div>
<div class="line">    map[None] = Level1;</div>
<div class="line">    map[Shift] = Level2;</div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    map[LevelThree] = Level3;</div>
<div class="line">    map[Shift+LevelThree] = Level4;</div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no preserve entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no preserve entry with Lock)</span></div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">    level_name[Level3] = <span class="stringliteral">&quot;AltGr&quot;</span>;</div>
<div class="line">    level_name[Level4] = <span class="stringliteral">&quot;Shift AltGr&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figure> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers  </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers  </th><th class="markdownTableHeadNone">Match?  </th><th class="markdownTableHeadNone">Shift level  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1 ¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">4  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">4  </td></tr>
</table>
</figure> </div> </div> <div class="example"> <div class="example-inner"> <div class="example-title"><span class="tt">FOUR_LEVEL_SEMIALPHABETIC</span><a class="anchor" id="FOUR_LEVEL_SEMIALPHABETIC"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/extra#L36">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;FOUR_LEVEL_SEMIALPHABETIC&quot;</span> {</div>
<div class="line">    modifiers = Shift + Lock + LevelThree;</div>
<div class="line">    map[None] = Level1;</div>
<div class="line">    map[Shift] = Level2;</div>
<div class="line">    map[Lock] = Level2;</div>
<div class="line">    map[Shift+Lock] = Level1;</div>
<div class="line">    map[LevelThree] = Level3;</div>
<div class="line">    map[Shift+LevelThree] = Level4;</div>
<div class="line">    map[Lock+LevelThree] = Level3;</div>
<div class="line">    map[Shift+Lock+LevelThree] = Level4;</div>
<div class="line">    preserve[Lock+LevelThree] = Lock;</div>
<div class="line">    preserve[Shift+Lock+LevelThree] = Lock;</div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">    level_name[Level3] = <span class="stringliteral">&quot;AltGr&quot;</span>;</div>
<div class="line">    level_name[Level4] = <span class="stringliteral">&quot;Shift AltGr&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figure> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers  </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers  </th><th class="markdownTableHeadNone">Match?  </th><th class="markdownTableHeadNone">Shift level  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2 ¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift+Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">4  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree+Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift+Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">4  </td></tr>
</table>
</figure> </div> </div> <div class="example"> <div class="example-inner"> <div class="example-title"><span class="tt">FOUR_LEVEL_ALPHABETIC</span><a class="anchor" id="FOUR_LEVEL_ALPHABETIC"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/extra#L20">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;FOUR_LEVEL_ALPHABETIC&quot;</span> {</div>
<div class="line">    modifiers = Shift + Lock + LevelThree;</div>
<div class="line">    map[None] = Level1;</div>
<div class="line">    map[Shift] = Level2;</div>
<div class="line">    map[Lock] = Level2;</div>
<div class="line">    map[Shift+Lock] = Level1;</div>
<div class="line">    map[LevelThree] = Level3;</div>
<div class="line">    map[Shift+LevelThree] = Level4;</div>
<div class="line">    map[Lock+LevelThree] = Level4;</div>
<div class="line">    map[Shift+Lock+LevelThree] = Level3;</div>
<div class="line">    <span class="comment">// (no preserve entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no preserve entry with Lock)</span></div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">    level_name[Level3] = <span class="stringliteral">&quot;AltGr&quot;</span>;</div>
<div class="line">    level_name[Level4] = <span class="stringliteral">&quot;Shift AltGr&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figure> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers  </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers  </th><th class="markdownTableHeadNone">Match?  </th><th class="markdownTableHeadNone">Shift level  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">2 ¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift+Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">4  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree+Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">4  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift+Lock</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree+Shift+Lock</span>  </td><td class="markdownTableBodyNone">Yes  </td><td class="markdownTableBodyNone">3  </td></tr>
</table>
</figure> </div> </div> </div><h3 class="doxsection"><a class="anchor" id="key-type-mappings-examples"></a>
Examples with standard keyboard layouts</h3>
<details >
<summary >
See the detailed table of mappings</summary>
<p>The following table compares the mappings of various key types for the modifiers <span class="tt">Shift</span>, <span class="tt">Lock</span> and <span class="tt">LevelThree</span>, using the standard layouts <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/us#L3"><span class="tt">us</span></a> (US English) and <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/es#L3"><span class="tt">es</span></a> (Spanish).</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Key  </th><th class="markdownTableHeadNone">Layout  </th><th class="markdownTableHeadNone">Key type  </th><th class="markdownTableHeadNone">Active modifiers  </th><th class="markdownTableHeadNone">Level  </th><th class="markdownTableHeadNone">Keysym  </th><th class="markdownTableHeadNone">Comment  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="16"><span class="tt">AE01</span>  </td><td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/us#L3"><span class="tt">us</span></a>  </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#TWO_LEVEL"><span class="tt">TWO_LEVEL</span></a>  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">1</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">exclam</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">1</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">exclam</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> filtered out  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">1</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">exclam</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">1</span>  </td><td class="markdownTableBodyNone">Modifiers <span class="tt">LevelThree</span> and <span class="tt">Lock</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">exclam</span>  </td><td class="markdownTableBodyNone">Modifiers <span class="tt">LevelThree</span> and <span class="tt">Lock</span> filtered out  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/es#L3"><span class="tt">es</span></a>  </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#FOUR_LEVEL"><span class="tt">FOUR_LEVEL</span></a>  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">1</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">exclam</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">1</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">exclam</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> filtered out  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone"><span class="tt">bar</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone"><span class="tt">exclamdown</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone"><span class="tt">bar</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone"><span class="tt">exclamdown</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> filtered out  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="16"><span class="tt">AD01</span>  </td><td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/us#L3"><span class="tt">us</span></a>  </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#ALPHABETIC"><span class="tt">ALPHABETIC</span></a>  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">q</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">Q</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">Q</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">q</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> cancelled by <span class="tt">Shift</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">q</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">q</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">Q</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">q</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out, <span class="tt">Lock</span> cancelled by <span class="tt">Shift</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/es#L3"><span class="tt">es</span></a>  </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#FOUR_LEVEL_SEMIALPHABETIC"><span class="tt">FOUR_LEVEL_SEMIALPHABETIC</span></a>  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">q</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">Q</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">Q</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">q</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> cancelled by <span class="tt">Shift</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone"><span class="tt">at</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone"><span class="tt">Greek_OMEGA</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone"><span class="tt">at</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> does not affect <span class="tt">LevelThree</span> combos  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone"><span class="tt">Greek_OMEGA</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> does not affect <span class="tt">LevelThree</span> combos  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="16"><span class="tt">AD05</span>  </td><td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/us#L3"><span class="tt">us</span></a>  </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#ALPHABETIC"><span class="tt">ALPHABETIC</span></a>  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">t</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">T</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">T</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">t</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> cancelled by <span class="tt">Shift</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">t</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">t</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">T</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">t</span>  </td><td class="markdownTableBodyNone"><span class="tt">LevelThree</span> filtered out, <span class="tt">Lock</span> cancelled by <span class="tt">Shift</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/es#L3"><span class="tt">es</span></a>  </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#FOUR_LEVEL_ALPHABETIC"><span class="tt">FOUR_LEVEL_ALPHABETIC</span></a>  </td><td class="markdownTableBodyNone">(none)  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">t</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">T</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">T</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">t</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> cancelled by <span class="tt">Shift</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone"><span class="tt">tslash</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone"><span class="tt">Tslash</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone"><span class="tt">Tslash</span>  </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span> + <span class="tt">Shift</span> + <span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone"><span class="tt">tslash</span>  </td><td class="markdownTableBodyNone"><span class="tt">Lock</span> cancelled by <span class="tt">Shift</span>  </td></tr>
</table>
</details>
<h1 class="doxsection"><a class="anchor" id="the-xkb_compat-section"></a>
The ‚Äúxkb_compat‚Äù section</h1>
<p>This <a class="el" href="#keymap-section-def">section</a> is the third to be processed, after <span class="tt">xkb_keycodes</span> and <span class="tt">xkb_types</span>.</p>
<h2 class="doxsection"><a class="anchor" id="interpret-statements"></a>
Interpret statements</h2>
<p>Statements of the form: </p><pre class="fragment">interpret Num_Lock+Any { ... }
interpret Shift_Lock+AnyOf(Shift+Lock) { ... }
</pre><p>The <code><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a></code> section (see below) allows the keymap author to perform, among other things, the following things for each key:</p>
<ul>
<li>Bind a sequence of <a class="el" href="#key-actions">actions</a>, like <span class="tt">SetMods</span> or <span class="tt">LockGroup</span>, to the key. Actions, like symbols, are specified for each level of each group in the key separately.</li>
<li>Add a <a class="el" href="#virtual-modifier-def">virtual modifier</a> to the key‚Äôs virtual modifier mapping (<span class="tt">vmodmap</span>).</li>
<li>Specify whether the key should repeat or not.</li>
</ul>
<p>However, doing this for each key (or level) is tedious and inflexible. Interpret‚Äôs are a mechanism to apply these settings to a bunch of keys/levels at once.</p>
<p><a class="anchor" id="interpret-mechanism"></a>Each interpret specifies a condition by which it attaches to certain levels. The condition consists of two parts:</p>
<ul>
<li>A <b><a class="el" href="#keysym-def">keysym</a></b>. If the level has a different (or more than one) keysym, the match fails. Leaving out the keysym is equivalent to using the special value <span class="tt">Any</span> or the <span class="tt">NoSymbol</span> keysym, which always matches successfully.</li>
<li><p class="startli">A <b><a class="el" href="#modifier-def">modifier</a> predicate</b>. The predicate consists of:</p><ul>
<li><p class="startli">A <b>mask</b> of <em>real</em> modifiers: a <span class="tt">+</span>-separated list of modifiers or the special value <span class="tt">all</span>, which denotes all the modifiers.</p>
<p class="startli">The modifiers are matched against the key‚Äôs modifier map (<span class="tt">modmap</span>).</p>
</li>
<li>A <b>matching operation</b>, that is one of the following:<ul>
<li><span class="tt">AnyOfOrNone</span> ‚Äì The modmap must either be empty or include at least one of the specified modifiers.</li>
<li><span class="tt">AnyOf</span> ‚Äì The modmap must include at least one of the specified modifiers.</li>
<li><span class="tt">Any</span> ‚Äì Alias for <span class="tt">AnyOf(all)</span>.</li>
<li><span class="tt">NoneOf</span> ‚Äì The modmap must not include any of the specified modifiers.</li>
<li><span class="tt">AllOf</span> ‚Äì The modmap must include all of the specified modifiers (but may include others as well).</li>
<li><span class="tt">Exactly</span> ‚Äì The modmap must be exactly the same as the specified modifiers.</li>
</ul>
</li>
</ul>
<p class="startli">Leaving out the predicate is equivalent to using <span class="tt">AnyOfOrNone(all)</span>. Leaving out just the matching condition is equivalent to using <span class="tt">Exactly</span>.</p>
</li>
</ul>
<p>An interpret may also include <span class="tt">useModMapMods = level1;</span> ‚Äì see below.</p>
<p>If a <a class="el" href="#level-def">level</a> fulfils the conditions of several interprets, only the most specific one is used:</p>
<ul>
<li>A specific keysym will always match before a generic <span class="tt">NoSymbol</span> condition.</li>
<li>If the keysyms are the same, the interpret with the more specific matching operation is used. The above list is sorted from least to most specific.</li>
<li>If both the keysyms and the matching operations are the same (but the modifiers are different), the first interpret is used.</li>
</ul>
<p>As described above, once an interpret ‚Äúattaches‚Äù to a level, it can bind an action to that level, add one virtual modifier to the key‚Äôs vmodmap, or set the key‚Äôs repeat setting. You should note the following:</p>
<ul>
<li>The key repeat is a property of the entire key; it is not level-specific. In order to avoid confusion, it is only inspected for the first level of the first group; the interpret‚Äôs repeat setting is ignored when applied to other levels.</li>
<li>If one of the above fields was set directly for a key in <span class="tt">xkb_symbols</span>, the explicit setting takes precedence over the interpret.</li>
</ul>
<p>The body of the statement may include statements of the following forms (all of which are optional):</p>
<h3 class="doxsection"><a class="anchor" id="usemodmapmods-statement"></a>
‚ÄúuseModMapMods‚Äù statement</h3>
<pre class="fragment">useModMapMods = level1;
</pre><p>When set to <span class="tt">level1</span>, the interpret will only match keysyms which are on the first level of the first group of the keys. This can be useful in conjunction with e.g. a <a class="el" href="#interpret-virtualModifier"><span class="tt">virtualModifier</span></a> statement, because <span class="tt">virtualModifier</span> is an attribute of the key rather than a specific level.</p>
<p>Note: the other possible value is <span class="tt">any</span> and is the default value.</p>
<p>See <a class="el" href="#virtual-modifier-map">virtual modifier map</a> for further information.</p>
<h3 class="doxsection"><a class="anchor" id="interpret-virtualModifier"></a>
‚ÄúvirtualModifier‚Äù statement</h3>
<pre class="fragment">virtualModifier = NumLock;
</pre><p>Add this virtual modifier to the key‚Äôs <span class="tt">vmodmap</span>. The given virtual modifier must be declared at the top level of the file with a <span class="tt">virtual_modifiers</span> statement, e.g.: </p><pre class="fragment">virtual_modifiers NumLock;
</pre><p>See <a class="el" href="#virtual-modifier-map">virtual modifier map</a> for further information.</p>
<h3 class="doxsection"><a class="anchor" id="interpret-repeat"></a>
‚Äúrepeat‚Äù statement</h3>
<pre class="fragment">repeat = True;
</pre><p>Set whether the key should repeat or not. Must be a boolean value.</p>
<h3 class="doxsection"><a class="anchor" id="interpret-action"></a>
‚Äúaction‚Äù statement</h3>
<pre class="fragment">action = LockMods(modifiers=NumLock);
</pre><p>Bind this action to the matching levels. See <a class="el" href="#key-actions">key actions</a> for the list of available key actions.</p>
<p>Since 1.9.0, it is also possible to assign a sequence of actions, mirroring the feature used in the <a class="el" href="#key-multiple-symbols-per-level">key statement</a>. </p><pre class="fragment">action = {SetMods(modifiers=NumLock),SetGroup(group=2)};
</pre><h2 class="doxsection"><a class="anchor" id="indicator-effect"></a>
LED map statements</h2>
<p>Statements of the form: </p><pre class="fragment">indicator "Shift Lock" { ... }
</pre><p>This statement specifies the behavior and binding of the LED (AKA <a class="el" href="#indicator-def">indicator</a>) with the given name (‚ÄúShift Lock‚Äù above). The name should have been declared previously in the <span class="tt">xkb_keycodes</span> section (see <a class="el" href="#indicator-name">LED name</a> statement), and given an index there. If it wasn‚Äôt, it is created with the next free index.</p>
<p>The body of the statement describes the conditions of the keyboard state which will cause the LED to be lit. It may include the following statements:</p>
<h3 class="doxsection"><a class="anchor" id="modifiers-statement"></a>
‚Äúmodifiers‚Äù statement</h3>
<pre class="fragment">modifiers = ScrollLock;
</pre><p>If the given <a class="el" href="#modifier-def">modifiers</a> are in the required state (see below), the LED is lit.</p>
<h3 class="doxsection"><a class="anchor" id="whichmodstate-statement"></a>
‚ÄúwhichModState‚Äù statement</h3>
<pre class="fragment">whichModState = Latched+Locked;
</pre><p>Can be any combination of:</p>
<ul>
<li><span class="tt">base</span>, <span class="tt">latched</span>, <span class="tt">locked</span>, <span class="tt">effective</span></li>
<li><span class="tt">any</span> (i.e. all of the above)</li>
<li><span class="tt">none</span> (i.e. none of the above)</li>
<li><span class="tt">compat</span> (legacy value, treated as effective)</li>
</ul>
<p>This will cause the respective portion of the modifier state (see <span class="tt">struct <a class="el" href="structxkb__state.html" title="Opaque keyboard state object.">xkb_state</a></span>) to be matched against the modifiers given in the <span class="tt">modifiers</span> statement.</p>
<p>Here‚Äôs a simple example: </p><pre class="fragment">indicator "Num Lock" {
    modifiers = NumLock;
    whichModState = Locked;
};
</pre><p>Whenever the NumLock modifier is locked, the Num Lock LED will light up.</p>
<h3 class="doxsection"><a class="anchor" id="groups-statement"></a>
‚Äúgroups‚Äù statement</h3>
<pre class="fragment">groups = All - group1;
</pre><p>If the given groups are in the required state (see below), the LED is lit.</p>
<h3 class="doxsection"><a class="anchor" id="whichgroupstate-statement"></a>
‚ÄúwhichGroupState‚Äù statement</h3>
<pre class="fragment">whichGroupState = Effective;
</pre><p>Can be any combination of:</p>
<ul>
<li><span class="tt">base</span>, <span class="tt">latched</span>, <span class="tt">locked</span>, <span class="tt">effective</span></li>
<li><span class="tt">any</span> (i.e. all of the above)</li>
<li><span class="tt">none</span> (i.e. none of the above)</li>
</ul>
<p>This will cause the respective portion of the group state (see <span class="tt">struct <a class="el" href="structxkb__state.html" title="Opaque keyboard state object.">xkb_state</a></span>) to be matched against the groups given in the <span class="tt">groups</span> statement.</p>
<p>Note: the above conditions are disjunctive, i.e. if any of them are satisfied the LED is lit.</p>
<h2 class="doxsection"><a class="anchor" id="set-default-values-1"></a>
Set default values</h2>
<p>One may change the default values of the following statements:</p>
<ul>
<li><span class="tt">interpret</span>: use <span class="tt">interpret.FIELD = VALUE;</span></li>
<li><span class="tt">indicator</span>: use <span class="tt">indicator.FIELD = VALUE;</span></li>
<li>actions: use <span class="tt">ACTION_NAME.FIELD = VALUE;</span>. E.g. <span class="tt">setMods.clearLocks= True;</span>.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="the-xkb_symbols-section"></a>
The ‚Äúxkb_symbols‚Äù section</h1>
<p>This <a class="el" href="#keymap-section-def">section</a> is the fourth to be processed, after <span class="tt">xkb_keycodes</span>, <span class="tt">xkb_types</span> and <span class="tt">xkb_compat</span>.</p>
<p>Statements of the form: </p><pre class="fragment">xkb_symbols "basic" {
    ...
}
</pre><p>Declare a symbols map named <span class="tt">basic</span>. Statements inside the curly braces only affect the symbols map.</p>
<h2 class="doxsection"><a class="anchor" id="name-statements"></a>
Name statements</h2>
<p>Statements of the form: </p><pre class="fragment">name[Group1] = "US/ASCII";
groupName[1] = "US/ASCII";
</pre><p>Gives the name ‚ÄúUS/ASCII‚Äù to the first group of symbols. Other groups can be named using a different group index (ex: <span class="tt">Group2</span>), and with a different name. A group must be named.</p>
<p><span class="tt">group</span> and <span class="tt">groupName</span> mean the same thing, and the <span class="tt">Group</span> in <span class="tt">Group1</span> is optional.</p>
<h2 class="doxsection"><a class="anchor" id="key-statement"></a>
Key statement</h2>
<p>Statements of the form: </p><pre class="fragment">key &lt;AD01&gt; { ... };
</pre><p>defines the <em>key description</em> of the <a class="el" href="#keycode-def">keycode</a> <span class="tt">&lt;AD01&gt;</span> and is the main type of record of the <span class="tt">xkb_symbols</span> section. The possible keycodes are defined in the <a class="el" href="#the-xkb_keycodes-section"><span class="tt">xkb_keycodes</span></a> section.</p>
<p>A key description consists of:</p>
<dl>
<dt>Groups </dt>
<dd><p class="startdd">Each key may have one or more associated <a class="el" href="#layout-def">groups</a>. Each group can be configured with the following parameters:</p>
<ul>
<li><a class="el" href="#key-type-setting">Type</a></li>
</ul>
<ul>
<li><a class="el" href="#key-symbols-table">Symbols</a></li>
</ul>
<ul>
<li><a class="el" href="#key-actions-table">Actions</a></li>
</ul>
</dd>
<dt>Additional attributes </dt>
<dd><p class="startdd">These attributes are usually set via the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section, but may be also set directly:</p>
<ul>
<li><a class="el" href="#key-virtual-modifiers">Virtual modifiers</a></li>
<li><a class="el" href="#key-repeat">Repeat</a> </li>
</ul>
</dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Using multiple groups in <em>symbols</em> files is not recommended, because some tools rely on the assumption that an <span class="tt">xkb_symbols</span> section only affect a single group. It is fine with a <em>keymap</em> file though.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>In what follows we assume the common use case with a <em>single</em> group, which benefits from a special syntax. See the section <a class="el" href="#key-groups">Multiple groups</a> for the general syntax.</dd></dl>
<h3 class="doxsection"><a class="anchor" id="key-symbols-table"></a>
Symbols</h3>
<p>The main part of the key description is the <em>symbols table</em>. It maps shift levels to keysyms, e.g.:</p>
<div class="fragment"><div class="line">key &lt;AD01&gt; { [ q, Q ] }; <span class="comment">// Level 1 ‚Üí `q`, Level 2 ‚Üí `Q`</span></div>
</div><!-- fragment --><p>Symbols are named using the symbolic names from the <span class="tt"><a class="el" href="xkbcommon-keysyms_8h.html" title="Key symbols (keysyms) definitions.">xkbcommon/xkbcommon-keysyms.h</a></span> file. See the <a class="el" href="#keysym-syntax">keysym syntax</a> for further information. A group of symbols is enclosed in brackets and separated by commas. Each element of the symbol arrays corresponds to a different <a class="el" href="#level-def">shift level</a>. In this example, the symbol (keysym) <span class="tt">XKB_KEY_q</span> for level 1 and <span class="tt">XKB_KEY_Q</span> for level 2. These levels are configured by the <a class="el" href="#key-type-setting">key type</a>, presented in the next section.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Remember that <a class="el" href="group__keysyms.html">Keysym Transformations</a> may affect the resulting keysym when some modifiers are not <a class="el" href="group__state.html">consumed</a>.</dd>
<dd>
Trailing <span class="tt">NoSymbol</span> are dropped.</dd></dl>
<p><a class="anchor" id="key-multiple-symbols-per-level"></a>As an extension to the XKB legacy format, libxkbcommon supports multiple key symbols and actions per level (the latter since version 1.8.0):</p>
<div class="fragment"><div class="line">key &lt;AD08&gt; { [ {i, j}        , U0132         ] }; <span class="comment">// IJ Dutch digraph</span></div>
<div class="line">key &lt;AC05&gt; { [ {g, U0303}    , {G, U0303}    ] }; <span class="comment">// GÃÉ Guarani letter</span></div>
<div class="line">key &lt;AB05&gt; { [ {U0644, U0627}, {U0644, U0622}] }; <span class="comment">// ‚ÅßŸÑÿß‚Å© ‚ÅßŸÑÿ¢‚Å© Arabic Lam-Alef ligatures decomposed</span></div>
<div class="line">key &lt;AD01&gt; { [ {c, U2019, h} , {C, U2019, h} ] }; <span class="comment">// C‚ÄôH Breton trigraph</span></div>
</div><!-- fragment --><p>In this example, the keycode <span class="tt">&lt;AD08&gt;</span> produces two symbols on level 1 (<span class="tt">XKB_KEY_i</span> and <span class="tt">XKB_KEY_j</span>) and one symbol (Unicode keysym <span class="tt">U0132</span> for ‚Äúƒ≤‚Äù) on level 2. <span class="tt">&lt;AD08&gt;</span> and <span class="tt">&lt;AD01&gt;</span> produce letters that have no <em>precomposed</em> code point in Unicode. Key <span class="tt">&lt;AB05&gt;</span> avoids the need of using Compose.</p>
<p><a class="anchor" id="keysyms-string"></a>Since 1.9.0, UTF-8-encoded <em>strings</em> may be used to denote a list of keysyms corresponding to the encoded Unicode code points. E.g. the previous example can be also written more intuitively as:</p>
<div class="fragment"><div class="line">key &lt;AD08&gt; { [ <span class="stringliteral">&quot;ij&quot;</span> , <span class="stringliteral">&quot;ƒ≤&quot;</span>   ] }; <span class="comment">// IJ Dutch digraph</span></div>
<div class="line">key &lt;AC05&gt; { [ <span class="stringliteral">&quot;gÃÉ&quot;</span>  , <span class="stringliteral">&quot;GÃÉ&quot;</span>   ] }; <span class="comment">// GÃÉ Guarani letter</span></div>
<div class="line"><span class="comment">// NOTE: We use U+200E LEFT-TO-RIGHT MARK in order to display the strings in</span></div>
<div class="line"><span class="comment">//       in the proper order.</span></div>
<div class="line">key &lt;AB05&gt; { [ <span class="stringliteral">&quot;ŸÑÿß&quot;</span>‚Äé  , <span class="stringliteral">&quot;ŸÑÿ¢&quot;</span>‚Äé   ] }; <span class="comment">// ‚ÅßŸÑÿß‚Å© ‚ÅßŸÑÿ¢‚Å© Arabic Lam-Alef ligatures decomposed</span></div>
<div class="line">key &lt;AD01&gt; { [ <span class="stringliteral">&quot;c‚Äôh&quot;</span>, <span class="stringliteral">&quot;C‚Äôh&quot;</span> ] }; <span class="comment">// C‚ÄôH Breton trigraph</span></div>
</div><!-- fragment --><p>When no actions are explicitly given, they are automatically filled thanks to <a class="el" href="#interpret-statements">interpretations</a> from the <a class="el" href="#the-xkb_compat-section">compat section</a>. In the following example, </p><pre class="fragment">key &lt;LCTL&gt; { [ { Control_L, ISO_Group_Shift } ] };
</pre><p>is equivalent to (given standard definitions from <span class="tt">xkeyboard-config</span>): </p><pre class="fragment">key &lt;LCTL&gt; {
    symbols[1] = [ { Control_L,                  ISO_Group_Shift    } ],
    actions[1] = [ { SetMods(modifiers=Control), SetGroup(group=+1) } ]
};
</pre><p>When using this example with e.g. two layouts <span class="tt">fr,us</span> (respectively Azerty and Qwerty layouts), typing <span class="tt">Control + A</span> in the first layout <span class="tt">fr</span> will in fact result in <span class="tt">Control + Q</span>, because the actions are run sequentially: first set the base modifiers to Control, then switch to the second layout while <span class="tt">Control</span> is pressed.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Given a level, keysyms and actions may have a <em>different count</em>. For instance, the following would achieve the same effect than the former example with only 1 keysym, but it requires to use 2 explicit actions: <div class="fragment"><div class="line">key &lt;LCTL&gt; {</div>
<div class="line">    symbols[1] = [ Control_L                                          ],</div>
<div class="line">    actions[1] = [ { SetMods(modifiers=Control), SetGroup(group=+1) } ]</div>
<div class="line">};</div>
</div><!-- fragment --></dd></dl>
<dl class="section note"><dt>Note</dt><dd>There are some <em>limitations</em> with this extension:<ul>
<li><p class="startli">For now, <em>at most one</em> action of each following categories is allowed per level:</p><ul>
<li><a class="el" href="#modifiers-actions">modifier actions</a>: <span class="tt">SetMods</span>, <span class="tt">LatchMods</span>, <span class="tt">LockMods</span>;</li>
<li><a class="el" href="#group-actions">group actions</a>: <span class="tt">SetGroup</span>, <span class="tt">LatchGroup</span>, <span class="tt">LockGroup</span>.</li>
</ul>
<p class="startli">Some examples of actions combination:</p><ul>
<li><span class="tt">SetMods</span> + <span class="tt">SetGroup</span>: ok</li>
<li><span class="tt">SetMods</span> + <span class="tt">SetMods</span>: <em>error</em></li>
<li><span class="tt">SetMods</span> + <span class="tt">LockMods</span>: <em>error</em></li>
<li><span class="tt">SetMods</span> + <span class="tt">LockGroup</span>: ok</li>
</ul>
</li>
<li>Multiple actions are only supported from version 1.8.0.</li>
</ul>
</dd></dl>
<div></div><div><dl class="section since"><dt>Since</dt><dd>1.8.0: When using multiple keysyms or actions per level, <span class="tt">NoSymbol</span> and <span class="tt">NoAction()</span> are dropped in order to normalize the levels: <div class="fragment"><div class="line"><span class="comment">// Before normalization</span></div>
<div class="line">key &lt;&gt; { [{NoSymbol}, {a, NoSymbol}, {NoSymbol,b}, {a, NoSymbol, b}] };</div>
<div class="line"><span class="comment">// After normalization</span></div>
<div class="line">key &lt;&gt; { [NoSymbol, a, b, {a, b}] };</div>
</div><!-- fragment --></dd></dl>
</div> <div></div><div><dl class="section since"><dt>Since</dt><dd>1.9.0: Trailing <span class="tt">NoSymbol</span> and <span class="tt">NoAction()</span> are dropped in groups: <div class="fragment"><div class="line"><span class="comment">// Before normalization</span></div>
<div class="line">key &lt;&gt; { [a, NoSymbol] };</div>
<div class="line"><span class="comment">// After normalization</span></div>
<div class="line">key &lt;&gt; { [a] };</div>
</div><!-- fragment --> This affects the automatic key type detection.</dd></dl>
</div> <div></div><div><dl class="section since"><dt>Since</dt><dd>1.9.0: Added support for keysyms and actions lists of length 0 and 1, respectively <span class="tt">{}</span> and <span class="tt">{a}</span>. <span class="tt">{}</span> is equivalent to the corresponding <span class="tt">NoSymbol</span> or <span class="tt">NoAction()</span>.</dd></dl>
</div><dl class="section warning"><dt>Warning</dt><dd>Keymaps containing multiple key symbols per level are not supported by the various X11-related tools (<span class="tt">setxkbmap</span>, <span class="tt">xkbcomp</span>, etc.).</dd></dl>
<h3 class="doxsection"><a class="anchor" id="key-type-setting"></a>
Type</h3>
<p>Each key has a <a class="el" href="#key-type-def">key type</a> set per group. This key type is defined in the <code><a class="el" href="#the-xkb_types-section">xkb_types</a></code> section. Its associated <a class="el" href="#level-def">shift levels</a> are used to index the <a class="el" href="#key-symbols-table">symbols table</a> presented in the previous section.</p>
<p>A key type is set using the following syntax:</p>
<div class="fragment"><div class="line">key &lt;AD01&gt; {</div>
<div class="line">    type[Group1] = <span class="stringliteral">&quot;TWO_LEVEL&quot;</span>, <span class="comment">// Type</span></div>
<div class="line">    [q, Q]                      <span class="comment">// Symbols</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>The name of the key type is enclosed between double quotes.</p>
<p>The key type may be omitted and will default to:</p>
<ul>
<li><span class="tt">key.type</span> global defaults, if set.</li>
<li>a standard type using the following <b>heuristic</b>:<ul>
<li><b>1</b> keysym: <span class="tt">ONE_LEVEL</span></li>
<li><b>2</b> keysyms:<ul>
<li>if the two keysyms are letter and the first is lower case and the other upper case, then <a class="el" href="#ALPHABETIC"><span class="tt">ALPHABETIC</span></a>;</li>
<li>if one of the keysyms is numpad, then <span class="tt">KEYPAD</span> else <a class="el" href="#TWO_LEVEL"><span class="tt">TWO_LEVEL</span></a>.</li>
</ul>
</li>
<li><b>3 or 4</b> keysyms (a missing 4th keysym is set to <span class="tt">NoSymbol</span>):<ul>
<li>if the first two keysyms are letters and the first is lower case and the other upper case:<ul>
<li>if the last two keysyms are letters and the first is lower case and the other upper case then <a class="el" href="#FOUR_LEVEL_ALPHABETIC"><span class="tt">FOUR_LEVEL_ALPHABETIC</span></a>;</li>
<li>else <a class="el" href="#FOUR_LEVEL_SEMIALPHABETIC"><span class="tt">FOUR_LEVEL_SEMIALPHABETIC</span></a>.</li>
</ul>
</li>
<li>if one of the first two keysyms is numpad, then <span class="tt">FOUR_LEVEL_KEYPAD</span>;</li>
<li>else <a class="el" href="#FOUR_LEVEL"><span class="tt">FOUR_LEVEL</span></a>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure><figcaption><p> Commented examples for inferred types: </p></figcaption><div class="fragment"><div class="line"><span class="comment">// 1 to 2 keysyms</span></div>
<div class="line">key &lt;LFSH&gt; { [Shift_L] };                    <span class="comment">// Type: ONE_LEVEL</span></div>
<div class="line">key &lt;AE01&gt; { [1, exclam] };                  <span class="comment">// Type: TWO_LEVEL</span></div>
<div class="line">key &lt;AD01&gt; { [q, Q] };                       <span class="comment">// Type: ALPHABETIC</span></div>
<div class="line">key &lt;KP1&gt;  { [KP_End, KP_1] };               <span class="comment">// Type: KEYPAD</span></div>
<div class="line"><span class="comment">// Edge case: this is consider alphabetic, although</span></div>
<div class="line"><span class="comment">// the lower case does not correspond to the upper case.</span></div>
<div class="line">key &lt;AD01&gt; { [q, N] };                       <span class="comment">// Type: ALPHABETIC</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// 3 to 4 keysyms</span></div>
<div class="line">key &lt;AE01&gt; { [1, exclam, bar] };             <span class="comment">// Type: FOUR_LEVEL</span></div>
<div class="line">key &lt;AE01&gt; { [1, exclam, bar, exclamdown] }; <span class="comment">// Type: FOUR_LEVEL</span></div>
<div class="line">key &lt;AD01&gt; { [q, Q, at] };                   <span class="comment">// Type: FOUR_LEVEL_SEMIALPHABETIC</span></div>
<div class="line">key &lt;AD01&gt; { [q, Q, at, Greek_OMEGA] };      <span class="comment">// Type: FOUR_LEVEL_SEMIALPHABETIC</span></div>
<div class="line">key &lt;AD05&gt; { [t, T, tslash, Tslash] };       <span class="comment">// Type: FOUR_LEVEL_ALPHABETIC</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// The inferred type is `FOUR_LEVEL`, but using `LevelThree+Lock`</span></div>
<div class="line"><span class="comment">// will produce `Q`, because of the keysyms transformations and</span></div>
<div class="line"><span class="comment">// the corresponding internal capitalization processing.</span></div>
<div class="line">key &lt;AE01&gt; { [1, exclam, q, Q] };            <span class="comment">// Type: FOUR_LEVEL</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Won‚Äôt work, because there is no heuristic for more than 4 keysyms</span></div>
<div class="line"><span class="comment">// It will trigger the warnings XKB-183 and XKB-516 and default to ONE_LEVEL,</span></div>
<div class="line"><span class="comment">// ignoring all the keysyms but the first one.</span></div>
<div class="line">key &lt;AD01&gt; {[q, Q, at, any, masculine, U2642]};</div>
<div class="line"><span class="comment">// Will work as expected</span></div>
<div class="line">key &lt;AD01&gt; {</div>
<div class="line">    type[Group1] = <span class="stringliteral">&quot;EIGHT_LEVEL_SEMIALPHABETIC&quot;</span>,</div>
<div class="line">    [q, Q, at, any, masculine, U2642]</div>
<div class="line">};</div>
</div><!-- fragment --> </figure><h3 class="doxsection"><a class="anchor" id="key-actions-table"></a>
Actions</h3>
<dl class="section note"><dt>Note</dt><dd>This is usually not set explicitly but via the <em><a class="el" href="#interpret-mechanism">interpret mechanism</a></em> by using the <a class="el" href="#interpret-action"><span class="tt">action</span></a> statement in the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section.</dd></dl>
<figure><figcaption><p> Example: Set the modifier action of the key <span class="tt">&lt;LALT&gt;</span> manually. </p></figcaption><div class="fragment"><div class="line">key &lt;LALT&gt; {</div>
<div class="line">    symbols[Group1]=[Alt_L],</div>
<div class="line">    actions[Group1]=[SetMods(modifiers=modMapMods)]</div>
<div class="line">};</div>
</div><!-- fragment --> </figure><p>For further details see <a class="el" href="#key-actions">key actions</a>.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Trailing <span class="tt">NoAction()</span> are dropped.</dd></dl>
<h3 class="doxsection"><a class="anchor" id="key-groups"></a>
Multiple groups</h3>
<p>Each group represents a list of symbols mapped to a keycode: </p><pre class="fragment">name[Group1]= "US/ASCII";
name[Group2]= "Russian";
...
key &lt;AD01&gt; { [ q, Q ],
             [ Cyrillic_shorti, Cyrillic_SHORTI ] };
</pre><p>A long-form syntax can also be used: </p><pre class="fragment">key &lt;AD01&gt; {
    symbols[Group1]= [ q, Q ],
    symbols[Group2]= [ Cyrillic_shorti, Cyrillic_SHORTI ]
};
</pre><p>Groups can also be omitted, but the brackets must be present. The following statement only defines the Group3 of a mapping: </p><pre class="fragment">key &lt;AD01&gt; { [], [], [ q, Q ] };
</pre><dl class="section warning"><dt>Warning</dt><dd>Using multiple groups in <em>symbols</em> files is not recommended, because some tools rely on the assumption that an <span class="tt">xkb_symbols</span> section only affect a single group. It is fine with a <em>keymap</em> file though.</dd></dl>
<h3 class="doxsection"><a class="anchor" id="key-virtual-modifiers"></a>
Virtual modifiers</h3>
<dl class="section note"><dt>Note</dt><dd>This is usually not set explicitly but via the <em><a class="el" href="#interpret-mechanism">interpret mechanism</a></em> by using the <a class="el" href="#interpret-virtualModifier"><span class="tt">virtualModifier</span></a> statement from the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>When setting a <a class="el" href="#modifiers-actions">modifier action</a>, it is required to declare the corresponding virtual modifier using a <a class="el" href="#virtual-modifier-statements"><span class="tt">virtual_modifiers</span></a> statement.</dd></dl>
<figure><figcaption><p> Example: Set the virtual modifier of the key <span class="tt">&lt;LALT&gt;</span> to <span class="tt">Alt</span>. </p></figcaption><div class="fragment"><div class="line"><span class="comment">// Declare the virtual modifier that will be used</span></div>
<div class="line">virtual_modifiers Alt;</div>
<div class="line"> </div>
<div class="line">key  &lt;LALT&gt; {</div>
<div class="line">    virtualModifiers = Alt,</div>
<div class="line">    [ Alt_L ]</div>
<div class="line">};</div>
</div><!-- fragment --> </figure><p>See <a class="el" href="#virtual-modifier-map">virtual modifier map</a> for further information.</p>
<h3 class="doxsection"><a class="anchor" id="key-repeat"></a>
Repeat</h3>
<dl class="section note"><dt>Note</dt><dd>This is usually not set explicitly but via the <em><a class="el" href="#interpret-mechanism">interpret mechanism</a></em> by using the <a class="el" href="#interpret-repeat"><span class="tt">repeat</span></a> statement in the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section.</dd></dl>
<figure><figcaption><p> Example: make the <span class="tt">&lt;LALT&gt;</span> key not repeating. </p></figcaption><div class="fragment"><div class="line">key  &lt;LALT&gt; {</div>
<div class="line">    repeat = False,</div>
<div class="line">    [ Alt_L ]</div>
<div class="line">};</div>
</div><!-- fragment --> </figure><h2 class="doxsection"><a class="anchor" id="modmap-statement"></a>
Real Modifier map</h2>
<p>Bind a <a class="el" href="#real-modifier">*real* modifier</a> to a key, e.g.:</p>
<div class="fragment"><div class="line"><span class="comment">// Bind the real modifier `Control` to the key `&lt;LCTL&gt;` and/or the first key with</span></div>
<div class="line"><span class="comment">// the keysym `Control_L`.</span></div>
<div class="line">modifier_map Control { &lt;LCTL&gt;, Control_L };</div>
</div><!-- fragment --><p>See <a class="el" href="#real-modifier-map">real modifier map</a> for further information.</p>
<h2 class="doxsection"><a class="anchor" id="set-default-values-2"></a>
Set default values</h2>
<p>One may change the default values of the following statements:</p>
<ul>
<li><span class="tt">key</span>: use <span class="tt">key.FIELD = VALUE;</span>. E.g. <span class="tt">key.type = "ALPHABETIC";</span>.</li>
<li><span class="tt">action</span>: use <span class="tt">ACTION_NAME.FIELD = VALUE;</span>. E.g. <span class="tt">setMods.clearLocks= True;</span>.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="modifiers-declaration-and-binding"></a>
Modifiers declaration and binding</h1>
<h2 class="doxsection"><a class="anchor" id="real-and-virtual-modifiers"></a>
Real and virtual modifiers</h2>
<p><a class="el" href="#modifier-def">Modifiers</a> are a particularly tricky part of XKB and deserve their own section. For historical reasons they are divided in two categories:</p>
<dl>
<dt><a class="anchor" id="real-modifier"></a>Real modifier </dt>
<dd><p class="startdd"></p>
<p class="interdd">They are the <b>8</b> <em>predefined</em> (AKA <em>core</em>, <em>X11</em>) modifiers:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name  </th><th class="markdownTableHeadNone">Index/Bit  </th><th class="markdownTableHeadNone">Mask  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone"><span class="tt">0x01</span>  </td><td class="markdownTableBodyNone">Used to type upper case letters of <a href="https://en.wikipedia.org/wiki/Letter_case#Bicameral_script">bicameral scripts</a>; keyboard shortcuts  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><span class="tt">0x02</span>  </td><td class="markdownTableBodyNone">Used to type upper case letters of [bicameral scripts]: ‚ÄúCaps Lock‚Äù  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Control</span>  </td><td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone"><span class="tt">0x04</span>  </td><td class="markdownTableBodyNone">Used in keyboard shortcuts  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod1</span>  </td><td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone"><span class="tt">0x08</span>  </td><td class="markdownTableBodyNone">Generic modifier 1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Mod2</span>  </td><td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone"><span class="tt">0x10</span>  </td><td class="markdownTableBodyNone">Generic modifier 2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod3</span>  </td><td class="markdownTableBodyNone">5  </td><td class="markdownTableBodyNone"><span class="tt">0x20</span>  </td><td class="markdownTableBodyNone">Generic modifier 3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Mod4</span>  </td><td class="markdownTableBodyNone">6  </td><td class="markdownTableBodyNone"><span class="tt">0x40</span>  </td><td class="markdownTableBodyNone">Generic modifier 4  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod5</span>  </td><td class="markdownTableBodyNone">7  </td><td class="markdownTableBodyNone"><span class="tt">0x80</span>  </td><td class="markdownTableBodyNone">Generic modifier 5  </td></tr>
</table>
<p class="interdd">They are the modifiers defined in the <a href="https://www.x.org/releases/current/doc/xproto/x11protocol.html">*core* X11 protocol</a>. They are qualified as ‚Äúreal‚Äù, because in the XKB protocol they denote the <em>bits</em> that <em>encode</em> the modifiers state. See <a class="el" href="#modifiers-encoding">Modifiers encoding</a> for further information.</p>
<p class="enddd">Since they are predefined, they require no <a class="el" href="#virtual-modifier-statements">explicit declaration</a> and have a <em>fixed</em> <a class="el" href="#modifiers-encoding">encoding</a>.  </p>
</dd>
<dt><a class="anchor" id="virtual-modifier"></a>Virtual modifier </dt>
<dd><p class="startdd"></p>
<p class="interdd">They are the modifiers that are <em>not</em> predefined. They require an <a class="el" href="#virtual-modifier-statements">*explicit* declaration</a> and their <a class="el" href="#modifiers-encoding">encoding</a> is <em>user-defined</em>.</p>
<p class="enddd">Note that in X11, the maximum of virtual modifiers is <b>16</b> (see <span class="tt">XkbNumVirtualMods</span>), whereas up to <b>24</b> virtual modifiers can be defined in libxkbcommon, for a total of <b>32</b> modifiers (real + virtual).  </p>
</dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="virtual-modifier-statements"></a>
Modifiers declarations</h2>
<p><em>Virtual</em> modifiers must be declared before their first use with the <span class="tt">virtual_modifiers</span> statement:</p>
<ul>
<li>Declare a <em>single</em> modifier: <div class="fragment"><div class="line">virtual_modifiers MyModifier;</div>
</div><!-- fragment --></li>
<li>Declare <em>multiple</em> modifiers using a comma-separated list: <div class="fragment"><div class="line">virtual_modifiers M1, M2, M3.</div>
</div><!-- fragment --></li>
</ul>
<p>Furthermore, it is possible to set the <a class="el" href="#explicit-modifier-encoding">explicit modifier encoding</a> with the following syntax:</p>
<ul>
<li>Use a <em>real</em> modifier mask: <div class="fragment"><div class="line"><span class="comment">// Single modifier: real modifier</span></div>
<div class="line">virtual_modifiers M1 = Mod3;</div>
<div class="line"><span class="comment">// Single modifier: using mask as a plus-separated list</span></div>
<div class="line">virtual_modifiers M2 = Mod4+Mod5;</div>
<div class="line"><span class="comment">// Multiple modifiers</span></div>
<div class="line">virtual_modifiers M1 = Mod3, M2 = Mod4+Mod5;</div>
</div><!-- fragment --></li>
<li>Use a <em>numeric</em> mask: <div class="fragment"><div class="line">virtual_modifiers M1 = 0x20;</div>
<div class="line">virtual_modifiers M2 = 0xC0;</div>
<div class="line">virtual_modifiers M1 = 0x20, M2 = 0xC0;</div>
</div><!-- fragment --></li>
<li>Use <span class="tt">none</span>, an alias for <span class="tt">0</span>: <div class="fragment"><div class="line">virtual_modifiers M1 = none;</div>
<div class="line"><span class="comment">// Equivalent to: M1 = 0;</span></div>
</div><!-- fragment --></li>
</ul>
<p>This can be done in the <a class="el" href="#the-xkb_types-section"><span class="tt">xkb_types</span></a>, <a class="el" href="#the-xkb_compat-section"><span class="tt">xkb_compat</span></a> and <a class="el" href="#the-xkb_symbols-section"><span class="tt">xkb_symbols</span></a> sections.</p>
<h2 class="doxsection"><a class="anchor" id="modifiers-bindings"></a>
Modifiers key bindings</h2>
<p>Each key has two <b>modifiers maps</b>:</p>
<dl>
<dt><a class="anchor" id="real-modifier-map"></a><em>Real</em> modifier map </dt>
<dd><p class="startdd"></p>
<p class="interdd">List the <a class="el" href="#real-modifier">*real* modifiers</a> associated to the key.</p>
<p class="interdd">It is used as a compatibility layer for the X11 core protocol and to apply <a class="el" href="#interpret-statements">interpretations</a>.</p>
<p class="enddd">See <a class="el" href="#set-real-mod-map">Setting the real modifier map</a> for further information.  </p>
</dd>
<dt><a class="anchor" id="virtual-modifier-map"></a><em>Real</em> modifier map </dt>
<dd><p class="startdd"></p>
<p class="interdd">List the <a class="el" href="#virtual-modifier">*virtual* modifiers</a> associated to the key.</p>
<p class="interdd">It is used to set the <a class="el" href="#implicit-modifier-encoding">implicit encoding</a> of virtual modifiers.</p>
<p class="enddd">See <a class="el" href="#set-virtual-mod-map">Setting the virtual modifier map</a> for further information.  </p>
</dd>
</dl>
<h3 class="doxsection"><a class="anchor" id="set-real-mod-map"></a>
Setting the real modifier map</h3>
<p>The <a class="el" href="#real-modifier-map">real modifier map</a> is set in the <a class="el" href="#the-xkb_symbols-section"><span class="tt">xkb_symbols</span></a> section using the <span class="tt">modifier_map</span> statement:</p>
<ul>
<li>Bind <em>directly</em> to a <b>keycode</b>, e.g.: <div class="fragment"><div class="line"><span class="comment">// Bind `Mod1` to the keycode &lt;LALT&gt;.</span></div>
<div class="line">modifier_map Mod1 { &lt;LALT&gt; };</div>
</div><!-- fragment --></li>
<li><p class="startli">Bind <em>indirectly</em> via a <b>keysym</b>, e.g.: </p><div class="fragment"><div class="line"><span class="comment">// Bind `Mod1` looking up for the keysym `Alt_L`</span></div>
<div class="line">modifier_map Mod1 { Alt_L };</div>
</div><!-- fragment --><p class="startli">Indirect bindings require to be resolved to a <em>single direct</em> bindings. Given a keysym, there can be multiple keys that generate it, so the corresponding key is chosen following this order:</p><ol type="1">
<li>by lowest group in which the keysym appears,</li>
<li>by lowest level,</li>
<li>by lowest key code.</li>
</ol>
</li>
<li>Bind using a comma-separated <b>list</b> of keycodes and keysyms: <div class="fragment"><div class="line"><span class="comment">// Bind `Mod1` diretly to keycode &lt;LALT&gt; and indirectly via the keysym `Alt_L`</span></div>
<div class="line">modifier_map Mod1 { &lt;LALT&gt;, Alt_L };</div>
</div><!-- fragment --></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>A key can be associated to <em>at most <b>one</b></em> real modifier.</dd></dl>
<p>There is also a special entry, <span class="tt">None</span>, that enable <em>deleting</em> a previous entry:</p>
<div class="fragment"><div class="line">modifier_map None { &lt;LALT&gt; };</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><span class="tt">None</span> must use the <em>exact</em> same target (keycode or keysym) in order to delete the corresponding previous entry: <div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    key &lt;LALT&gt; { [Alt_L] };</div>
<div class="line">    modifier_map Mod1 { &lt;LALT&gt; };</div>
<div class="line">    <span class="comment">// Does *not* delete previous entry (expected keycode, got keysym)</span></div>
<div class="line">    modifier_map None { Alt_L };</div>
<div class="line">    <span class="comment">// *Does* delete previous entry (correct expected keycode)</span></div>
<div class="line">    modifier_map None { &lt;LALT&gt; };</div>
<div class="line">};</div>
</div><!-- fragment --></dd></dl>
<h3 class="doxsection"><a class="anchor" id="set-virtual-mod-map"></a>
Setting the virtual modifier map</h3>
<p>The <a class="el" href="#virtual-modifier-map">virtual modifier map</a> can be set in 2 ways:</p><ul>
<li><em>Directly</em> in the <a class="el" href="#the-xkb_symbols-section"><span class="tt">xkb_symbols</span></a> section using the <span class="tt">virtualModifiers</span> key property: <div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    <span class="comment">// Virtual modifiers must be declared before use</span></div>
<div class="line">    virtual_modifiers Alt;</div>
<div class="line"> </div>
<div class="line">    key &lt;LALT&gt; {</div>
<div class="line">        <span class="comment">// Explicit virtual modifier map</span></div>
<div class="line">        virtualModifiers = Alt,</div>
<div class="line">        ...</div>
<div class="line">    };</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><em>Indirectly</em> using <a class="el" href="#interpret-statements">interpretations</a> in <a class="el" href="#the-xkb_compat-section"><span class="tt">xkb_compat</span></a> and the corresponding <a class="el" href="#the-xkb_symbols-section"><span class="tt">xkb_symbols</span></a> keysyms: <div class="fragment"><div class="line">xkb_compat {</div>
<div class="line">    <span class="comment">// Virtual modifiers must be declared before use</span></div>
<div class="line">    virtual_modifiers Alt, Super;</div>
<div class="line"> </div>
<div class="line">    interpret Alt_L {</div>
<div class="line">        <span class="comment">// Bind the virtual modifier‚Ä¶</span></div>
<div class="line">        virtualModifier = Alt;</div>
<div class="line">        <span class="comment">// ‚Ä¶ independently of the group and level (default)</span></div>
<div class="line">        useModMap = AnyLevel;</div>
<div class="line">    };</div>
<div class="line">    interpret Super_L {</div>
<div class="line">        <span class="comment">// Bind the virtual modifier‚Ä¶</span></div>
<div class="line">        virtualModifier = Super;</div>
<div class="line">        <span class="comment">// ‚Ä¶ only if the keysym is on the first level of the first group</span></div>
<div class="line">        useModMap = Level1;</div>
<div class="line">    };</div>
<div class="line">};</div>
<div class="line">xkb_symbols {</div>
<div class="line">    <span class="comment">// Successful bindings</span></div>
<div class="line">    key &lt;LALT&gt; { [Alt_L] };</div>
<div class="line">    key &lt;LALT&gt; { [No,Symbol, Alt_L] };    <span class="comment">// independent of group and level</span></div>
<div class="line">    key &lt;LALT&gt; { [], [NoSymbol, Alt_L] }; <span class="comment">// independent of group and level</span></div>
<div class="line"> </div>
<div class="line">    key &lt;LWIN&gt; { [Super_L] };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Unsuccessful bindings</span></div>
<div class="line">    key &lt;LWIN&gt; { [NoSymbol, Super_L] };   <span class="comment">// requires first level</span></div>
<div class="line">    key &lt;LWIN&gt; { [], [Super_L] };         <span class="comment">// requires first group</span></div>
<div class="line">};</div>
</div><!-- fragment --></li>
</ul>
<h2 class="doxsection"><a class="anchor" id="modifiers-encoding"></a>
Modifiers encoding</h2>
<p>Each modifier has an associated <b>32 bit mask</b> used to <em>encode</em> it in the keyboard state. The keyboard state represents active modifiers with the bitwise OR of the encoding of each active modifiers.</p>
<dl class="section note"><dt>Note</dt><dd>Display servers may use a different encoding in their protocols:<ul>
<li><b>Wayland protocol:</b> use the same <em>32-bit</em> encoding as libxkbcommon and support its full range of modifiers.</li>
<li><b>X11 protocol:</b> use a <em>8-bit</em> encoding. It supports only using <a class="el" href="#real-modifier">real modifiers</a> to encode <a class="el" href="#virtual-modifier">virtual modifiers</a>.</li>
</ul>
</dd></dl>
<dl class="section important"><dt>Important</dt><dd><ul>
<li><a class="el" href="#real-modifier">Real modifiers</a> have a <em>fixed predefined</em> encoding.</li>
<li><a class="el" href="#virtual-modifier">Virtual modifiers</a> have a <em>user-defined</em> encoding.</li>
</ul>
</dd></dl>
<p>Virtual modifiers require to be encoded by the user, <em>implicitly</em> (using the <a class="el" href="#auto-modifier-encoding">auto mode</a> and/or the <a class="el" href="#implicit-modifier-encoding">legacy mode</a>) and/or <a class="el" href="#explicit-modifier-encoding">*explicitly*</a>, the combination resulting in their <a class="el" href="#effective-modifier-encoding">*effective*</a> encoding.</p>
<dl>
<dt><a class="anchor" id="implicit-modifier-encoding"></a><em>Implicit</em> modifier encoding </dt>
<dd><p class="startdd"></p>
<p class="interdd">Virtual modifiers <em>always</em> compute their implicit encoding, which is defined for a given virtual modifier by the bitwise OR of all the <a class="el" href="#real-modifier-map">real modifier maps</a> where the virtual modifier is in the <a class="el" href="#virtual-modifier-map">virtual modifier map</a> of the corresponding key.</p>
<p class="interdd">Example:</p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    virtual_modifiers Alt;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Virtual modifier map: Alt is bound to &lt;LALT&gt;</span></div>
<div class="line">    <span class="comment">// Note: alternatively one can use xkb_compat interpretations.</span></div>
<div class="line">    key &lt;LALT&gt; { virtualModifier = Alt };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Real modifier map: Mod1 is bound to &lt;LALT&gt;</span></div>
<div class="line">    modifier_map Mod1 { &lt;LALT&gt; };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Implicit encoding: Alt = Mod1</span></div>
<div class="line">};</div>
</div><!-- fragment -->  </dd>
<dt><a class="anchor" id="explicit-modifier-encoding"></a><em>Explicit</em> modifier encoding </dt>
<dd><p class="startdd"></p>
<p class="interdd">Virtual modifiers can optionally define an initial mapping using the <a class="el" href="#virtual-modifier-statements"><span class="tt">virtual_modifiers</span></a> statements:</p>
<div class="fragment"><div class="line">virtual_modifiers M1 = Mod1;     <span class="comment">// Single real modifier</span></div>
<div class="line">virtual_modifiers M2 = Mod4+Mod5;<span class="comment">// Real modifier mask</span></div>
<div class="line">virtual_modifiers M3 = 0x400;    <span class="comment">// Numeric mask</span></div>
</div><!-- fragment --><p class="interdd">See <a class="el" href="#virtual-modifier-statements">Modifiers declarations</a> for further information.</p>
<dl class="section warning"><dt>Warning</dt><dd>Although it is explicit, this may not be the <a class="el" href="#effective-modifier-encoding">effective encoding</a>, detailed hereinafter.  </dd></dl>
</dd>
<dt><a class="anchor" id="effective-modifier-encoding"></a><em>Effective</em> modifier encoding </dt>
<dd><p class="startdd">The effective encoding is the bitwise OR of the <a class="el" href="#explicit-modifier-encoding">explicit modifier encoding</a> and the <a class="el" href="#implicit-modifier-encoding">implicit modifier encoding</a>.</p>
<dl class="section note"><dt>Note</dt><dd><a class="anchor" id="auto-modifier-encoding"></a>If using <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>, virtual modifiers that were not mapped either <em>implicitly</em> using the <span class="tt">virtualModifier</span>/<span class="tt">modifier_map</span> feature hereinabove or <a class="el" href="#explicit-modifier-encoding">*explicitly*</a>, then they are mapped to their <a class="el" href="#canonical-modifier-def">*canonical* mapping</a>.</dd></dl>
<p>Example:</p>
<div class="fragment"><div class="line">xkb_symbols {</div>
<div class="line">    virtual_modifiers Alt, Meta, Super = none, Hyper = 0x1000, Useless = none;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Virtual modifier maps</span></div>
<div class="line">    <span class="comment">// Note: alternatively one can use xkb_compat interpretations.</span></div>
<div class="line">    key &lt;LALT&gt; { virtualModifier = Alt   }; <span class="comment">// Alt is bound to &lt;LALT&gt;</span></div>
<div class="line">    key &lt;LWIN&gt; { virtualModifier = Super }; <span class="comment">// Super is bound to &lt;LWIN&gt;</span></div>
<div class="line">    key &lt;RWIN&gt; { virtualModifier = Super }; <span class="comment">// Super is bound to &lt;RWIN&gt;</span></div>
<div class="line">    key &lt;HYPR&gt; { virtualModifier = Hyper }; <span class="comment">// Hyper is bound to &lt;HYPR&gt;</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Real modifier maps</span></div>
<div class="line">    modifier_map Mod1 { &lt;LALT&gt; }; <span class="comment">// Mod1 is bound to &lt;LALT&gt;</span></div>
<div class="line">    modifier_map Mod4 { &lt;LWIN&gt; }; <span class="comment">// Mod4 is bound to &lt;LWIN&gt;</span></div>
<div class="line">    modifier_map Mod5 { &lt;RWIN&gt; }; <span class="comment">// Mod5 is bound to &lt;RWIN&gt;</span></div>
<div class="line">    modifier_map Mod3 { &lt;HYPR&gt; }; <span class="comment">// Mod3 is bound to &lt;HYPR&gt;</span></div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --><table class="doxtable">
<caption>Modifiers encoding of the previous example</caption>
<tr>
<th>Modifier</th><th>Index</th><th colspan="5">Encoding</th></tr>
<tr>
<th></th><th></th><th>Canonical</th><th>Explicit</th><th>Implicit</th><th colspan="2">Effective</th></tr>
<tr>
<th></th><th colspan="2">(xkbcommon)</th><th colspan="2"></th><th><span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3ad63ee709a87611a89b42c3e1275347ed" title="The classic XKB text format, as generated by xkbcomp -xkb.">XKB_KEYMAP_FORMAT_TEXT_V1</a></span></th><th><span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span></th></tr>
<tr>
<th>Alt</th><td>8</td><td><span class="tt">0x100</span></td><td></td><td><span class="tt">Mod1</span></td><td><span class="tt">Mod1</span></td><td><span class="tt">Mod1</span></td></tr>
<tr>
<th>Meta</th><td>9</td><td><span class="tt">0x200</span></td><td></td><td></td><td>0 (unmapped)</td><td><span class="tt">0x200</span> (canonical, xkbcommon value)</td></tr>
<tr>
<th>Super</th><td>10</td><td><span class="tt">0x400</span></td><td>0</td><td><span class="tt">Mod4 + Mod5</span></td><td><span class="tt">Mod4 + Mod5</span></td><td><span class="tt">Mod4 + Mod5</span></td></tr>
<tr>
<th>Hyper</th><td>11</td><td><span class="tt">0x800</span></td><td><span class="tt">0x1000</span></td><td></td><td><span class="tt">0x1000</span></td><td><span class="tt">0x1000</span></td></tr>
<tr>
<th>Useless</th><td>12</td><td><span class="tt">0x1000</span></td><td>0</td><td></td><td>0 (unmapped)</td><td>0 (explicit mapping)</td></tr>
</table>
</dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="canonical-and-non-canonical-modifiers"></a>
Canonical and non-canonical modifiers</h2>
<p><a class="anchor" id="canonical-modifier-def"></a>A <b>canonical modifier</b> have an encoding defined by: <span class="tt">1 &lt;&lt; mod_index</span>, where <span class="tt">mod_index</span> is:</p><ul>
<li>Fixed for the <em>real</em> modifiers, in order to match the X11 values. See <a class="el" href="#real-modifier">real modifiers mapping</a>.</li>
<li>Implementation-dependent for the the <em>virtual</em> modifiers. See <a class="el" href="#xkbcommon-vmod-encoding">xkbcomp and libxkbcommon implementations</a> for further details.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="usual-modifiers-keysyms"></a>
Usual modifiers and associated keysyms</h2>
<p>The following table summarizes the modifiers defined in <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config"><span class="tt">xkeyboard-config</span> 2.44</a>:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Modifier  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Compat files  </th><th class="markdownTableHeadNone">Associated keysyms  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="2"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone" rowspan="2">Real  </td><td class="markdownTableBodyNone"><span class="tt">compat/basic</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift_L</span>, <span class="tt">Shift_R</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">compat/iso9995</span>  </td><td class="markdownTableBodyNone"><span class="tt">Shift_L</span>, <span class="tt">Shift_R</span>, <span class="tt">ISO_Level2_Latch</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="2"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone" rowspan="2">Real  </td><td class="markdownTableBodyNone"><span class="tt">compat/basic</span>,  </td><td class="markdownTableBodyNone" rowspan="2"><span class="tt">Caps_Lock</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">compat/caps</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Control</span>  </td><td class="markdownTableBodyNone">Real  </td><td class="markdownTableBodyNone"><span class="tt">compat/basic</span>  </td><td class="markdownTableBodyNone"><span class="tt">Control_L</span>, <span class="tt">Control_R</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="2"><span class="tt">Alt</span>  </td><td class="markdownTableBodyNone" rowspan="2">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/misc</span>,  </td><td class="markdownTableBodyNone" rowspan="2"><span class="tt">Alt_L</span>, <span class="tt">Alt_R</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">compat/pc</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Meta</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/misc</span>  </td><td class="markdownTableBodyNone"><span class="tt">Meta_L</span>, <span class="tt">Meta_R</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Super</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/misc</span>  </td><td class="markdownTableBodyNone"><span class="tt">Super_L</span>, <span class="tt">Super_R</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Hyper</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/misc</span>  </td><td class="markdownTableBodyNone"><span class="tt">Hyper_L</span>, <span class="tt">Hyper_R</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">ScrollLock</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/misc</span>  </td><td class="markdownTableBodyNone"><span class="tt">Scroll_Lock</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="2"><span class="tt">NumLock</span>  </td><td class="markdownTableBodyNone" rowspan="2">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/basic</span>,  </td><td class="markdownTableBodyNone"><span class="tt">Num_Lock</span>,  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">compat/level5</span>  </td><td class="markdownTableBodyNone">(<span class="tt">ISO_Level5_Lock</span>)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">LevelThree</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/iso9995</span>  </td><td class="markdownTableBodyNone"><span class="tt">ISO_Level3_Shift</span>, <span class="tt">ISO_Level3_Latch</span>, <span class="tt">ISO_Level3_Lock</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LevelFive</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/level5</span>  </td><td class="markdownTableBodyNone"><span class="tt">ISO_Level5_Shift</span>, <span class="tt">ISO_Level5_Latch</span>, <span class="tt">ISO_Level5_Lock</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Kana_Lock</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/japan</span>  </td><td class="markdownTableBodyNone"><span class="tt">Kana_Lock</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Square</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/olpc</span>  </td><td class="markdownTableBodyNone"><span class="tt">KP_Home</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Cross</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/olpc</span>  </td><td class="markdownTableBodyNone"><span class="tt">KP_Next</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Circle</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/olpc</span>  </td><td class="markdownTableBodyNone"><span class="tt">KP_End</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Triangle</span>  </td><td class="markdownTableBodyNone">Virtual  </td><td class="markdownTableBodyNone"><span class="tt">compat/olpc</span>  </td><td class="markdownTableBodyNone"><span class="tt">KP_Prior</span>  </td></tr>
</table>
<h2 class="doxsection"><a class="anchor" id="modifiers-portability"></a>
Modifiers portability</h2>
<h3 class="doxsection"><a class="anchor" id="avoid-using-numeric-modifier-masks"></a>
Avoid using numeric modifier masks</h3>
<dl class="section note"><dt>Note</dt><dd>Any field that accept virtual modifier <em>names</em> is a virtual modifier <em>mask</em>, denoting virtual modifiers <em>indices</em>. These indices are implementation-specific and should not be leaked. Therefore any <em>numeric</em> value used for these fields should be interpreted equally as a virtual modifier mask, and is thus implementation-specific.</dd></dl>
<dl class="section important"><dt>Important</dt><dd>In order to preserve <a class="el" href="#modifiers-encoding">modifier encoding</a> <em>portability</em>, XKB implementations are recommended to <b>avoid <em>numeric</em> modifier masks</b> and to <b>use virtual modifiers <em>names</em> whenever possible</b> when serializing the keymap. This avoids <em>leaking</em> the indices of the modifiers.</dd></dl>
<h3 class="doxsection"><a class="anchor" id="xkbcommon-vmod-encoding"></a>
xkbcomp and libxkbcommon implementations</h3>
<dl class="section attention"><dt>Attention</dt><dd>This section is not part of the keymap text format specification and presents libxkbcommon‚Äôs <em>implementation details</em> that may change, solely for the purpose of informing other XKB implementation. <b>Users should not rely on this!</b></dd></dl>
<p>Both X11 xkbcomp and libxkbcommon currently implement modifiers indices as follow:</p>
<ol type="1">
<li>Real modifiers have the following indices:<a class="anchor" id="real-modifier-indices"></a><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name  </th><th class="markdownTableHeadNone">Index  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Shift</span>  </td><td class="markdownTableBodyNone">0  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Lock</span>  </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Control</span>  </td><td class="markdownTableBodyNone">2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod1</span>  </td><td class="markdownTableBodyNone">3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Mod2</span>  </td><td class="markdownTableBodyNone">4  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod3</span>  </td><td class="markdownTableBodyNone">5  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Mod4</span>  </td><td class="markdownTableBodyNone">6  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Mod5</span>  </td><td class="markdownTableBodyNone">7  </td></tr>
</table>
</li>
<li>Virtual modifiers names are assigned to virtual modifier indices following their order of appearance in a keymap component, if that name was not previously assigned.</li>
<li>Indices are assigned in <em>ascending order</em>, from 0.</li>
<li>If an index is already assigned to a different name, then the next free index is used.</li>
<li>The order of the relevant keymap components used for virtual mods assignment is:<ol type="a">
<li><a class="el" href="#the-xkb_types-section">xkb_types</a></li>
<li><a class="el" href="#the-xkb_compat-section">xkb_compat</a></li>
<li><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a></li>
</ol>
</li>
<li>A virtual modifier <em>mask</em> always denotes virtual modifiers <em>indices</em>.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>It suffices to declare all virtual modifiers in <a class="el" href="#the-xkb_types-section">xkb_types</a> (or if empty, whatever non-empty section afterwards, in the order specified above) in their ascending indices order to use virtual modifiers indices <b>compatible with libxkbcommon</b>.</dd></dl>
<h2 class="doxsection"><a class="anchor" id="example-define-and-use-a-modifier-step-by-step"></a>
Example: define and use a modifier, step by step</h2>
<p>We will use the example of the <em>real</em> modifier <span class="tt">Shift</span> and the virtual modifier <span class="tt">LevelThree</span> in <span class="tt">xkeyboard-config</span>.</p>
<p>In order to define and use a modifier, one must:</p>
<ol type="1">
<li><p class="startli">Define its behavior and <a class="el" href="#keysym-def">keysym</a> binding in the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section:</p>
<div class="fragment"><div class="line"><span class="comment">// Declare virtual modifiers. Shift being real modifier,</span></div>
<div class="line"><span class="comment">// we do not need to add it here.</span></div>
<div class="line">virtual_modifiers LevelThree;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set defaults. They are overridden if set directly in the xkb_symbols.</span></div>
<div class="line">interpret.repeat= False; <span class="comment">// only applied on first level</span></div>
<div class="line">setMods.clearLocks= True;</div>
<div class="line">latchMods.clearLocks= True;</div>
<div class="line">latchMods.latchToLock= True;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Default statement for real modifiers: any key bound to a real</span></div>
<div class="line"><span class="comment">// modifier via modifier_map will set this modifier at all its</span></div>
<div class="line"><span class="comment">// levels.</span></div>
<div class="line"><span class="comment">// Here only to illustrate: do not add it!</span></div>
<div class="line">interpret Any + Any {</div>
<div class="line">    action= SetMods(modifiers=modMapMods);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Shift being real modifier, we do not need a corresponding</span></div>
<div class="line"><span class="comment">// interpret statement because the previous one suffices.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Let‚Äôs associate LevelThree to the keysym ISO_Level3_Shift</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// First, match the keys and their levels with the</span></div>
<div class="line"><span class="comment">// ISO_Level3_Shift keysym and with any real modifier</span></div>
<div class="line"><span class="comment">// (Any = AnyOf(all)) in its modmap.</span></div>
<div class="line">interpret ISO_Level3_Shift+Any {</div>
<div class="line">    <span class="comment">// Only match the first level of the first group</span></div>
<div class="line">    useModMapMods= level1;</div>
<div class="line">    <span class="comment">// Add the virtual modifier to the key‚Äôs vmodmap</span></div>
<div class="line">    virtualModifier= LevelThree;</div>
<div class="line">    <span class="comment">// Activate the LevelThree modifier (depressed mode)</span></div>
<div class="line">    action= SetMods(modifiers=LevelThree);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Then for keys and their levels with the</span></div>
<div class="line"><span class="comment">// ISO_Level3_Shift keysym but with either no real modifier</span></div>
<div class="line"><span class="comment">// in its modmap or a level higher than 1.</span></div>
<div class="line"><span class="comment">// Indeed:</span></div>
<div class="line"><span class="comment">// ‚Ä¢ In case the level is higher than 1 there is no match</span></div>
<div class="line"><span class="comment">//   in the previous statement.</span></div>
<div class="line"><span class="comment">// ‚Ä¢ The condition is equivalent to</span></div>
<div class="line"><span class="comment">//   ISO_Level3_Shift+AnyOfOrNone(all), but since</span></div>
<div class="line"><span class="comment">//   the previous statement ISO_Level3_Shift+Any is more</span></div>
<div class="line"><span class="comment">//   specific, it will be matched before this one.</span></div>
<div class="line">interpret ISO_Level3_Shift {</div>
<div class="line">    <span class="comment">// Activate the LevelThree modifier (depressed mode)</span></div>
<div class="line">    action= SetMods(modifiers=LevelThree);</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><p class="startli">Define <a class="el" href="#key-type-def">key types</a> that use it in the <code><a class="el" href="#the-xkb_types-section">xkb_types</a></code> section:</p>
<div class="fragment"><div class="line"><span class="comment">// Declare virtual modifiers. Shift being real modifier,</span></div>
<div class="line"><span class="comment">// we do not need to add it here.</span></div>
<div class="line">virtual_modifiers LevelThree;</div>
<div class="line"> </div>
<div class="line">type <span class="stringliteral">&quot;FOUR_LEVEL&quot;</span> {</div>
<div class="line">    <span class="comment">// Key type modifier mask: all the modifiers used in the key type</span></div>
<div class="line">    modifiers = Shift + LevelThree;</div>
<div class="line">    map[None] = Level1;</div>
<div class="line">    map[Shift] = Level2;</div>
<div class="line">    map[LevelThree] = Level3;</div>
<div class="line">    map[Shift+LevelThree] = Level4;</div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">    level_name[Level3] = <span class="stringliteral">&quot;AltGr&quot;</span>;</div>
<div class="line">    level_name[Level4] = <span class="stringliteral">&quot;Shift AltGr&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><p class="startli">Bind it to a <a class="el" href="#keycode-def">keycode</a> in the <code><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a></code> section:</p><ol type="a">
<li>Map <a class="el" href="#keysym-def">keysyms</a> used in the <span class="tt">xkb_compat</span> section hereinabove.</li>
<li>Bind <a class="el" href="#real-modifier-def">real modifiers</a> to keys using these keysyms with <span class="tt">modifier_map</span>.</li>
</ol>
<p class="startli"><em>Note:</em> Only one key binding to real modifier is required. The corresponding keysym must then be on the first level of the first Group.</p>
<p class="startli"><em>Note:</em> One can optionally bind directly a virtual modifier to a key using <span class="tt">virtualmodifiers</span> instead of doing it in the <span class="tt">xkb_compat</span> section. But the recommended way is to use the <span class="tt">xkb_compat</span> section.</p>
<div class="fragment"><div class="line"><span class="comment">// Shift: defined in pc symbols</span></div>
<div class="line">key &lt;LFSH&gt; {[  Shift_L    ]};</div>
<div class="line">key &lt;RTSH&gt; {[  Shift_R    ]};</div>
<div class="line">modifier_map Shift { Shift_L, Shift_R };</div>
<div class="line"><span class="comment">// The previous will resolve to:</span></div>
<div class="line"><span class="comment">// modifier_map Shift { &lt;LFSH&gt;, &lt;RTSH&gt; };</span></div>
<div class="line"><span class="comment">// Thus the real modifier Shift is added to the modmap of</span></div>
<div class="line"><span class="comment">// &lt;LFSH&gt; and &lt;RTSH&gt;.</span></div>
<div class="line"><span class="comment">// The ‚ÄúAny + Any‚Äù interpret statement matches &lt;LFSH&gt; and &lt;RTSH&gt;,</span></div>
<div class="line"><span class="comment">// therefore these keys set the Shift modifier.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// LevelThree: defined in pc symbols</span></div>
<div class="line"><span class="comment">// With the following 2 lines:</span></div>
<div class="line"><span class="comment">// 1. The modifier keysym is on the first level of the first group.</span></div>
<div class="line"><span class="comment">// 2. The real modifier Mod5 is bound to &lt;LVL3&gt;,</span></div>
<div class="line"><span class="comment">//    i.e. Mod5 is added to its modmap.</span></div>
<div class="line"><span class="comment">// 3. It matches the interpret statement ‚ÄúISO_Level3_Shift+Any‚Äù,</span></div>
<div class="line"><span class="comment">//    which adds the LevelThree modifier to the vmodmap of &lt;LVL3&gt;.</span></div>
<div class="line"><span class="comment">// 4. The mapping of LevelThree to real modifiers is the union</span></div>
<div class="line"><span class="comment">//    of modmaps with corresponding vmodmaps containing</span></div>
<div class="line"><span class="comment">//    LevelThree. In our case there is only one: therefore</span></div>
<div class="line"><span class="comment">//    LevelThree maps to Mod5.</span></div>
<div class="line">key &lt;LVL3&gt; {[  ISO_Level3_Shift  ]};</div>
<div class="line">modifier_map Mod5  { &lt;LVL3&gt; };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// LevelThree: defined in level3 symbols</span></div>
<div class="line"><span class="comment">// Not bound to a real modifier, so interpret statement</span></div>
<div class="line"><span class="comment">// ‚ÄúISO_Level3_Shift‚Äù applies.</span></div>
<div class="line">key &lt;RALT&gt; {[ISO_Level3_Shift], type[group1]=<span class="stringliteral">&quot;ONE_LEVEL&quot;</span> };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Note: we could have the following line, but it is not necessary</span></div>
<div class="line"><span class="comment">// because we have the mappings of &lt;LVL3&gt;.</span></div>
<div class="line"><span class="comment">// modifier_map Mod5  { &lt;RALT&gt; };</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Warning: if we had the for example the following line, the</span></div>
<div class="line"><span class="comment">// mapping of LevelThree to real modifiers would be ‚ÄúMod1+Mod5‚Äù.</span></div>
<div class="line"><span class="comment">// modifier_map Mod1  { &lt;RALT&gt; };</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Alternative definitions, without using interpret statements</span></div>
<div class="line">virtual_modifiers LevelThree;</div>
<div class="line">key &lt;LVL3&gt; { virtualmodifiers=LevelThree</div>
<div class="line">           , repeats=False</div>
<div class="line">           , symbols[Group1] = [ISO_Level3_Shift]</div>
<div class="line">           , actions[Group1] = [SetMods(modifiers=LevelThree)] };</div>
<div class="line">modifier_map Mod5  { &lt;LVL3&gt; };</div>
<div class="line">key &lt;RALT&gt; { repeat=False</div>
<div class="line">           , symbols[Group1] = [ISO_Level3_Shift]</div>
<div class="line">           , actions[Group1] = [SetMods(modifiers=LevelThree)]</div>
<div class="line">           , type[group1]=<span class="stringliteral">&quot;ONE_LEVEL&quot;</span> };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// FOUR_LEVEL key type example from latin symbols</span></div>
<div class="line">key &lt;AB05&gt; {[b, B, leftdoublequotemark, leftsinglequotemark]};</div>
</div><!-- fragment --></li>
</ol>
<h1 class="doxsection"><a class="anchor" id="key-actions"></a>
Key actions</h1>
<p>The following table provide an overview of the available actions:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Category  </th><th class="markdownTableHeadNone">Action name  </th><th class="markdownTableHeadNone">Alias  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="#ineffectual-actions">Ineffectual action</a>  </td><td class="markdownTableBodyNone"><a class="el" href="#no-action"><span class="tt">NoAction</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><b>Default action</b>: <em>implicitly</em> do nothing  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="#void-action"><span class="tt">VoidAction</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><em>Explicitly</em> do nothing  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="3"><a class="el" href="#modifiers-actions">Modifier action</a>  </td><td class="markdownTableBodyNone"><a class="el" href="#set-mods-action"><span class="tt">SetMods</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em><a class="el" href="#depressed-mod-def">depressed</a></em> modifiers  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="#latch-mods-action"><span class="tt">LatchMods</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em><a class="el" href="#latched-mod-def">latched</a></em> modifiers  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="#lock-mods-action"><span class="tt">LockMods</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em><a class="el" href="#locked-mod-def">locked</a></em> modifiers  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="3"><a class="el" href="#group-actions">Group action</a>  </td><td class="markdownTableBodyNone"><a class="el" href="#set-group-action"><span class="tt">SetGroup</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em>base</em> group  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="#latch-group-action"><span class="tt">LatchGroup</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em>latched</em> group  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="#lock-group-action"><span class="tt">LockGroup</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em>locked</em> group  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="9"><a class="el" href="#legacy-x11-actions">Legacy action</a>  </td><td class="markdownTableBodyNone"><span class="tt">MovePointer</span>  </td><td class="markdownTableBodyNone"><span class="tt">MovePtr</span>  </td><td class="markdownTableBodyNone">Move the mouse pointer  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">PointerButton</span>  </td><td class="markdownTableBodyNone"><span class="tt">PtrBtn</span>  </td><td class="markdownTableBodyNone">Simulate a mouse button press  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LockPointerButton</span>  </td><td class="markdownTableBodyNone"><span class="tt">LockPtrBtn</span>  </td><td class="markdownTableBodyNone">Simulate a mouse button press, locked until the action‚Äôs key is pressed again.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">SetPointerDefault</span>  </td><td class="markdownTableBodyNone"><span class="tt">SetPtrDflt</span>  </td><td class="markdownTableBodyNone">Set the default select button (???)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="#set-controls-action"><span class="tt">SetControls</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Set the standard XKB controls  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="#lock-controls-action"><span class="tt">LockControls</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Lock the standard XKB controls  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="#terminate-server-action"><span class="tt">TerminateServer</span></a>  </td><td class="markdownTableBodyNone"><span class="tt">Terminate</span>  </td><td class="markdownTableBodyNone">Shut down the X server  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">SwitchScreen</span>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Switch virtual X screen  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="#private-action"><span class="tt">Private</span></a>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Raw encoding of an action  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="6"><a class="el" href="#unsupported-legacy-x11-actions">Unsupported legacy action</a>  </td><td class="markdownTableBodyNone"><a class="el" href="#redirect-key-action"><span class="tt">RedirectKey</span></a>  </td><td class="markdownTableBodyNone"><span class="tt">Redirect</span>  </td><td class="markdownTableBodyNone">Emulate pressing a key with a different key code  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">ISOLock</span>  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Convert ordinary modifier key actions into lock actions while this action is active  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">DeviceButton</span>  </td><td class="markdownTableBodyNone"><span class="tt">DevBtn</span>  </td><td class="markdownTableBodyNone">Emulate an event from an arbitrary input device such as a joystick  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">LockDeviceButton</span>  </td><td class="markdownTableBodyNone"><span class="tt">LockDevBtn</span>  </td><td class="markdownTableBodyNone">Emulate an event from an arbitrary input device such as a joystick  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">DeviceValuator</span>  </td><td class="markdownTableBodyNone"><span class="tt">DevVal</span>  </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">MessageAction</span>  </td><td class="markdownTableBodyNone"><span class="tt">Message</span>  </td><td class="markdownTableBodyNone">Generate an arbitrary special-purpose XKB event  </td></tr>
</table>
<p>Common syntax:</p><ul>
<li>Boolean values:<ul>
<li><span class="tt">true</span>, <span class="tt">yes</span>, <span class="tt">on</span></li>
<li><span class="tt">false</span>, <span class="tt">no</span>, <span class="tt">off</span></li>
</ul>
</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="ineffectual-actions"></a>
Ineffectual actions</h2>
<dl>
<dt><span class="tt">NoAction</span><a class="anchor" id="no-action"></a> </dt>
<dd><p class="startdd"><b>Default action</b>: <em>implicitly</em> do nothing. Does <em>not</em> override previous actions and is dropped.</p>
<p class="enddd">No parameters.  </p>
</dd>
<dt><span class="tt">VoidAction</span><a class="anchor" id="void-action"></a> </dt>
<dd><p class="startdd"><em>Explicitly</em> do nothing. <em>Does</em> override previous actions and is not dropped.</p>
<p class="interdd">No parameters.</p>
<dl class="section note"><dt>Note</dt><dd>This is a libxkbcommon <em>extension</em>. In order to maintain backward-compatibility, it serializes to <span class="tt">LockControls(controls=none,affect=neither)</span>.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.10.0  </dd></dl>
</dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="modifiers-actions"></a>
Modifiers actions</h2>
<p>There are 3 modifiers actions:</p>
<dl>
<dt><span class="tt">SetMods</span><a class="anchor" id="set-mods-action"></a> </dt>
<dd><p class="startdd">Modifies the <em><a class="el" href="#depressed-mod-def">depressed</a></em> modifiers.</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Aliases</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">modifiers</span></th><td><span class="tt">mods</span></td><td>Modifier mask</td><td><span class="tt">none</span> (0)</td><td>The list of modifiers to modify, separated by <span class="tt">+</span>, or the special value <span class="tt">modMapMods</span>. The latter means the parameter value has to be read from the <span class="tt">vmodmap</span> attribute of the key. </td></tr>
<tr>
<th><span class="tt">clearLocks</span></th><td></td><td>boolean</td><td><span class="tt">false</span></td><td>See its use <a class="el" href="#set-modifier-action-effects">hereinafter</a></td></tr>
<tr>
<th><span class="tt">unlockOnPress</span></th><td></td><td>boolean</td><td><span class="tt">false</span></td><td><p class="starttd">Control whether <a class="el" href="#locked-mod-def">locked</a> modifiers are unlocked on key press or release (default). See <a class="el" href="#set-modifier-action-effects">hereinafter</a> for further details.</p>
<dl class="section note"><dt>Note</dt><dd>Available since 1.11, only with <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>. </dd></dl>
</td></tr>
</table>
<p class="enddd"></p>
</dd>
<dt><span class="tt">LatchMods</span><a class="anchor" id="latch-mods-action"></a> </dt>
<dd><p class="startdd">Modifies the <em><a class="el" href="#latched-mod-def">latched</a></em> modifiers</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Aliases</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">modifiers</span></th><td><span class="tt">mods</span></td><td>Modifier mask</td><td><span class="tt">none</span> (0)</td><td>see <a class="el" href="#set-mods-action"><span class="tt">SetMods</span></a>.</td></tr>
<tr>
<th><span class="tt">clearLocks</span></th><td></td><td>boolean</td><td><span class="tt">false</span></td><td>See its use <a class="el" href="#latch-modifier-action-effects">hereinafter</a></td></tr>
<tr>
<th><span class="tt">latchToLock</span></th><td></td><td>boolean</td><td><span class="tt">false</span></td><td>See its use <a class="el" href="#latch-modifier-action-effects">hereinafter</a></td></tr>
<tr>
<th><span class="tt">latchOnPress</span></th><td></td><td>boolean</td><td><span class="tt">false</span></td><td><p class="starttd">Control whether <a class="el" href="#latched-mod-def">latched</a> modifiers are latched on key press or release (default). See <a class="el" href="#latch-modifier-action-effects">hereinafter</a> for further details.</p>
<dl class="section note"><dt>Note</dt><dd>Available since 1.11, only with <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>. </dd></dl>
</td></tr>
<tr>
<th><span class="tt">unlockOnPress</span></th><td></td><td>boolean</td><td><span class="tt">false</span></td><td><p class="starttd">Control whether <a class="el" href="#locked-mod-def">locked</a> modifiers are unlocked on key press or release (default). See <a class="el" href="#latch-modifier-action-effects">hereinafter</a> for further details.</p>
<dl class="section note"><dt>Note</dt><dd>It is <em>implied</em> if both <span class="tt">latchOnPress=true</span> and <span class="tt">clearLocks=true</span>.</dd>
<dd>
Available since 1.11, only with <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>. </dd></dl>
</td></tr>
</table>
<p class="interdd"></p>
<p class="enddd"></p>
</dd>
<dt><span class="tt">LockMods</span><a class="anchor" id="lock-mods-action"></a> </dt>
<dd><p class="startdd">Modifies the <em><a class="el" href="#locked-mod-def">locked</a></em> modifiers.</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Aliases</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">modifiers</span></th><td><span class="tt">mods</span></td><td>Modifier mask</td><td><span class="tt">none</span> (0)</td><td>see <a class="el" href="#set-mods-action"><span class="tt">SetMods</span></a></td></tr>
<tr>
<th><span class="tt">affect</span></th><td></td><td>enumeration:<ul>
<li><span class="tt">lock</span></li>
<li><span class="tt">unlock</span></li>
<li><span class="tt">both</span></li>
<li><span class="tt">neither</span> </li>
</ul>
</td><td><span class="tt">both</span></td><td><ul>
<li><span class="tt">lock</span>: the action only locks the modifier, but cannot unlock it.</li>
<li><span class="tt">unlock</span>: the action only unlocks modifier, but cannot lock it.</li>
<li><span class="tt">both</span>: the first key press locks the modifier and the second key press releases the modifier..</li>
<li><span class="tt">neither</span>: do not lock nor unlock, i.e. do nothing. </li>
</ul>
</td></tr>
<tr>
<th><span class="tt">unlockOnPress</span></th><td></td><td>boolean</td><td><span class="tt">false</span></td><td><p class="starttd">Control whether <a class="el" href="#locked-mod-def">locked</a> modifiers are unlocked on key press or release. See <a class="el" href="#lock-modifier-action-effects">hereinafter</a> for further details.</p>
<dl class="section note"><dt>Note</dt><dd>Available since 1.11, only with <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>. </dd></dl>
</td></tr>
</table>
<p class="interdd"></p>
<p class="enddd"></p>
</dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo</a></b></dt><dd>highlight that there is reference counting for the modifiers, e.g. to manage multiple physical keys for the same modifier.</dd></dl>
<p>These actions perform different tasks on key press and on key release:</p>
<table class="doxtable">
<caption>Effects of modifiers actions<a class="anchor" id="modifier-actions-effects"></a> </caption>
<tr>
<th>Action</th><th>On key press</th><th>On key release</th></tr>
<tr>
<th><span class="tt">SetMods</span><a class="anchor" id="latch-modifier-action-effects"></a></th><td><ul>
<li>If <span class="tt">clearLocks</span> and <span class="tt">unlockOnPress</span> are true, unlock the target modifiers.</li>
<li>Adds modifiers to <em><a class="el" href="#depressed-mod-def">depressed</a></em> modifiers that were not unlocked. </li>
</ul>
</td><td><ul>
<li>Removes modifiers added on press from <em><a class="el" href="#depressed-mod-def">depressed</a></em> modifiers, provided that no other key which affects the same modifiers is logically down.</li>
<li>If <span class="tt">clearLocks</span> is true, <span class="tt">unlockOnPress</span> is false and no other key were operated simultaneously with this key, then the modifiers will be removed as well from the <em><a class="el" href="#locked-mod-def">locked</a></em> modifiers. </li>
</ul>
</td></tr>
<tr>
<th><span class="tt">LatchMods</span><a class="anchor" id="set-modifier-action-effects"></a></th><td><ul>
<li>If <span class="tt">unLockOnPress</span> and <span class="tt">clearLocks</span> are true and target modifiers were locked, then unlocks them and clear the action.</li>
<li>Otherwise if <span class="tt">latchOnPress</span> is true, then adds modifiers to the <em><a class="el" href="#latched-mod-def">latched</a></em> modifiers.</li>
<li>Otherwise adds modifiers to <em><a class="el" href="#depressed-mod-def">depressed</a></em> modifiers. </li>
</ul>
</td><td><ul>
<li>If <span class="tt">latchOnPress</span> is false, then:<ul>
<li>Removes modifiers from <em><a class="el" href="#depressed-mod-def">depressed</a></em> modifiers.</li>
</ul>
</li>
<li>If no keys were operated simultaneously with the latching modifier key:<ul>
<li>If <span class="tt">clearLocks</span> is true and <span class="tt">unLockOnPress</span> is false and target modifiers were locked, then unlock then stop here and clear the action.</li>
<li>Otherwise add modifiers to <em><a class="el" href="#latched-mod-def">latched</a></em> modifiers.</li>
<li>If <span class="tt">latchToLock</span> is true and if the target modifiers are latched, then unlatch them and <em><a class="el" href="#locked-mod-def">lock</a></em> them.</li>
<li>Latch target modifiers that were not used by <span class="tt">clearLocks</span> and <span class="tt">latchToLock</span>.</li>
</ul>
</li>
<li>Otherwise unlatch the target modifiers and clear the action. </li>
</ul>
</td></tr>
<tr>
<th><span class="tt">LockMods</span><a class="anchor" id="lock-modifier-action-effects"></a></th><td><ul>
<li>If <span class="tt">unlockOnPress</span> is true and some of the target modifiers were <em><a class="el" href="#locked-mod-def">locked</a></em> before the key press, then unlock them if <span class="tt">noUnlock</span> false.</li>
<li>Otherwise:<ul>
<li>add target modifiers to <em><a class="el" href="#depressed-mod-def">depressed</a></em> modifiers;</li>
<li>if <span class="tt">noLock</span> is false, add target modifiers to the <em><a class="el" href="#locked-mod-def">locked</a></em> modifiers. </li>
</ul>
</li>
</ul>
</td><td><ul>
<li>If <span class="tt">unlockOnPress</span> is true and triggered unlocking on key press, do nothing.</li>
<li>Otherwise:<ul>
<li>remove modifiers from the <em><a class="el" href="#depressed-mod-def">depressed</a></em> modifiers, if no other key that affect the same modifiers is down;</li>
<li>if <span class="tt">noUnlock</span> is false and if any target modifiers was locked before the key press, <em><a class="el" href="#locked-mod-def">unlock</a></em> them. </li>
</ul>
</li>
</ul>
</td></tr>
</table>
<h2 class="doxsection"><a class="anchor" id="group-actions"></a>
Group actions</h2>
<p>There are 3 group actions:</p>
<dl>
<dt><span class="tt">SetGroup</span><a class="anchor" id="set-group-action"></a> </dt>
<dd><p class="startdd">Modifies the <em>base</em> group.</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">group</span></th><td>Group index:<ul>
<li>1-based numbering</li>
<li>either absolute (no sign) or relative (<span class="tt">+</span>/<span class="tt">-</span> sign) </li>
</ul>
</td><td>0</td><td>Target group or group delta</td></tr>
<tr>
<th><span class="tt">clearLocks</span></th><td>boolean</td><td><span class="tt">false</span></td><td>See its use <a class="el" href="#set-group-action-effects">hereinafter</a></td></tr>
</table>
<p class="interdd"></p>
<p class="enddd"></p>
</dd>
<dt><span class="tt">LatchGroup</span><a class="anchor" id="latch-group-action"></a> </dt>
<dd><p class="startdd">Modifies the <em>latched</em> group.</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">group</span></th><td>Group index (see <a class="el" href="#set-group-action"><span class="tt">SetGroup</span></a>)</td><td>0</td><td>Target group or group delta</td></tr>
<tr>
<th><span class="tt">clearLocks</span></th><td>boolean</td><td><span class="tt">false</span></td><td>See its use <a class="el" href="#latch-group-action-effects">hereinafter</a></td></tr>
<tr>
<th><span class="tt">latchToLock</span></th><td>boolean</td><td><span class="tt">false</span></td><td>See its use <a class="el" href="#latch-group-action-effects">hereinafter</a></td></tr>
</table>
<p class="interdd"></p>
<p class="enddd"></p>
</dd>
<dt><span class="tt">LockGroup</span><a class="anchor" id="lock-group-action"></a> </dt>
<dd><p class="startdd">Modifies the <em>locked</em> group.</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">group</span></th><td>Group index (see <a class="el" href="#set-group-action"><span class="tt">SetGroup</span></a>)</td><td>0</td><td>Target group or group delta</td></tr>
<tr>
<th><span class="tt">lockOnRelease</span></th><td>boolean</td><td>false</td><td><p class="starttd">Control whether to trigger the group change on key press (default) or release. See further details <a class="el" href="#lock-group-action-effects">hereinafter</a></p>
<dl class="section note"><dt>Note</dt><dd>Available since 1.11, only with <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>. </dd></dl>
</td></tr>
</table>
<p class="interdd"></p>
<p class="enddd"></p>
</dd>
</dl>
<table class="doxtable">
<caption>Effects of group actions</caption>
<tr>
<th>Action</th><th>On key press</th><th>On key release</th></tr>
<tr>
<th><span class="tt">SetGroup</span><a class="anchor" id="set-group-action-effects"></a></th><td><p class="starttd"></p>
<ul>
<li>If the <span class="tt">group</span> parameter is <em>absolute</em>, key press events sets the <em>base</em> keyboard group to <span class="tt">group</span>.</li>
<li>Otherwise, it adds <span class="tt">group</span> to the <em>base</em> keyboard group.</li>
</ul>
<p class="endtd">In either case, the resulting <em>effective</em> keyboard group is brought back into range depending on the value of the <span class="tt">GroupsWrap</span> control for the keyboard. </p>
</td><td>If <em>no</em> keys were operated simultaneously with this key and the <span class="tt">clearLocks</span> parameter is set, key release also sets the <em>locked</em> keyboard group to <span class="tt">Group1</span>. </td></tr>
<tr>
<th><span class="tt">LatchGroup</span><a class="anchor" id="latch-group-action-effects"></a></th><td>Same as <span class="tt">SetGroup</span>. </td><td><p class="starttd">Same as <span class="tt">SetGroup</span>.</p>
<p class="intertd">If no keys were operated simultaneously with the latching group key and the <span class="tt">clearLocks</span> parameter was not set or had no effect, key release has the following additional effects:</p>
<ul>
<li>If <span class="tt">latchToLock</span> parameter is set and the <em>latched</em> keyboard group is not the first group, the key release adds the <em>delta</em> applied by the corresponding key press to the locked keyboard group and subtracts it from the latched keyboard group. The <em>locked</em> and <em>effective</em> keyboard group are brought back into range according to the value of the global <span class="tt">GroupsWrap</span> control for the keyboard.</li>
<li>Otherwise, key release adds the key press <em>delta</em> to the latched keyboard group. </li>
</ul>
</td></tr>
<tr>
<th><span class="tt">LockGroup</span><a class="anchor" id="lock-group-action-effects"></a></th><td><p class="starttd"></p>
<ul>
<li>If <span class="tt">lockOnRelease</span> is set, then key press has no effect.</li>
<li><p class="startli">Otherwise:</p><ul>
<li>if the <span class="tt">group</span> is absolute, key press sets the <em>locked</em> keyboard group to <span class="tt">group</span>;</li>
<li>otherwise, key press adds <span class="tt">group</span> to the <em>locked</em> keyboard group.</li>
</ul>
<p class="startli">In either case, the resulting <em>locked</em> and <em>effective</em> group is brought back into range depending on the value of the <span class="tt">GroupsWrap</span> control for the keyboard. </p>
</li>
</ul>
</td><td><p class="starttd"></p>
<ul>
<li>If <span class="tt">lockOnRelease</span> is not set, then key release has no effect.</li>
<li><p class="startli">Otherwise, if any other key was <em>pressed</em> after the locking key, then key release has no effect.</p>
<details >
<summary >
This enables e.g. using <span class="tt">Alt+Shift</span> combination in any order.</summary>
<ul>
<li><span class="tt">Shift</span> down, <span class="tt">Alt</span> down, <span class="tt">Alt</span> up, <span class="tt">Shift</span> up</li>
<li><span class="tt">Shift</span> down, <span class="tt">Alt</span> down, <span class="tt">Shift</span> up, <span class="tt">Alt</span> up</li>
<li><span class="tt">Alt</span> down, <span class="tt">Shift</span> down, <span class="tt">Shift</span> up, <span class="tt">Alt</span> up</li>
<li><span class="tt">Alt</span> down, <span class="tt">Shift</span> down, <span class="tt">Alt</span> up, <span class="tt">Shift</span> up</li>
</ul>
<p>This would not be possible if locking was cancelled by key <em>release</em> too. </p>
</details>
</li>
<li>Otherwise, it has the same effect than a key press <em>without</em> <span class="tt">lockOnRelease</span> set. </li>
</ul>
</td></tr>
</table>
<h2 class="doxsection"><a class="anchor" id="legacy-x11-actions"></a>
Legacy X11 actions</h2>
<dl class="section attention"><dt>Attention</dt><dd>The following legacy actions are kept for compatibility only: they are parsed and validated but have no effect. This allows to use keymaps defined in <code><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a></code> for both X11 and Wayland.</dd></dl>
<h3 class="doxsection"><a class="anchor" id="pointer-actions"></a>
Pointer actions</h3>
<dl>
<dt><span class="tt">MovePointer</span></dt>
<dd></dd>
<dt></dt>
<dd></dd>
<dt><span class="tt">MovePtr</span> </dt>
<dd><p class="startdd">Move the mouse pointer</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo</a></b></dt><dd>MovePointer parameters </dd></dl>
<p class="interdd"></p>
<p class="enddd"></p>
</dd>
<dt><span class="tt">PointerButton</span> </dt>
<dd></dd>
<dt><span class="tt">PtrBtn</span> </dt>
<dd><p class="startdd">Simulate a mouse button press</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo</a></b></dt><dd>PointerButton parameters </dd></dl>
<p class="interdd"></p>
<p class="enddd"></p>
</dd>
<dt><span class="tt">LockPointerButton</span> </dt>
<dd></dd>
<dt><span class="tt">LockPointerBtn</span> </dt>
<dd></dd>
<dt><span class="tt">LockPtrButton</span> </dt>
<dd></dd>
<dt><span class="tt">LockPtrBtn</span> </dt>
<dd><p class="startdd">Simulate a mouse button press, locked until this actiion‚Äôs key is pressed again</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo</a></b></dt><dd>LockPointerButton parameters </dd></dl>
<p class="interdd"></p>
<p class="enddd"></p>
</dd>
<dt><span class="tt">SetPointerDefault</span> </dt>
<dd></dd>
<dt><span class="tt">SetPtrDflt</span> </dt>
<dd><p class="startdd">Set the default select button (???)</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo</a></b></dt><dd>SetPointerDefault parameters </dd></dl>
<p class="enddd"></p>
</dd>
<dd></dd>
</dl>
<h3 class="doxsection"><a class="anchor" id="control-flags-actions"></a>
Control flags actions</h3>
<dl>
<dt><span class="tt">SetControls</span><a class="anchor" id="set-controls-action"></a> </dt>
<dd><p class="startdd"></p>
<p class="interdd">Set the standard XKB controls</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Alias</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">controls</span></th><td><span class="tt">ctrls</span></td><td><p class="starttd">Mask of the following enumeration:</p>
<ul>
<li><span class="tt">RepeatKeys</span></li>
<li><span class="tt">Repeat</span></li>
<li><span class="tt">AutoRepeat</span></li>
<li><span class="tt">SlowKeys</span></li>
<li><span class="tt">BounceKeys</span></li>
<li><span class="tt">StickyKeys</span></li>
<li><span class="tt">MouseKeys</span></li>
<li><span class="tt">MouseKeysAccel</span></li>
<li><span class="tt">AccessXKeys</span></li>
<li><span class="tt">AccessXTimeout</span></li>
<li><span class="tt">AccessXFeedback</span></li>
<li><span class="tt">AudibleBell</span></li>
<li><span class="tt">IgnoreGroupLock</span></li>
<li><span class="tt">Overlay1</span></li>
<li><span class="tt">Overlay2</span></li>
</ul>
<p class="endtd">Plus 2 special values:</p><ul>
<li><span class="tt">all</span></li>
<li><span class="tt">none</span> </li>
</ul>
</td><td>0</td><td>Standard XKB controls</td></tr>
</table>
<p class="enddd"></p>
</dd>
<dt><span class="tt">LockControls</span><a class="anchor" id="lock-controls-action"></a> </dt>
<dd><p class="startdd">Lock the standard XKB controls</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Alias</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">controls</span></th><td><span class="tt">ctrls</span></td><td>Mask (see <a class="el" href="#set-controls-action"><span class="tt">SetControls</span></a>)</td><td>0</td><td>Standard XKB controls</td></tr>
<tr>
<th><span class="tt">affect</span></th><td></td><td>enumeration:<ul>
<li><span class="tt">lock</span></li>
<li><span class="tt">unlock</span></li>
<li><span class="tt">both</span></li>
<li><span class="tt">neither</span> </li>
</ul>
</td><td><span class="tt">both</span></td><td><span class="todo">TODO</span></td></tr>
</table>
<p class="enddd"></p>
</dd>
</dl>
<h3 class="doxsection"><a class="anchor" id="server-actions"></a>
Server actions</h3>
<dl>
<dt><span class="tt">TerminateServer</span><a class="anchor" id="terminate-server-action"></a> </dt>
<dd><p class="startdd">Shut down the X server</p>
<p class="enddd">No parameters.  </p>
</dd>
<dt><span class="tt">SwitchScreen</span> </dt>
<dd><p class="startdd"></p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo</a></b></dt><dd>SwitchScreen </dd></dl>
<p class="enddd"></p>
</dd>
</dl>
<h3 class="doxsection"><a class="anchor" id="private-action"></a>
Private action</h3>
<p>Raw encoding of an action. Aimed to support arbitrary action unknown to the XKB compiler.</p>
<dl class="section warning"><dt>Warning</dt><dd>This assumes that the corresponding action‚Äôs C <span class="tt">struct</span> is laid out in memory exactly as described in the XKB specification and libraries. However, libxkbcommon have changed these <span class="tt">struct</span>s in various ways, so this assumption is no longer true and the actions defined in the XKB protocol are unsupported.</dd></dl>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">type</span></th><td>integer</td><td>0</td><td>Action type, as encoded in the XKB protocol </td></tr>
<tr>
<th><span class="tt">data</span></th><td>byte array or a string of <em>exactly 7 bytes</em></td><td>"0000000"</td><td>Raw byte encoding of the action following the XKB protocol</td></tr>
</table>
<p>Examples:</p><ul>
<li><span class="tt">Private(type=123, data="abcdefg");</span></li>
<li><span class="tt">Private(type=123, data[1]=0, data[2]=100, data[3]=12);</span></li>
</ul>
<h2 class="doxsection"><a class="anchor" id="unsupported-legacy-x11-actions"></a>
Unsupported legacy X11 actions</h2>
<dl class="section attention"><dt>Attention</dt><dd>The following legacy actions are <b>unsupported</b>: they are parsed and but <em>not validated</em> and are then completely <em>ignored</em>.</dd></dl>
<h3 class="doxsection"><a class="anchor" id="redirect-key-action"></a>
Redirect key</h3>
<p><span class="tt">RedirectKey</span> emulates pressing a key with a different key code.</p>
<p><span class="tt">RedirectKey</span> normally redirects to another key on the <em>same device</em> as the key or button which caused the event, else on the <em>core</em> keyboard device.</p>
<table class="doxtable">
<caption>Parameters</caption>
<tr>
<th>Name</th><th>Aliases</th><th>Data type</th><th>Default value</th><th>Description</th></tr>
<tr>
<th><span class="tt">key</span></th><td><span class="tt">keycode</span>, <span class="tt">kc</span></td><td>keycode</td><td>0</td><td>Target keycode to emulate</td></tr>
<tr>
<th><span class="tt">clearmodifiers</span></th><td><span class="tt">clearmods</span></td><td>modifier mask</td><td><span class="tt">none</span> (0)</td><td>Modifiers to clear</td></tr>
<tr>
<th><span class="tt">modifiers</span></th><td><span class="tt">mods</span></td><td>modifier mask</td><td><span class="tt">none</span> (0)</td><td>Modifiers to add</td></tr>
</table>
<table class="doxtable">
<caption>Effects</caption>
<tr>
<th>On key <em>press</em></th><th>On key <em>release</em></th></tr>
<tr>
<td><p class="starttd"></p>
<p class="endtd">Key press causes a key press event for the key specified by the <span class="tt">key</span> parameter instead of for the actual key. The state reported in this event reports of the current <em>effective</em> modifiers changed as follow:</p><ul>
<li>Modifiers in the <span class="tt">clearmodifiers</span> parameter are cleared.</li>
<li>Modifiers in the <span class="tt">modifiers</span> parameter are set. </li>
</ul>
</td><td><p class="starttd"></p>
<p class="endtd">Key release causes a key release event for the key specified by the <span class="tt">key</span> parameter; the state field for this event consists of the <em>effective</em> modifiers at the time of the release, changed as described on the key press. </p>
</td></tr>
</table>
<h3 class="doxsection"><a class="anchor" id="iso-lock"></a>
ISO lock</h3>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo</a></b></dt><dd><span class="tt">ISOLock</span></dd></dl>
<h3 class="doxsection"><a class="anchor" id="device-actions"></a>
Device actions</h3>
<dl>
<dt><span class="tt">DeviceButton</span> </dt>
<dd><p class="startdd"></p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo</a></b></dt><dd>DeviceButton </dd></dl>
<p class="enddd"></p>
</dd>
<dt><span class="tt">LockDeviceButton</span> </dt>
<dd><p class="startdd"></p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000017">Todo</a></b></dt><dd>LockDeviceButton </dd></dl>
<p class="enddd"></p>
</dd>
<dt><span class="tt">DeviceValuator</span> </dt>
<dd><p class="startdd"></p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000018">Todo</a></b></dt><dd>DeviceValuator </dd></dl>
<p class="enddd"></p>
</dd>
</dl>
<h3 class="doxsection"><a class="anchor" id="message"></a>
Message</h3>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000019">Todo</a></b></dt><dd><span class="tt">ActionMessage</span></dd></dl>
<h1 class="doxsection"><a class="anchor" id="the-xkb_geometry-section"></a>
The ‚Äúxkb_geometry‚Äù section</h1>
<p>This section aims to describe the <em>physical</em> layout of a keyboard and its main use case is to produce a picture of the keyboard via e.g. the <span class="tt">xkbprint</span> program.</p>
<dl class="section warning"><dt>Warning</dt><dd>libxkbcommon does not support this section: while it can parse the syntax, it does not interpret it; the section is simply dropped so there is no API to query it and the keymap serialization does not contain it.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="xkbcommon-compatibility.html#geometry-support">Compatibility with X11</a>. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
