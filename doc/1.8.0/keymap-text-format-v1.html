<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libxkbcommon: The XKB keymap text format, V1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libxkbcommon<span id="projectnumber">&#160;1.8.0</span>
   </div>
   <div id="projectbrief">Library implementing the XKB specification for parsing                           keyboard descriptions and handling keyboard state</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">The XKB keymap text format, V1</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#terminology">Terminology</a>
  </li>
  <li class="level1">
    <a href="#introduction-to-the-xkb-text-format">Introduction to the XKB text format</a>
    <ul>
      <li class="level2">
        <a href="#xkb-file">XKB file</a>
      </li>
      <li class="level2">
        <a href="#keymap-components-intro">Keymap components</a>
      </li>
      <li class="level2">
        <a href="#comments">Comments</a>
      </li>
      <li class="level2">
        <a href="#literals">Literals</a>
      </li>
      <li class="level2">
        <a href="#keywords">Keywords</a>
      </li>
      <li class="level2">
        <a href="#built-in-settings">Built-in settings</a>
      </li>
      <li class="level2">
        <a href="#xkb-include">The include mechanism</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_keymap-block">The “xkb_keymap” block</a>
  </li>
  <li class="level1">
    <a href="#the-xkb_keycodes-section">The “xkb_keycodes” section</a>
    <ul>
      <li class="level2">
        <a href="#keycode-statements">Keycode statements</a>
      </li>
      <li class="level2">
        <a href="#alias-statements">Alias statements</a>
      </li>
      <li class="level2">
        <a href="#indicator-name">LED name statements</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_types-section">The “xkb_types” section</a>
    <ul>
      <li class="level2">
        <a href="#how-key-types-work">How key types work</a>
      </li>
      <li class="level2">
        <a href="#type-definitions">Type definitions</a>
      </li>
      <li class="level2">
        <a href="#key-type-examples">Key types examples</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_compat-section">The “xkb_compat” section</a>
    <ul>
      <li class="level2">
        <a href="#interpret-statements">Interpret statements</a>
      </li>
      <li class="level2">
        <a href="#indicator-effect">LED map statements</a>
      </li>
      <li class="level2">
        <a href="#default-values">Default values</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#the-xkb_symbols-section">The “xkb_symbols” section</a>
    <ul>
      <li class="level2">
        <a href="#name-statements">Name statements</a>
      </li>
      <li class="level2">
        <a href="#include-statements">Include statements</a>
      </li>
      <li class="level2">
        <a href="#key-statement">Key statement</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#virtual-modifier-statements">Virtual modifier statements</a>
  </li>
  <li class="level1">
    <a href="#modifiers-bindings">Modifiers bindings</a>
    <ul>
      <li class="level2">
        <a href="#real-and-virtual-modifiers">Real and virtual modifiers</a>
      </li>
      <li class="level2">
        <a href="#define-and-use-a-modifier">Define and use a modifier</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#key-actions">Key actions</a>
    <ul>
      <li class="level2">
        <a href="#modifiers-actions">Modifiers actions</a>
      </li>
      <li class="level2">
        <a href="#group-actions">Group actions</a>
      </li>
      <li class="level2">
        <a href="#legacy-actions">Unsupported legacy actions</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_2keymap-format-text-v1"></a></p>
<p>This document describes the <code>XKB_KEYMAP_FORMAT_TEXT_V1</code> <a class="el" href="#keymap-def">keymap</a> format, as implemented by libxkbcommon.</p>
<dl class="section see"><dt>See also</dt><dd>For an overview of the role of this format, please see “<a class="el" href="xkb-intro.html#xkb-the-config">XKB the keyboard keymap configuration</a>”.</dd>
<dd>
For examples of keymaps in this format, please see “<a class="el" href="user-configuration.html">User-configuration</a>”. For further examples see <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a>, the standard database of keyboard configuration data.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Due to the complexity of the format, this document is still is construction. Some additional resources are:</dd>
<dd>
<ul>
<li><a href="https://web.archive.org/web/20190724015820/http://pascal.tsu.ru/en/xkb/">Ivan Pascal’s XKB documentation</a></li>
<li><a href="https://www.charvolant.org/doug/xkb/html/index.html">An Unreliable Guide to XKB Configuration</a></li>
<li><a href="https://www.x.org/releases/current/doc/kbproto/xkbproto.html">The X Keyboard Extension: Protocol Specification</a></li>
<li><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/master/docs/README.enhancing">How to enhance XKB configuration</a></li>
<li><a href="https://wiki.archlinux.org/index.php/X_keyboard_extension">ArchWiki XKB page</a></li>
</ul>
</dd></dl>
<h1><a class="anchor" id="terminology"></a>
Terminology</h1>
<dl>
<dt><a class="anchor" id="keycode-def"></a>Keycode</dt>
<dd></dd>
<dt></dt>
<dd><p class="startdd">Code that identifies a physical key on a keyboard.</p>
<ul>
<li><em>Raw</em> keycodes are the numeric identifiers used as input in XKB. They are the result of the low-level processing of the data that keyboards send to a computer. For instance <code>36</code> may represent the return key.</li>
<li><em>XKB</em> keycodes are <em>symbolic</em> names assigned to raw keycodes in order to facilitate their mapping to symbols. For instance the keycode for the return key is the abbreviation <code>RTRN</code>.</li>
</ul>
<p class="enddd">See <a class="el" href="#the-xkb_keycodes-section">xkb_keycodes</a> for further details.  </p>
</dd>
<dt><a class="anchor" id="keysym-def"></a>Symbols </dt>
<dd><p class="startdd">A <em>keysym</em> (short for “key symbol”) is a numeric encoding of a symbol on the cap of a key.</p>
<p class="interdd">They have a canonical name for convenience. It can be:</p>
<ul>
<li>A <em>character:</em> e.g. <code>a</code> and <code>A</code> for Latin scripts, <code>alpha</code> “α” and <code>ALPHA</code> “Α” for Greek, etc.</li>
<li><p class="startli">A <em>dead key:</em> e.g. <code>dead_grave</code> and <code>dead_diaeresis</code>, corresponding respectively to the <a href="https://en.wikipedia.org/wiki/Grave_accent">grave accent</a> and the <a href="https://en.wikipedia.org/wiki/Diaeresis_%28diacritic%29">diaeresis</a> diacritics.</p>
<p class="startli">A <a href="https://en.wikipedia.org/wiki/Dead_key">dead key</a> is a special kind of key that does not generate a character by itself, but modifies the character generated by the key struck(s) immediately after.</p>
</li>
<li>A <em><a class="el" href="#modifier-def">modifier</a>⁠:</em> e.g. <code>Shift_L</code>, <code>Control_R</code>, <code>Caps_Lock</code>. See hereinafter.</li>
<li>A <em>system action:</em> e.g. the arrow <code>Left</code>, <code>Pause</code>, <code>Escape</code>, <code>F1</code>.</li>
</ul>
<p class="interdd">The complete list of keysyms is defined in <code><a class="el" href="xkbcommon-keysyms_8h.html" title="Key symbols (keysyms) definitions.">xkbcommon/xkbcommon-keysyms.h</a></code>.</p>
<p class="enddd">See <a class="el" href="#the-xkb_symbols-section">xkb_symbols</a> for further details on binding keysyms to keycodes.  </p>
</dd>
<dt><a class="anchor" id="modifier-def"></a>Modifier </dt>
<dd><p class="startdd">A <em>modifier key</em> is a key that modifies the effect of other keys: e.g. Shift, Control, Caps Lock, etc.</p>
<p class="interdd">The state of a modifier key (active/inactive) is encoded as a <em>modifier index</em> (or modifier bit or simply modifier) and has an associated <em>unique name</em>.</p>
<p class="interdd">For historical reasons, modifiers are divided in two categories:</p>
<dl>
<dt><a class="anchor" id="real-modifier-def"></a>Real modifiers </dt>
<dd><p class="startdd">They are the 8 <em>predefined</em> (AKA core, X11) modifiers (see <a class="el" href="#usual-modifiers">usual modifiers</a> hereinafter).</p>
<p class="interdd">Real modifiers ensure backward compatibility: indeed they are the actual bits used to compute the <a class="el" href="#level-def">levels</a> and are communicated via the API of xkbcommon.</p>
<p class="enddd">Some are generic modifiers (<code>Mod[1-5]</code>) that do not have a conventional interpretation and are the motivation of the introduction of <a class="el" href="#virtual-modifier-def">virtual modifiers</a>.  </p>
</dd>
<dt><a class="anchor" id="virtual-modifier-def"></a>Virtual modifiers </dt>
<dd>They are the modifiers that are <em>not</em> predefined.  </dd>
</dl>
<p class="interdd">Each modifier defines a <em>mapping</em> to one or multiple <em>real</em> modifier. Real modifiers map to themselves.</p>
<p class="interdd">The following table lists the <a class="anchor" id="usual-modifiers"></a>usual modifiers present in the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">standard keyboard configuration</a>. Note that this is provided for information only, as it may change depending on the user configuration.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Modifier   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Usual mapping   </th><th class="markdownTableHeadNone">Comment    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Control_key">Shift</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Caps_Lock">Caps Lock</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Control</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>Control</code>   </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Control_key">Control</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Mod1</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>Mod1</code>   </td><td class="markdownTableBodyNone">Not conventional    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Mod2</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>Mod2</code>   </td><td class="markdownTableBodyNone">Not conventional    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Mod3</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>Mod3</code>   </td><td class="markdownTableBodyNone">Not conventional    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Mod4</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>Mod4</code>   </td><td class="markdownTableBodyNone">Not conventional    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Mod5</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>Mod5</code>   </td><td class="markdownTableBodyNone">Not conventional    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Alt</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>Mod1</code>   </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Alt_key">Alt</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Meta</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>Mod1</code> or <code>Mod4</code>   </td><td class="markdownTableBodyNone">The legacy <a href="https://en.wikipedia.org/wiki/Meta_key">Meta</a> key    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>NumLock</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>Mod2</code>   </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Num_Lock">NumLock</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Super</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>Mod4</code>   </td><td class="markdownTableBodyNone">The usual <a href="https://en.wikipedia.org/wiki/Super_key_(keyboard_button)">Super</a>/GUI    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>Mod3</code>   </td><td class="markdownTableBodyNone"><a href="https://en.wikipedia.org/wiki/ISO/IEC_9995">ISO</a> level 3, aka <a href="https://en.wikipedia.org/wiki/AltGr_key">AltGr</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelFive</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>Mod5</code>   </td><td class="markdownTableBodyNone"><a href="https://en.wikipedia.org/wiki/ISO/IEC_9995">ISO</a> level 5   </td></tr>
</table>
<p class="interdd">A modifier key can report its state in one of the following 3 ways:</p>
<dl>
<dt><a class="anchor" id="depressed-mod-def"></a>Depressed </dt>
<dd>Active while depressed; e.g. the usual Shift. </dd>
<dt><a class="anchor" id="latched-mod-def"></a>Latched </dt>
<dd>Activated when pressed and deactivated after the next non-modifier key press.  </dd>
<dt><a class="anchor" id="locked-mod-def"></a>Locked </dt>
<dd>Activated when pressed and deactivated when pressed again; e.g. the usual Caps Lock.  </dd>
</dl>
<p class="interdd">See <a class="el" href="#modifiers-bindings">modifiers bindings</a> for further details. </p>
<p class="enddd"></p>
</dd>
<dt><a class="anchor" id="level-def"></a>Shift Level </dt>
<dd><p class="startdd">A key may produce different results depending of the active modifiers: e.g. for a Latin script, pressing the key A produces “a” and holding Shift while pressing A produces “A”.</p>
<p class="interdd">This various results are organized in an ordered list; the <em>index</em> of each entry is called a <a class="anchor" id="level-index-def"></a>shift level or simply level. By convention the lowest level is the result when no modifier is active. Example for the key <code>A</code> on a latin script keyboard:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Level   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Keysym   </th><th class="markdownTableHeadNone">Active key modifiers    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Lower case letters   </td><td class="markdownTableBodyNone"><code>a</code>   </td><td class="markdownTableBodyNone">None    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">Upper case letters.   </td><td class="markdownTableBodyNone"><code>A</code>   </td><td class="markdownTableBodyNone"><code>Shift</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">Alternative lower case letters   </td><td class="markdownTableBodyNone"><code>ae</code>   </td><td class="markdownTableBodyNone"><code>AltGr</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">Alternative upper case letters   </td><td class="markdownTableBodyNone"><code>AE</code>   </td><td class="markdownTableBodyNone"><code>Shift</code> + <code>AltGr</code>   </td></tr>
</table>
<p class="interdd">A key shift level is the logical <em>state</em> of a key corresponding to the current shift level it used.</p>
<p class="interdd">Key shift levels are derived from the modifiers states, but not necessarily in the same way for all keys. For example, for Latin script the Caps Lock modifier selects the level 2 for alphabetic keys such as <code>A</code> but has no effect on a numeric key.</p>
<p class="enddd">There are groups of keys with the same characteristics: letters, punctuation, numeric keypad, etc. The meaning of their levels is identical and thus can be shared: this generalization is called a <em>key type</em> (see hereinafter).  </p>
</dd>
<dt><a class="anchor" id="key-type-def"></a>Key type </dt>
<dd><p class="startdd">A key type defines the levels available for a key and how to derive the active level from the modifiers states. Examples:</p><ul>
<li><code>ONE_LEVEL</code>: the key has only one level, i.e. it is not affected by any modifiers. Example: the modifiers themselves.</li>
<li><a class="el" href="#TWO_LEVEL"><code>TWO_LEVEL</code></a>: the key has two levels:<ul>
<li>Level 1: default level, active when the <code>Shift</code> modifier is <em>not</em> active.</li>
<li>Level 2: level activated with the <code>Shift</code> modifier.</li>
</ul>
</li>
<li><a class="el" href="#FOUR_LEVEL"><code>FOUR_LEVEL</code></a>: see the example in the previous section.</li>
</ul>
<p class="enddd">See <a class="el" href="#the-xkb_types-section">xkb_types</a> for further details.  </p>
</dd>
<dt><a class="anchor" id="layout-def"></a>Layout </dt>
<dd><p class="startdd">A mapping of keycodes to symbols, actions and key types.</p>
<p class="interdd">A user who deals with multiple languages may need two or more different layouts: e.g. a layout for Arabic and another one for English. In this context, layouts are called <em>groups</em> in XKB, as defined in the <a href="https://en.wikipedia.org/wiki/ISO/IEC_9995">standard ISO/IEC&#160;9995</a>.</p>
<p class="interdd">Layouts are ordered and identified by their index. Example:</p>
<ul>
<li>Layout 1: Arabic</li>
<li>Layout 2: English</li>
</ul>
<p class="enddd"></p>
</dd>
<dt><a class="anchor" id="key-action-def"></a>Key Action </dt>
<dd><p class="startdd">In XKB world, a key action defines the effect a key has on the state of the keyboard or the state of the display server. Examples:</p>
<ul>
<li>Change the state of a modifier.</li>
<li>Change the active group.</li>
<li>Move the mouse pointer.</li>
</ul>
<p class="enddd">See the section “<a class="el" href="#key-actions">Key actions</a>” for further details.  </p>
</dd>
<dt><a class="anchor" id="indicator-def"></a>Indicator </dt>
<dd><p class="startdd">A keyboard indicator is a mean to report a specific aspect of the keyboard state.</p>
<dl>
<dt><em>Physical</em> indicator </dt>
<dd>Typically a labelled LED on the keyboard, e.g. “Caps Lock” and “Num Lock”.  </dd>
<dt><em>Logical</em> indicator </dt>
<dd><p class="startdd">A customizable derived state of the keyboard. Its changes creates events that can be monitored.</p>
<p class="interdd">There are two categories:</p>
<ul>
<li><p class="startli"><em>Real</em> indicators are those associated to a physical indicator. For example, the “Caps Lock” logical modifier controls the corresponding physical LED.</p>
<p class="startli">Because indicators are customizable, if one misses a “Num Lock” LED, one could define instead the “Caps Lock” <em>indicator</em> to activate its LED when the “Num Lock” <em>modifier</em> is active.</p>
</li>
<li><em>Virtual</em> indicators are not associated to a physical indicator. Their effect is only visible for programs monitoring them.</li>
</ul>
<p class="enddd">Note that the meanings of <em>real</em> and <em>virtual</em> is slightly different than the one used for <a class="el" href="#modifier-def">modifier</a>.  </p>
</dd>
</dl>
<p class="enddd">See: <code><a class="el" href="#indicator-name">xkb_keycodes</a></code> to define indicators and <code><a class="el" href="#indicator-effect">xkb_compat</a></code> to define their effects.  </p>
</dd>
<dt><a class="anchor" id="keymap-def"></a>Keymap </dt>
<dd><p class="startdd">The <em>complete</em> definition of the mapping of raw keycodes to symbols and actions. It fully defines the behavior of a keyboard.</p>
<p class="interdd">Depending of the context, a keymap may refer to:</p>
<ul>
<li>the software object defined and managed by libxkbcommon;</li>
<li>the text configuration used to create this software object.</li>
</ul>
<p class="enddd">See <a class="el" href="#keymap-components-intro">Keymap components</a> and <a class="el" href="#the-xkb_keymap-block">xkb_keymap</a> for further details.  </p>
</dd>
<dt>Keyboard configuration database<a class="anchor" id="database-def"></a> </dt>
<dd>A database that provides the <a class="el" href="#keymap-components-intro">keymap components</a>. *nix OSs uses the <em>standard</em> database <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a>. One may extend this database with <em>custom</em> layouts: see “<a class="el" href="user-configuration.html">User-configuration</a>” for further details.  </dd>
</dl>
<h1><a class="anchor" id="introduction-to-the-xkb-text-format"></a>
Introduction to the XKB text format</h1>
<p>The XKB text format uses a syntax similar to the <a href="https://en.wikipedia.org/wiki/C_(programming_language)#Syntax">C programming language</a>. Note that the similarity with C stops here: the XKB text format is only a <em>configuration</em> format and is not intended for programming.</p>
<p>The XKB text format is used to configure a <em>keyboard keymap</em>, which is introduced in “<a class="el" href="xkb-intro.html#xkb-the-config">XKB the keyboard keymap configuration</a>”. It has the following two main use cases, illustrated in the <a class="el" href="#xkb-keymap-components-diagram">diagram hereinafter</a>:</p>
<ul>
<li><p class="startli"><b>Server:</b> Load a keymap from the keymap configuration database, then handle input events by updating the keyboard state. The keymap is assembled from an <a class="el" href="xkb-intro.html#RMLVO-intro">RMLVO configuration</a> and its corresponding <b><a class="el" href="xkb-intro.html#KcCGST-intro">KcCGST components</a></b> files.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keymap.html#ga502717aa7148fd17d4970896f1e9e06f" title="Create a keymap from RMLVO names.">xkb_keymap::xkb_keymap_new_from_names</a></dd>
<dd>
<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> for the implementation of the <em>standard</em> <a class="el" href="group__keymap.html" title="Creating and destroying keymaps.">Keymap Creation</a> configuration database.</dd>
<dd>
“<a class="el" href="user-configuration.html">User-configuration</a>” to add a <em>custom</em> layout or option.</dd></dl>
</li>
<li><p class="startli"><b>Client:</b> Load the active keymap from the server, then handle update events sent by the server. The <b><a class="el" href="xkb-intro.html#keymap-intro">complete keymap</a></b> is directly available in a <em>self-contained</em> file.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keymap.html#ga9d98e2e1348bd756bd3229d0b9432886" title="Create a keymap from a keymap string.">xkb_keymap::xkb_keymap_new_from_string</a></dd></dl>
<p><a class="anchor" id="xkb-keymap-components-diagram"></a></p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_xkb-keymap-components.svg" width="687" height="303"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
XKB text format use cases</div>
</div>
</li>
</ul>
<h2><a class="anchor" id="xkb-file"></a>
XKB file</h2>
<p>There are two kinds of files for the XKB text format:</p>
<dl>
<dt>Keymap file<a class="anchor" id="keymap-file-def"></a> </dt>
<dd><p class="startdd">A file with the <em>complete</em> description of the <a class="el" href="#keymap-def">keymap</a> object. It is the kind of file that the server sends to the client (see the <a class="el" href="#xkb-keymap-components-diagram">diagram</a> above). Its top-level structure consists of the <a class="el" href="#the-xkb_keymap-block">xkb_keymap</a> block. </p>
<p class="enddd"></p>
</dd>
<dt>Keymap <em>component</em> file<a class="anchor" id="keymap-component-file-def"></a> </dt>
<dd>A file with the description of a <em>particular</em> <a class="el" href="xkb-intro.html#KcCGST-intro">KcCGST component</a>. It is the kind of file that the server uses to assemble a <a class="el" href="#keymap-file-def">keymap file</a>. Its top-level structure consists of a <em>single type</em> of <a class="el" href="#keymap-section-def">keymap sections</a>. A component file may contain multiple such sections.  </dd>
</dl>
<h2><a class="anchor" id="keymap-components-intro"></a>
Keymap components</h2>
<p><a class="el" href="#keymap-component-def">Keymap components</a> are described with <a class="el" href="#keymap-section-def">keymap sections</a>. They are grouped in <a class="el" href="#keymap-component-file-def">keymap component files</a> to form a <a class="el" href="#database-def">keyboard configuration database</a>.</p>
<dl>
<dt>Keymap <em>component</em><a class="anchor" id="keymap-component-def"></a> </dt>
<dd>A part of the keymap <em>object</em>. The set of keymap components is referred as <a class="el" href="xkb-intro.html#KcCGST-intro">KcCGST</a>. They are presented in the <a class="el" href="#keymap-components-table">table hereinafter</a>.  </dd>
<dt>Keymap <em>section</em><a class="anchor" id="keymap-section-def"></a> </dt>
<dd>A part of the keymap <em>text configuration</em> dedicated to one of the <a class="el" href="#keymap-components-table">keymap components</a>.  </dd>
<dt>Component <em>folder</em> </dt>
<dd>A folder in the <a class="el" href="#database-def">keymap configuration database</a>, dedicated to files with partial definitions of the same keymap section.  </dd>
</dl>
<p><a class="anchor" id="keymap-components-table"></a></p><table class="doxtable">
<caption>Keymap components </caption>
<tr>
<th><a class="el" href="#keymap-component-def">Component</a> </th><th><a class="el" href="#keymap-section-def">Section</a> in a <a class="el" href="#the-xkb_keymap-block">keymap</a> </th><th>Folder in a keymap configuration database </th><th>Description  </th></tr>
<tr>
<th><u>K</u>ey <u>c</u>odes </th><td><a class="el" href="#the-xkb_keycodes-section">xkb_keycodes</a> </td><td><code>keycodes</code> </td><td>A translation of the raw <a class="el" href="#keycode-def">key codes</a> from the keyboard into symbolic names.   </td></tr>
<tr>
<th><u>C</u>ompatibility </th><td><a class="el" href="#the-xkb_compat-section">xkb_compat</a> </td><td><code>compat</code> </td><td>A specification of what internal actions modifiers and various special-purpose keys produce.   </td></tr>
<tr>
<th>(<u>G</u>eometry) </th><td>xkb_geometry </td><td><code>geometry</code> </td><td><p class="starttd">A description of the physical layout of a keyboard.</p>
<dl class="section attention"><dt>Attention</dt><dd>This legacy feature is <a class="el" href="xkbcommon-compatibility.html#geometry-support">not supported</a> by <em>xkbcommon</em>.</dd></dl>
</td></tr>
<tr>
<th>Key <u>s</u>ymbols </th><td><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a> </td><td><code>symbols</code> </td><td>A translation of symbolic <a class="el" href="#keycode-def">key codes</a> into actual <a class="el" href="#keysym-def">key symbols</a> (keysyms).   </td></tr>
<tr>
<th>Key <u>t</u>ypes </th><td><a class="el" href="#the-xkb_types-section">xkb_types</a> </td><td><code>types</code> </td><td>Types describe how a pressed key is affected by active <a class="el" href="#modifier-def">modifiers</a> such as Shift, Control, Alt, etc.   </td></tr>
</table>
<h2><a class="anchor" id="comments"></a>
Comments</h2>
<p>Comments are introduced following either <code>//</code> or <code>#</code> until the end of the line.</p>
<h2><a class="anchor" id="literals"></a>
Literals</h2>
<dl>
<dt>String literal </dt>
<dd><p class="startdd">A string is surrounded by double quotes: “<code>&quot;</code>”. The following <em>escape sequences</em> are supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Escape sequence   </th><th class="markdownTableHeadNone">Meaning    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>\\</code>   </td><td class="markdownTableBodyNone">Backslash “<code>\</code>”    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>\b</code>   </td><td class="markdownTableBodyNone">Backspace    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>\e</code>   </td><td class="markdownTableBodyNone">Escape    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>\f</code>   </td><td class="markdownTableBodyNone">Form feed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>\n</code>   </td><td class="markdownTableBodyNone">Line feed (newline)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>\r</code>   </td><td class="markdownTableBodyNone">Carriage return    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>\t</code>   </td><td class="markdownTableBodyNone">Horizontal tabulation    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>\v</code>   </td><td class="markdownTableBodyNone">Vertical tabulation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>\</code> + octal number   </td><td class="markdownTableBodyNone">Corresponding ASCII character: <code>\0</code> → NULL, <code>\42</code> → <code>"</code>   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>The string <em>encoding</em> is unspecified and not validated, but for best results, stick to ASCII.</dd></dl>
</dd>
<dt>Number literal </dt>
<dd><p class="startdd">A number can be written in three forms:</p>
<ul>
<li><em>decimal integer:</em> <code>1</code>, <code>123</code>, etc.</li>
<li><em>decimal floating-point number:</em> <code>1.23</code>, etc.</li>
<li><em>hexadecimal integer:</em> prefixed with <code>0x</code>: <code>0x123</code>, <code>0xff</code>, <code>0xAB</code>, etc. </li>
</ul>
</dd>
</dl>
<h2><a class="anchor" id="keywords"></a>
Keywords</h2>
<p>The following table presents the keywords used in the format. They are <em>case-sensitive</em>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Keyword   </th><th class="markdownTableHeadNone">Use    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>action</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>alias</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>alphanumeric_keys</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>alternate_group</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>alternate</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>augment</code>   </td><td class="markdownTableBodyNone">Mode qualifier for <a class="el" href="#xkb-include">include</a> statements    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>default</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>function_keys</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>group</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>hidden</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>include</code>   </td><td class="markdownTableBodyNone"><a class="el" href="#xkb-include">Include statement</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>indicator</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>interpret</code>   </td><td class="markdownTableBodyNone"><a class="el" href="#interpret-statements">Interpret statement</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>key</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>keypad_keys</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>keys</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>logo</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>mod_map</code>   </td><td class="markdownTableBodyNone">Alias of <code>modifier_map</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>modifier_keys</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>modmap</code>   </td><td class="markdownTableBodyNone">Alias of <code>modifier_map</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>modifier_map</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>outline</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>overlay</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>override</code>   </td><td class="markdownTableBodyNone">Mode qualifier for <a class="el" href="#xkb-include">include</a> statements    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>partial</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>replace</code>   </td><td class="markdownTableBodyNone">Mode qualifier for <a class="el" href="#xkb-include">include</a> statements    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>row</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>section</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>shape</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>solid</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>text</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>type</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>virtual_modifiers</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>virtual</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>xkb_compat_map</code>   </td><td class="markdownTableBodyNone">Alias of <code>xkb_compatibility_map</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>xkb_compat</code>   </td><td class="markdownTableBodyNone">Alias of <code>xkb_compatibility_map</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>xkb_compatibility_map</code>   </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_compat-section">compatibility section</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>xkb_compatibility</code>   </td><td class="markdownTableBodyNone">Alias of <code>xkb_compatibility_map</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>xkb_geometry</code>   </td><td class="markdownTableBodyNone">Declare a geometry section (<span class="todo">TODO: legacy</span>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>xkb_keycodes</code>   </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_keycodes-section">keycodes section</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="structxkb__keymap.html" title="Opaque compiled keymap object.">xkb_keymap</a></code>   </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_keymap-block">keymap block</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>xkb_layout</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>xkb_semantics</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>xkb_symbols</code>   </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_symbols-section">symbols section</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>xkb_types</code>   </td><td class="markdownTableBodyNone">Declare a <a class="el" href="#the-xkb_types-section">key types section </a>   </td></tr>
</table>
<h2><a class="anchor" id="built-in-settings"></a>
Built-in settings</h2>
<p>There are many built-in settings; they are explained in the following relevant sections.</p>
<p>These settings are <em>case-insensitive</em>, e.g. the following strings denote the same key word: <code>SETMODS</code>, <code>SetMods</code>, <code>setMods</code> and <code>setmods</code>.</p>
<h2><a class="anchor" id="xkb-include"></a>
The include mechanism</h2>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo</a></b></dt><dd>the import mechanism, its qualifiers</dd></dl>
<h1><a class="anchor" id="the-xkb_keymap-block"></a>
The “xkb_keymap” block</h1>
<p>A <b><a class="el" href="#keymap-file-def">keymap file</a></b> consists of a single top-level <code><a class="el" href="structxkb__keymap.html" title="Opaque compiled keymap object.">xkb_keymap</a></code> block, under which are nested the following sections:</p>
<dl>
<dt><code><a class="el" href="#the-xkb_keycodes-section">xkb_keycodes</a></code> </dt>
<dd>A translation of the hardware/evdev scancodes from the keyboard into XKB symbolic keycodes.  </dd>
<dt><code><a class="el" href="#the-xkb_types-section">xkb_types</a></code> </dt>
<dd>A specification of the modifier mask, target level and preserved modifiers various modifiers combination produce.  </dd>
<dt><code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> </dt>
<dd>A specification of what actions various special-purpose keys produce.  </dd>
<dt><code><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a></code> </dt>
<dd>A translation of symbolic key codes into actual symbols and actions.  </dd>
</dl>
<p>Overview of a keymap file:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structxkb__keymap.html">xkb_keymap</a> {</div>
<div class="line">  xkb_keycodes <span class="stringliteral">&quot;XXX&quot;</span> {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">  }</div>
<div class="line">  xkb_types <span class="stringliteral">&quot;XXX&quot;</span> {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">  };</div>
<div class="line">  xkb_compatibility <span class="stringliteral">&quot;XXX&quot;</span> {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">  };</div>
<div class="line">  xkb_symbols <span class="stringliteral">&quot;XXX&quot;</span> {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="ttc" id="astructxkb__keymap_html"><div class="ttname"><a href="structxkb__keymap.html">xkb_keymap</a></div><div class="ttdoc">Opaque compiled keymap object.</div></div>
</div><!-- fragment --><h1><a class="anchor" id="the-xkb_keycodes-section"></a>
The “xkb_keycodes” section</h1>
<p>This is the simplest <a class="el" href="#keymap-section-def">section</a> type, and is the first one to be compiled. The purpose of this is mostly to map between the hardware/evdev scancodes and XKB <a class="el" href="#keycode-def">keycodes</a>. Each key is given a name by which it can be referred to later, e.g. in the symbols section.</p>
<h2><a class="anchor" id="keycode-statements"></a>
Keycode statements</h2>
<p>Statements of the form: </p><pre class="fragment">&lt;TLDE&gt; = 49;
&lt;AE01&gt; = 10;
</pre><p>The above would let 49 and 10 be valid keycodes in the keymap, and assign them the names <code>TLDE</code> and <code>AE01</code> respectively. The format <code>&lt;WXYZ&gt;</code> is always used to refer to a key by name.</p>
<p>The naming convention <code>&lt;AE01&gt;</code> is based on the <a href="https://en.wikipedia.org/wiki/ISO/IEC_9995#ISO/IEC_9995-1">standard ISO/IEC&#160;9995-1</a>. It denotes the position of the key in the keyboard grid. It means: the main alphanumeric section (<code>A</code>), row <code>E</code> and column <code>01</code>.</p>
<p>The following figure illustrates the grid on a staggered standard US QWERTY keyboard. <code>&lt;AE01&gt;</code> corresponds to the key <code>1</code>.</p>
<div class="fragment"><div class="line">   \ 99 \ 00 \ 01 \ 02 \ 03 \ 04 \ 05…</div>
<div class="line">    \    \    \    \    \    \    \</div>
<div class="line">-----------------------------------------</div>
<div class="line">E     \    \ ^  \ 1  \ 2  \ 3  \ 4  \ 5…</div>
<div class="line">------------------------------------------</div>
<div class="line">D      \     Tab \ Q  \ W  \ E  \ R  \ T…</div>
<div class="line">-------------------------------------------</div>
<div class="line">C       \Caps     \ A  \ S  \ D  \ F  \ G…</div>
<div class="line">--------------------------------------------</div>
<div class="line">B        \Shift    \ Z  \ X  \ C  \ V  \ B…</div>
<div class="line">---------------------------------------------</div>
<div class="line">A         \Ctrl\GUI \Alt \Space…</div>
<div class="line">----------------------------------------------</div>
</div><!-- fragment --><p>In the common case this just maps to the evdev scancodes from <code>/usr/include/linux/input.h</code>, e.g. the following definitions: </p><pre class="fragment">#define KEY_GRAVE            41
#define KEY_1                2
</pre><p>correspond to the ones above. Similar definitions appear in the xf86-input-keyboard driver. Note that in all current keymaps there’s a constant offset of 8 (for historical reasons).</p>
<p>Note that contrary to xkbcommon, the X11 protocol supports keycodes only up to <code>255</code>. Therefore, when interfacing with X11, keymaps and applications using keycodes beyond <code>255</code> should expect warnings.</p>
<p>If there’s a conflict, like the same name given to different keycodes, or same keycode given different names, it is resolved according to the merge mode which applies to the definitions.</p>
<h2><a class="anchor" id="alias-statements"></a>
Alias statements</h2>
<p>Statements of the form: </p><pre class="fragment">alias &lt;MENU&gt; = &lt;COMP&gt;;
</pre><p>Allows to refer to a previously defined key (here <code>&lt;COMP&gt;</code>) by another name (here <code>&lt;MENU&gt;</code>). Conflicts are handled similarly to keycode statements.</p>
<h2><a class="anchor" id="indicator-name"></a>
LED name statements</h2>
<p>Statements of the form: </p><pre class="fragment">indicator 1 = "Caps Lock";
indicator 2 = "Num Lock";
indicator 3 = "Scroll Lock";
</pre><p>Assigns a name to the keyboard LED (AKA <a class="el" href="#indicator-def">indicator</a>) with the given index. The LED may be referred by this name later in the compat section and by the user.</p>
<h1><a class="anchor" id="the-xkb_types-section"></a>
The “xkb_types” section</h1>
<p>This <a class="el" href="#keymap-section-def">section</a> is the second to be processed, after <code>xkb_keycodes</code>. However, it is completely independent and could have been the first to be processed (it does not refer to specific keys as specified in the <code>xkb_keycodes</code> section).</p>
<p>This section defines <a class="el" href="#key-type-def">key types</a>, which, given a key and a keyboard state (i.e. modifier state and group), determine the <a class="el" href="#level-def">shift level</a> to be used in translating the key to <a class="el" href="#keysym-def">keysyms</a>. These types are assigned to each group in each key, in the <code>xkb_symbols</code> section.</p>
<p>Key types are called this way because, in a way, they really describe the “type” of the key (or more correctly, a specific group of the key). For example, an ordinary keymap will provide a type called <code>KEYPAD</code>, which consists of two levels, with the second level being chosen according to the state of the Num Lock (or Shift) modifiers. Another example is a type called <code>ONE_LEVEL</code>, which is usually assigned to keys such as Escape; these have just one level and are not affected by the modifier state. Yet more common examples are <a class="el" href="#TWO_LEVEL"><code>TWO_LEVEL</code></a> (with Shift choosing the second level), <a class="el" href="#ALPHABETIC"><code>ALPHABETIC</code></a> (where Caps Lock may also choose the second level), etc.</p>
<h2><a class="anchor" id="how-key-types-work"></a>
How key types work</h2>
<p>Key types define a <em>mapping</em> between the <a class="el" href="#modifier-def">modifiers</a> and <a class="el" href="#level-def">shift levels</a>. Key types have four parameters:</p>
<dl>
<dt><a class="el" href="#key-type-level-name">Shift level names</a> </dt>
<dd>Declare <a class="el" href="#level-def">shift levels</a>. Mainly for documentation. </dd>
<dt><a class="el" href="#key-type-modifiers">Modifiers filter</a> </dt>
<dd>Declare what modifiers should be taken into account in the mapping. </dd>
<dt><a class="el" href="#key-type-map">Modifiers mapping</a> </dt>
<dd>Lookup table to translate modifiers combinations into shift levels. </dd>
<dt><a class="el" href="#key-type-preserve">Modifiers preservation</a> </dt>
<dd>Tweak the computation of <a class="el" href="group__state.html">consumed modifiers</a>. </dd>
</dl>
<p>Key types are used to compute:</p><ul>
<li>the <a class="el" href="#level-def">shift level</a>: see <a class="el" href="group__state.html#ga6ec69be58f357c924b7c99c075631d74" title="Get the effective shift level for a key in a given keyboard state and layout.">xkb_state::xkb_state_key_get_level()</a>.</li>
<li>the <a class="el" href="group__state.html">consumed modifiers</a>: see <a class="el" href="group__state.html#ga3ae2a3bdd451bbf8dcee3080935aa0d3" title="Same as xkb_state_key_get_consumed_mods2() with mode XKB_CONSUMED_MODE_XKB.">xkb_state::xkb_state_key_get_consumed_mods()</a> and <a class="el" href="group__state.html#ga5b119b99542fcad1787119191ba9e286" title="Get the mask of modifiers consumed by translating a given key.">xkb_state::xkb_state_key_get_consumed_mods2()</a>.</li>
</ul>
<p>The following diagram presents an overview of theses computations:</p>
<p><a class="anchor" id="xkb-types-explanation-diagram"></a></p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_xkb-types-explanation.svg" width="607" height="966"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
Use of key types to compute shift level and consumed modifiers</div>
</div>
<h2><a class="anchor" id="type-definitions"></a>
Type definitions</h2>
<p>Statements of the form: </p><pre class="fragment">type "FOUR_LEVEL" { ... }
</pre><p>The above would create a new type named <a class="el" href="#FOUR_LEVEL"><code>FOUR_LEVEL</code></a>. The body of the definition may include statements of the following forms:</p>
<h3><a class="anchor" id="key-type-level-name"></a>
“level_name” statements</h3>
<pre class="fragment">level_name[Level1] = "Base";
</pre><p>Mandatory for each level in the type.</p>
<p>Gives each level in this type a descriptive name. It isn’t used for anything.</p>
<p>Note: A level may be specified as Level[1-8] or just a number (can be more than 8).</p>
<h3><a class="anchor" id="key-type-modifiers"></a>
“modifiers” statement</h3>
<pre class="fragment">modifiers = Shift+Lock+LevelThree;
</pre><p>Mandatory, should be specified only once.</p>
<p>A mask of real and virtual <a class="el" href="#modifier-def">modifiers</a>. These are the only modifiers being considered when matching the modifier state against the type. The other modifiers, whether active or not, are masked out in the calculation.</p>
<h3><a class="anchor" id="key-type-map"></a>
“map” entry statements</h3>
<pre class="fragment">map[Shift+LevelThree] = Level4;
</pre><p>Should have at least as many mappings as there are levels in the type.</p>
<p>If the active modifiers, masked with the type’s modifiers (as stated above), match (i.e. equal) the modifiers inside the <code>map[]</code> statement, then the level in the right hand side is chosen. For example, in the above, if in the current keyboard state the <code>Shift</code> and <code>LevelThree</code> modifiers are active, while the <code>Lock</code> modifier is not, then the keysym(s) in the 4th level of the group will be returned to the user.</p>
<h3><a class="anchor" id="key-type-preserve"></a>
“preserve” statements</h3>
<pre class="fragment">map[Shift+Lock+LevelThree] = Level5;
preserve[Shift+Lock+LevelThree] = Lock;
</pre><p>When a key type is used for keysym translation, its modifiers are said to be <a class="el" href="group__state.html">consumed</a> in this translation. For example, in a simple US keymap, the “G” key is assigned an ordinary <a class="el" href="#ALPHABETIC"><code>ALPHABETIC</code></a> key type, whose modifiers are <code>Shift</code> and <code>Lock</code>; then for the “G” key, these two modifiers are consumed by the translation. This information is relevant for applications which further process the modifiers, since by then the consumed modifiers have already “done their part” and should be masked out.</p>
<p>However, sometimes even if a modifier had already affected the key translation through the type, it should <em>not</em> be reported as consumed, for various reasons. In this case, a <code>preserve[]</code> statement can be used to augment the map entry. The modifiers inside the square brackets should match one of the <code>map[]</code> statements in the type (if there is no matching map entry, one mapping to Level1 is implicitly added). The right hand side should consists of modifiers from the type’s modifiers; these modifiers are then “preserved” and not reported as consumed.</p>
<dl class="section attention"><dt>Attention</dt><dd>Consuming a <em>locked</em> modifier does <em>not</em> unlock it and it can be consumed again in further keysym translations.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Remember that <a class="el" href="group__keysyms.html">Keysym Transformations</a> may affect the resulting keysym when some modifiers are not <a class="el" href="group__state.html">consumed</a>.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><code>preserve</code> statements may be used to tweak keyboard shorcuts. </dd>
<dd>
<figure> <figcaption> Example of use of <code>preserve</code> to tweak <code>Control</code> shortcuts. Note it would require further work in order to support other modifiers. </figcaption> <div class="fragment"><div class="line">xkb_types {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    type <span class="stringliteral">&quot;TWO_LEVEL_PLUS_CONTROL&quot;</span> {</div>
<div class="line">        modifiers = Shift + Control;</div>
<div class="line">        map[None]          = Level1;</div>
<div class="line">        map[Shift]         = Level2;</div>
<div class="line">        map[Control]       = Level3;</div>
<div class="line">        map[Control+Shift] = Level4;</div>
<div class="line">        <span class="comment">// Using preserve will make Control not consumed and allow</span></div>
<div class="line">        <span class="comment">// applications to detect keyboard shortcuts with alternative</span></div>
<div class="line">        <span class="comment">// keysyms in levels 3 and 4 rather than the levels 1 and 2.</span></div>
<div class="line">        preserve[Control]       = Control;</div>
<div class="line">        preserve[Control+Shift] = Control;</div>
<div class="line">        level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">        level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">        level_name[Level3] = <span class="stringliteral">&quot;Tweaked Control&quot;</span>;</div>
<div class="line">        level_name[Level4] = <span class="stringliteral">&quot;Tweaked Control + Shift&quot;</span>;</div>
<div class="line">    };</div>
<div class="line">};</div>
<div class="line">xkb_symbols {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    <span class="comment">// The following key would produce Greek keysym on Base and Shift levels,</span></div>
<div class="line">    <span class="comment">// but will produce the corresponding ASCII Latin keysyms when using Control.</span></div>
<div class="line">    key &lt;AC01&gt; {</div>
<div class="line">        type[Group1]=<span class="stringliteral">&quot;TWO_LEVEL_PLUS_CONTROL&quot;</span>,</div>
<div class="line">        [Greek_alpha, Greek_ALPHA, a, A]</div>
<div class="line">    };</div>
<div class="line">};</div>
</div><!-- fragment --> </figure></dd></dl>
<h2><a class="anchor" id="key-type-examples"></a>
Key types examples</h2>
<h3><a class="anchor" id="definitions-examples"></a>
Definitions examples</h3>
<dl class="section note"><dt>Note</dt><dd>The convention is that <code>Lock</code> affect only “alphabetic” types. For such types, <code>Lock</code> “cancels” <code>Shift</code> by default, i.e. <code>Shift+Lock</code> has the same result as neither modifier. “<em>semi</em>-alphabetic” types have an asymmetry: their first two levels are alphabetic while the next are not.</dd></dl>
<h4><a class="anchor" id="two-levels"></a>
Two levels</h4>
<p>The following examples compare two basic types with <em>two levels</em>: <a class="el" href="#TWO_LEVEL"><code>TWO_LEVEL</code></a> and <a class="el" href="#ALPHABETIC"><code>ALPHABETIC</code></a>. They differ on their handling of the <code>Lock</code> modifier. See the <a class="el" href="#key-type-mappings-examples">next section</a> for an illustration with concrete layouts.</p>
<div class="example-container"> <div class="example"> <div class="example-inner"> <div class="example-title"><code>TWO_LEVEL</code><a class="anchor" id="TWO_LEVEL"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/basic#L14">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;TWO_LEVEL&quot;</span> {</div>
<div class="line">    <span class="comment">// Only care about Shift; Lock will be filter out</span></div>
<div class="line">    modifiers = Shift;</div>
<div class="line">    <span class="comment">// Define mapping</span></div>
<div class="line">    map[None]  = Level1; <span class="comment">// No modifier   -&gt; level 1</span></div>
<div class="line">    map[Shift] = Level2; <span class="comment">// Exactly Shift -&gt; level 2</span></div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    <span class="comment">// Define level names</span></div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figcaption> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers   </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers   </th><th class="markdownTableHeadNone">Match?   </th><th class="markdownTableHeadNone">Shift level    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1               </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift + Lock</code>   </td><td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2   </td></tr>
</table>
</figcaption> </div> </div> <div class="example"> <div class="example-inner"> <div class="example-title"><code>ALPHABETIC</code><a class="anchor" id="ALPHABETIC"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/basic#L21">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;ALPHABETIC&quot;</span> {</div>
<div class="line">    <span class="comment">// Only care about Shift and Lock</span></div>
<div class="line">    modifiers = Shift + Lock;</div>
<div class="line">    <span class="comment">// Define mapping</span></div>
<div class="line">    map[None]  = Level1; <span class="comment">// No modifier   -&gt; level 1</span></div>
<div class="line">    map[Shift] = Level2; <span class="comment">// Exactly Shift -&gt; level 2</span></div>
<div class="line">    map[Lock]  = Level2; <span class="comment">// Exactly Lock  -&gt; level 2</span></div>
<div class="line">    <span class="comment">// Define level names</span></div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Caps&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figcaption> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers   </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers   </th><th class="markdownTableHeadNone">Match?   </th><th class="markdownTableHeadNone">Shift level    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2               </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift + Lock</code>   </td><td class="markdownTableBodyNone"><code>Shift + Lock</code>   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1   </td></tr>
</table>
</figcaption> </div> </div> </div><h4><a class="anchor" id="four-levels"></a>
Four levels</h4>
<p>The following examples compare basic types with <em>four levels</em>: <a class="el" href="#FOUR_LEVEL"><code>FOUR_LEVEL</code></a>, <a class="el" href="#FOUR_LEVEL_SEMIALPHABETIC"><code>FOUR_LEVEL_SEMIALPHABETIC</code></a> and <a class="el" href="#FOUR_LEVEL_ALPHABETIC"><code>FOUR_LEVEL_ALPHABETIC</code></a>. They differ on their handling of the <code>Lock</code> modifier. See the <a class="el" href="#key-type-mappings-examples">next section</a> for an illustration with concrete layouts.</p>
<div class="example-container"> <div class="example"> <div class="example-inner"> <div class="example-title"><code>FOUR_LEVEL</code><a class="anchor" id="FOUR_LEVEL"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/extra#L8">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;FOUR_LEVEL&quot;</span> {</div>
<div class="line">    modifiers = Shift + LevelThree;</div>
<div class="line">    map[None] = Level1;</div>
<div class="line">    map[Shift] = Level2;</div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    map[LevelThree] = Level3;</div>
<div class="line">    map[Shift+LevelThree] = Level4;</div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no map entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no preserve entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no preserve entry with Lock)</span></div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">    level_name[Level3] = <span class="stringliteral">&quot;AltGr&quot;</span>;</div>
<div class="line">    level_name[Level4] = <span class="stringliteral">&quot;Shift AltGr&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figcaption> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers   </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers   </th><th class="markdownTableHeadNone">Match?   </th><th class="markdownTableHeadNone">Shift level    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1               </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift+Lock</code>   </td><td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree+Shift</code>   </td><td class="markdownTableBodyNone"><code>LevelThree+Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree+Lock</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree+Shift+Lock</code>   </td><td class="markdownTableBodyNone"><code>LevelThree+Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">4   </td></tr>
</table>
</figcaption> </div> </div> <div class="example"> <div class="example-inner"> <div class="example-title"><code>FOUR_LEVEL_SEMIALPHABETIC</code><a class="anchor" id="FOUR_LEVEL_SEMIALPHABETIC"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/extra#L36">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;FOUR_LEVEL_SEMIALPHABETIC&quot;</span> {</div>
<div class="line">    modifiers = Shift + Lock + LevelThree;</div>
<div class="line">    map[None] = Level1;</div>
<div class="line">    map[Shift] = Level2;</div>
<div class="line">    map[Lock] = Level2;</div>
<div class="line">    map[Shift+Lock] = Level1;</div>
<div class="line">    map[LevelThree] = Level3;</div>
<div class="line">    map[Shift+LevelThree] = Level4;</div>
<div class="line">    map[Lock+LevelThree] = Level3;</div>
<div class="line">    map[Shift+Lock+LevelThree] = Level4;</div>
<div class="line">    preserve[Lock+LevelThree] = Lock;</div>
<div class="line">    preserve[Shift+Lock+LevelThree] = Lock;</div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">    level_name[Level3] = <span class="stringliteral">&quot;AltGr&quot;</span>;</div>
<div class="line">    level_name[Level4] = <span class="stringliteral">&quot;Shift AltGr&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figcaption> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers   </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers   </th><th class="markdownTableHeadNone">Match?   </th><th class="markdownTableHeadNone">Shift level    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2               </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift+Lock</code>   </td><td class="markdownTableBodyNone"><code>Shift+Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree+Shift</code>   </td><td class="markdownTableBodyNone"><code>LevelThree+Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree+Lock</code>   </td><td class="markdownTableBodyNone"><code>LevelThree+Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree+Shift+Lock</code>   </td><td class="markdownTableBodyNone"><code>LevelThree+Shift+Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">4   </td></tr>
</table>
</figcaption> </div> </div> <div class="example"> <div class="example-inner"> <div class="example-title"><code>FOUR_LEVEL_ALPHABETIC</code><a class="anchor" id="FOUR_LEVEL_ALPHABETIC"></a></div> <figure><figcaption><p> Definition code (<a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/types/extra#L20">source</a>) </p></figcaption> <div class="fragment"><div class="line">type <span class="stringliteral">&quot;FOUR_LEVEL_ALPHABETIC&quot;</span> {</div>
<div class="line">    modifiers = Shift + Lock + LevelThree;</div>
<div class="line">    map[None] = Level1;</div>
<div class="line">    map[Shift] = Level2;</div>
<div class="line">    map[Lock] = Level2;</div>
<div class="line">    map[Shift+Lock] = Level1;</div>
<div class="line">    map[LevelThree] = Level3;</div>
<div class="line">    map[Shift+LevelThree] = Level4;</div>
<div class="line">    map[Lock+LevelThree] = Level4;</div>
<div class="line">    map[Shift+Lock+LevelThree] = Level3;</div>
<div class="line">    <span class="comment">// (no preserve entry with Lock)</span></div>
<div class="line">    <span class="comment">// (no preserve entry with Lock)</span></div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">    level_name[Level3] = <span class="stringliteral">&quot;AltGr&quot;</span>;</div>
<div class="line">    level_name[Level4] = <span class="stringliteral">&quot;Shift AltGr&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> </figcaption> <figure><figcaption><p> Mapping test </p></figcaption> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>Active</em> modifiers   </th><th class="markdownTableHeadNone"><em>Filtered</em> modifiers   </th><th class="markdownTableHeadNone">Match?   </th><th class="markdownTableHeadNone">Shift level    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">2               </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift+Lock</code>   </td><td class="markdownTableBodyNone"><code>Shift+Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree+Shift</code>   </td><td class="markdownTableBodyNone"><code>LevelThree+Shift</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree+Lock</code>   </td><td class="markdownTableBodyNone"><code>LevelThree+Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree+Shift+Lock</code>   </td><td class="markdownTableBodyNone"><code>LevelThree+Shift+Lock</code>   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">3   </td></tr>
</table>
</figcaption> </div> </div> </div><h3><a class="anchor" id="key-type-mappings-examples"></a>
Examples with standard keyboard layouts</h3>
<details >
<summary >
See the detailed table of mappings</summary>
<p>The following table compares the mappings of various key types for the modifiers <code>Shift</code>, <code>Lock</code> and <code>LevelThree</code>, using the standard layouts <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/us#L3"><code>us</code></a> (US English) and <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/es#L3"><code>es</code></a> (Spanish).</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Key   </th><th class="markdownTableHeadNone">Layout   </th><th class="markdownTableHeadNone">Key type   </th><th class="markdownTableHeadNone">Active modifiers   </th><th class="markdownTableHeadNone">Level   </th><th class="markdownTableHeadNone">Keysym   </th><th class="markdownTableHeadNone">Comment    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="16"><code>AE01</code>   </td><td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/us#L3"><code>us</code></a>   </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#TWO_LEVEL"><code>TWO_LEVEL</code></a>   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>exclam</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>exclam</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> filtered out    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>exclam</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone">Modifiers <code>LevelThree</code> and <code>Lock</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>exclam</code>   </td><td class="markdownTableBodyNone">Modifiers <code>LevelThree</code> and <code>Lock</code> filtered out    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/es#L3"><code>es</code></a>   </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#FOUR_LEVEL"><code>FOUR_LEVEL</code></a>   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>exclam</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>exclam</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> filtered out    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone"><code>bar</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code>   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone"><code>exclamdown</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone"><code>bar</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone"><code>exclamdown</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> filtered out    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="16"><code>AD01</code>   </td><td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/us#L3"><code>us</code></a>   </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#ALPHABETIC"><code>ALPHABETIC</code></a>   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>q</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>Q</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>Q</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>q</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> cancelled by <code>Shift</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>q</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>q</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>Q</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>q</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out, <code>Lock</code> cancelled by <code>Shift</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/es#L3"><code>es</code></a>   </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#FOUR_LEVEL_SEMIALPHABETIC"><code>FOUR_LEVEL_SEMIALPHABETIC</code></a>   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>q</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>Q</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>Q</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>q</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> cancelled by <code>Shift</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone"><code>at</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code>   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone"><code>Greek_OMEGA</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone"><code>at</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> does not affect <code>LevelThree</code> combos    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone"><code>Greek_OMEGA</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> does not affect <code>LevelThree</code> combos    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="16"><code>AD05</code>   </td><td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/us#L3"><code>us</code></a>   </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#ALPHABETIC"><code>ALPHABETIC</code></a>   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>t</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>T</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>T</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>t</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> cancelled by <code>Shift</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>t</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>t</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>T</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>t</code>   </td><td class="markdownTableBodyNone"><code>LevelThree</code> filtered out, <code>Lock</code> cancelled by <code>Shift</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="8"><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/022c3ca1db12e505cbd5ce8bf19c432d6a70c7e5/symbols/es#L3"><code>es</code></a>   </td><td class="markdownTableBodyNone" rowspan="8"><a class="el" href="#FOUR_LEVEL_ALPHABETIC"><code>FOUR_LEVEL_ALPHABETIC</code></a>   </td><td class="markdownTableBodyNone">(none)   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>t</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>T</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>T</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>t</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> cancelled by <code>Shift</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone"><code>tslash</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code>   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone"><code>Tslash</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone"><code>Tslash</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code> + <code>Shift</code> + <code>Lock</code>   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone"><code>tslash</code>   </td><td class="markdownTableBodyNone"><code>Lock</code> cancelled by <code>Shift</code>   </td></tr>
</table>
</details>
<h1><a class="anchor" id="the-xkb_compat-section"></a>
The “xkb_compat” section</h1>
<p>This <a class="el" href="#keymap-section-def">section</a> is the third to be processed, after <code>xkb_keycodes</code> and <code>xkb_types</code>.</p>
<h2><a class="anchor" id="interpret-statements"></a>
Interpret statements</h2>
<p>Statements of the form: </p><pre class="fragment">interpret Num_Lock+Any { ... }
interpret Shift_Lock+AnyOf(Shift+Lock) { ... }
</pre><p>The <code><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a></code> section (see below) allows the keymap author to perform, among other things, the following things for each key:</p>
<ul>
<li>Bind an <a class="el" href="#key-action-def">action</a>, like <code>SetMods</code> or <code>LockGroup</code>, to the key. Actions, like symbols, are specified for each level of each group in the key separately.</li>
<li>Add a <a class="el" href="#virtual-modifier-def">virtual modifier</a> to the key’s virtual modifier mapping (<code>vmodmap</code>).</li>
<li>Specify whether the key should repeat or not.</li>
</ul>
<p>However, doing this for each key (or level) is tedious and inflexible. Interpret’s are a mechanism to apply these settings to a bunch of keys/levels at once.</p>
<p><a class="anchor" id="interpret-mechanism"></a>Each interpret specifies a condition by which it attaches to certain levels. The condition consists of two parts:</p>
<ul>
<li>A <b><a class="el" href="#keysym-def">keysym</a></b>. If the level has a different (or more than one) keysym, the match fails. Leaving out the keysym is equivalent to using the special value <code>Any</code> or the <code>NoSymbol</code> keysym, which always matches successfully.</li>
<li><p class="startli">A <b><a class="el" href="#modifier-def">modifier</a> predicate</b>. The predicate consists of:</p><ul>
<li><p class="startli">A <b>mask</b> of <em>real</em> modifiers: a <code>+</code>-separated list of modifiers or the special value <code>all</code>, which denotes all the modifiers.</p>
<p class="startli">The modifiers are matched against the key’s modifier map (<code>modmap</code>).</p>
</li>
<li>A <b>matching operation</b>, that is one of the following:<ul>
<li><code>AnyOfOrNone</code> – The modmap must either be empty or include at least one of the specified modifiers.</li>
<li><code>AnyOf</code> – The modmap must include at least one of the specified modifiers.</li>
<li><code>Any</code> – Alias for <code>AnyOf(all)</code>.</li>
<li><code>NoneOf</code> – The modmap must not include any of the specified modifiers.</li>
<li><code>AllOf</code> – The modmap must include all of the specified modifiers (but may include others as well).</li>
<li><code>Exactly</code> – The modmap must be exactly the same as the specified modifiers.</li>
</ul>
</li>
</ul>
<p class="startli">Leaving out the predicate is equivalent to using <code>AnyOfOrNone(all)</code>. Leaving out just the matching condition is equivalent to using <code>Exactly</code>.</p>
</li>
</ul>
<p>An interpret may also include <code>useModMapMods = level1;</code> – see below.</p>
<p>If a <a class="el" href="#level-def">level</a> fulfils the conditions of several interprets, only the most specific one is used:</p>
<ul>
<li>A specific keysym will always match before a generic <code>NoSymbol</code> condition.</li>
<li>If the keysyms are the same, the interpret with the more specific matching operation is used. The above list is sorted from least to most specific.</li>
<li>If both the keysyms and the matching operations are the same (but the modifiers are different), the first interpret is used.</li>
</ul>
<p>As described above, once an interpret “attaches” to a level, it can bind an action to that level, add one virtual modifier to the key’s vmodmap, or set the key’s repeat setting. You should note the following:</p>
<ul>
<li>The key repeat is a property of the entire key; it is not level-specific. In order to avoid confusion, it is only inspected for the first level of the first group; the interpret’s repeat setting is ignored when applied to other levels.</li>
<li>If one of the above fields was set directly for a key in <code>xkb_symbols</code>, the explicit setting takes precedence over the interpret.</li>
</ul>
<p>The body of the statement may include statements of the following forms (all of which are optional):</p>
<h3><a class="anchor" id="usemodmapmods-statement"></a>
“useModMapMods” statement</h3>
<pre class="fragment">useModMapMods = level1;
</pre><p>When set to <code>level1</code>, the interpret will only match keysyms which are on the first level of the first group of the keys. This can be useful in conjunction with e.g. a <code>virtualModifier</code> statement, because <code>virtualModifier</code> is an attribute of the key rather than a specific level.</p>
<p>Note: the other possible value is <code>any</code> and is the default value.</p>
<h3><a class="anchor" id="interpret-action"></a>
“action” statement</h3>
<pre class="fragment">action = LockMods(modifiers=NumLock);
</pre><p>Bind this action to the matching levels. See <a class="el" href="#key-actions">key actions</a> for the list of available key actions.</p>
<h3><a class="anchor" id="interpret-virtualModifier"></a>
“virtualModifier” statement</h3>
<pre class="fragment">virtualModifier = NumLock;
</pre><p>Add this virtual modifier to the key’s <code>vmodmap</code>. The given virtual modifier must be declared at the top level of the file with a <code>virtual_modifiers</code> statement, e.g.: </p><pre class="fragment">virtual_modifiers NumLock;
</pre><h3><a class="anchor" id="interpret-repeat"></a>
“repeat” statement</h3>
<pre class="fragment">repeat = True;
</pre><p>Set whether the key should repeat or not. Must be a boolean value.</p>
<h2><a class="anchor" id="indicator-effect"></a>
LED map statements</h2>
<p>Statements of the form: </p><pre class="fragment">indicator "Shift Lock" { ... }
</pre><p>This statement specifies the behavior and binding of the LED (AKA <a class="el" href="#indicator-def">indicator</a>) with the given name (“Shift Lock” above). The name should have been declared previously in the <code>xkb_keycodes</code> section (see <a class="el" href="#indicator-name">LED name</a> statement), and given an index there. If it wasn’t, it is created with the next free index.</p>
<p>The body of the statement describes the conditions of the keyboard state which will cause the LED to be lit. It may include the following statements:</p>
<h3><a class="anchor" id="modifiers-statement"></a>
“modifiers” statement</h3>
<pre class="fragment">modifiers = ScrollLock;
</pre><p>If the given <a class="el" href="#modifier-def">modifiers</a> are in the required state (see below), the LED is lit.</p>
<h3><a class="anchor" id="whichmodstate-statement"></a>
“whichModState” statement</h3>
<pre class="fragment">whichModState = Latched+Locked;
</pre><p>Can be any combination of:</p>
<ul>
<li><code>base</code>, <code>latched</code>, <code>locked</code>, <code>effective</code></li>
<li><code>any</code> (i.e. all of the above)</li>
<li><code>none</code> (i.e. none of the above)</li>
<li><code>compat</code> (legacy value, treated as effective)</li>
</ul>
<p>This will cause the respective portion of the modifier state (see <code>struct <a class="el" href="structxkb__state.html" title="Opaque keyboard state object.">xkb_state</a></code>) to be matched against the modifiers given in the <code>modifiers</code> statement.</p>
<p>Here’s a simple example: </p><pre class="fragment">indicator "Num Lock" {
    modifiers = NumLock;
    whichModState = Locked;
};
</pre><p>Whenever the NumLock modifier is locked, the Num Lock LED will light up.</p>
<h3><a class="anchor" id="groups-statement"></a>
“groups” statement</h3>
<pre class="fragment">groups = All - group1;
</pre><p>If the given groups are in the required state (see below), the LED is lit.</p>
<h3><a class="anchor" id="whichgroupstate-statement"></a>
“whichGroupState” statement</h3>
<pre class="fragment">whichGroupState = Effective;
</pre><p>Can be any combination of:</p>
<ul>
<li><code>base</code>, <code>latched</code>, <code>locked</code>, <code>effective</code></li>
<li><code>any</code> (i.e. all of the above)</li>
<li><code>none</code> (i.e. none of the above)</li>
</ul>
<p>This will cause the respective portion of the group state (see <code>struct <a class="el" href="structxkb__state.html" title="Opaque keyboard state object.">xkb_state</a></code>) to be matched against the groups given in the <code>groups</code> statement.</p>
<p>Note: the above conditions are disjunctive, i.e. if any of them are satisfied the LED is lit.</p>
<h2><a class="anchor" id="default-values"></a>
Default values</h2>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo</a></b></dt><dd>e.g. <code>setMods.clearLocks= True;</code></dd></dl>
<h1><a class="anchor" id="the-xkb_symbols-section"></a>
The “xkb_symbols” section</h1>
<p>This <a class="el" href="#keymap-section-def">section</a> is the fourth to be processed, after <code>xkb_keycodes</code>, <code>xkb_types</code> and <code>xkb_compat</code>.</p>
<p>Statements of the form: </p><pre class="fragment">xkb_symbols "basic" {
    ...
}
</pre><p>Declare a symbols map named <code>basic</code>. Statements inside the curly braces only affect the symbols map.</p>
<p>A map can have various flags applied to it above the statement, separated by whitespace: </p><pre class="fragment">partial alphanumeric_keys
xkb_symbols "basic" {
    ...
}
</pre><p>The possible flags are:</p>
<ul>
<li><code>partial</code> - Indicates that the map doesn’t cover a complete keyboard.</li>
<li><code>default</code> - Marks the symbol map as the default map in the file when no explicit map is specified. If no map is marked as a default, the first map in the file is the default.</li>
<li><code>hidden</code> - Variant that can only be used internally</li>
<li><code>alphanumeric_keys</code> - Indicates that the map contains alphanumeric keys</li>
<li><code>modifier_keys</code> - Indicates that the map contains modifier keys</li>
<li><code>keypad_keys</code> - Indicates that the map contains keypad keys</li>
<li><code>function_keys</code> - Indicates that the map contains function keys</li>
<li><code>alternate_group</code> - Indicates that the map contains keys for an alternate group</li>
</ul>
<p>If no <code>*_keys</code> flags are supplied, then the map is assumed to cover a complete keyboard.</p>
<p>At present, except for <code>default</code>, none of the flags affect key processing in libxkbcommon, and only serve as metadata.</p>
<h2><a class="anchor" id="name-statements"></a>
Name statements</h2>
<p>Statements of the form: </p><pre class="fragment">name[Group1] = "US/ASCII";
groupName[1] = "US/ASCII";
</pre><p>Gives the name “US/ASCII” to the first group of symbols. Other groups can be named using a different group index (ex: <code>Group2</code>), and with a different name. A group must be named.</p>
<p><code>group</code> and <code>groupName</code> mean the same thing, and the <code>Group</code> in <code>Group1</code> is optional.</p>
<h2><a class="anchor" id="include-statements"></a>
Include statements</h2>
<p>Statements of the form: </p><pre class="fragment">include "nokia_vndr/rx-51(nordic_base)"
</pre><p>Will include data from another <code>xkb_symbols</code> section, possibly located in another file. Here it would include the <code>xkb_symbols</code> section called <code>nordic_base</code>, from the file <code>rx-51</code> located in the <code>nokia_vndr</code> folder, itself located in an XKB include path.</p>
<p><a class="anchor" id="merge-mode-def"></a>One can use a <b>merge mode</b> <em>prefix</em> to specify the merge mode of the file:</p><ul>
<li>‘+’ selects the <b>override</b> merge mode.</li>
<li><p class="startli">‘|’ selects the <b>augment</b> merge mode.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo</a></b></dt><dd>dedicated section for merge mode</dd></dl>
</li>
</ul>
<h2><a class="anchor" id="key-statement"></a>
Key statement</h2>
<p>Statements of the form: </p><pre class="fragment">key &lt;AD01&gt; { ... };
</pre><p>defines the <em>key description</em> of the <a class="el" href="#keycode-def">keycode</a> <code>&lt;AD01&gt;</code> and is the main type of record of the <code>xkb_symbols</code> section. The possible keycodes are defined in the <a class="el" href="#the-xkb_keycodes-section"><code>xkb_keycodes</code></a> section.</p>
<p>A key description consists of:</p>
<dl>
<dt>Groups </dt>
<dd><p class="startdd">Each key may have one or more associated <a class="el" href="#layout-def">groups</a>. Each group can be configured with the following parameters:</p>
<ul>
<li><a class="el" href="#key-type-setting">Type</a></li>
</ul>
<ul>
<li><a class="el" href="#key-symbols-table">Symbols</a></li>
</ul>
<ul>
<li><a class="el" href="#key-actions-table">Actions</a></li>
</ul>
</dd>
<dt>Additional attributes </dt>
<dd><p class="startdd">These attributes are usually set via the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section, but may be also set directly:</p>
<ul>
<li><a class="el" href="#key-virtual-modifiers">Virtual modifiers</a></li>
<li><a class="el" href="#key-repeat">Repeat</a> </li>
</ul>
</dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Using multiple groups in <em>symbols</em> files is not recommended, because some tools rely on the assumption that an <code>xkb_symbols</code> section only affect a single group. It is fine with a <em>keymap</em> file though.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>In what follows we assume the common use case with a <em>single</em> group, which benefits from a special syntax. See the section <a class="el" href="#key-groups">Multiple groups</a> for the general syntax.</dd></dl>
<h3><a class="anchor" id="key-symbols-table"></a>
Symbols</h3>
<p>The main part of the key description is the <em>symbols table</em>. It maps shift levels to keysyms, e.g.:</p>
<div class="fragment"><div class="line">key &lt;AD01&gt; { [ q, Q ] }; <span class="comment">// Level 1 → `q`, Level 2 → `Q`</span></div>
</div><!-- fragment --><p>Symbols are named using the symbolic names from the <code><a class="el" href="xkbcommon-keysyms_8h.html" title="Key symbols (keysyms) definitions.">xkbcommon/xkbcommon-keysyms.h</a></code> file. A group of symbols is enclosed in brackets and separated by commas. Each element of the symbol arrays corresponds to a different <a class="el" href="#level-def">shift level</a>. In this example, the symbol (keysym) <code>XKB_KEY_q</code> for level 1 and <code>XKB_KEY_Q</code> for level 2. These levels are configured by the <a class="el" href="#key-type-setting">key type</a>, presented in the next section.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Remember that <a class="el" href="group__keysyms.html">Keysym Transformations</a> may affect the resulting keysym when some modifiers are not <a class="el" href="group__state.html">consumed</a>.</dd></dl>
<p>As an extension to the XKB legacy format, libxkbcommon supports multiple key symbols and actions per level (the latter since version 1.8.0): </p><pre class="fragment">key &lt;AD01&gt; { [ {a, b}, Q ] };
</pre><p>In this example, the keycode <code>&lt;AD01&gt;</code> produces two symbols on level 1 (<code>XKB_KEY_a</code> and <code>XKB_KEY_b</code>) and one symbol (<code>XKB_KEY_Q</code>) on level 2.</p>
<p>When no actions are explicitly given, they are automatically filled thanks to <a class="el" href="#interpret-statements">interpretations</a> from the <a class="el" href="#the-xkb_compat-section">compat section</a>. In the following example, </p><pre class="fragment">key &lt;LCTL&gt; { [ { Control_L, ISO_Group_Shift } ] };
</pre><p>is equivalent to (given standard definitions from <code>xkeyboard-config</code>): </p><pre class="fragment">key &lt;LCTL&gt; {
    symbols[1] = [ { Control_L,                  ISO_Group_Shift    } ],
    actions[1] = [ { SetMods(modifiers=Control), SetGroup(group=+1) } ]
};
</pre><p>When using this example with e.g. two layouts <code>fr,us</code> (respectively Azerty and Qwerty layouts), typing <code>Control + A</code> in the first layout <code>fr</code> will in fact result in <code>Control + Q</code>, because the actions are run sequentially: first set the base modifiers to Control, then switch to the second layout while <code>Control</code> is pressed.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Given a level, keysyms and actions may have a <em>different count</em>. For instance, the following would achieve the same effect than the former example with only 1 keysym, but it requires to use 2 explicit actions: <div class="fragment"><div class="line">key &lt;LCTL&gt; {</div>
<div class="line">    symbols[1] = [ Control_L                                          ],</div>
<div class="line">    actions[1] = [ { SetMods(modifiers=Control), SetGroup(group=+1) } ]</div>
<div class="line">};</div>
</div><!-- fragment --></dd></dl>
<dl class="section note"><dt>Note</dt><dd>There are some <em>limitations</em> with this extension:<ul>
<li><p class="startli">For now, <em>at most one</em> action of each following categories is allowed per level:</p><ul>
<li><a class="el" href="#modifiers-actions">modifier actions</a>: <code>SetMods</code>, <code>LatchMods</code>, <code>LockMods</code>;</li>
<li><a class="el" href="#group-actions">group actions</a>: <code>SetGroup</code>, <code>LatchGroup</code>, <code>LockGroup</code>.</li>
</ul>
<p class="startli">Some examples of actions combination:</p><ul>
<li><code>SetMods</code> + <code>SetGroup</code>: ok</li>
<li><code>SetMods</code> + <code>SetMods</code>: <em>error</em></li>
<li><code>SetMods</code> + <code>LockMods</code>: <em>error</em></li>
<li><code>SetMods</code> + <code>LockGroup</code>: ok</li>
</ul>
</li>
<li>Multiple actions are only supported from version 1.8.0.</li>
<li><p class="startli">Since 1.8.0, <code>NoSymbol</code> and <code>NoAction</code> are dropped in order to normalize levels:</p>
<div class="fragment"><div class="line"><span class="comment">// Before normalization</span></div>
<div class="line">key &lt;&gt; { [{NoSymbol}, {a, NoSymbol}, {NoSymbol,b}, {a, NoSymbol, b}] };</div>
<div class="line"><span class="comment">// After normalization</span></div>
<div class="line">key &lt;&gt; { [NoSymbol, a, b, {a, b}] };</div>
</div><!-- fragment --></li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Keymaps containing multiple key symbols per level are not supported by the various X11-related tools (<code>setxkbmap</code>, <code>xkbcomp</code>, etc.).</dd></dl>
<h3><a class="anchor" id="key-type-setting"></a>
Type</h3>
<p>Each key has a <a class="el" href="#key-type-def">key type</a> set per group. This key type is defined in the <code><a class="el" href="#the-xkb_types-section">xkb_types</a></code> section. Its associated <a class="el" href="#level-def">shift levels</a> are used to index the <a class="el" href="#key-symbols-table">symbols table</a> presented in the previous section.</p>
<p>A key type is set using the following syntax:</p>
<div class="fragment"><div class="line">key &lt;AD01&gt; {</div>
<div class="line">    type[Group1] = <span class="stringliteral">&quot;TWO_LEVEL&quot;</span>, <span class="comment">// Type</span></div>
<div class="line">    [q, Q]                      <span class="comment">// Symbols</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>The name of the key type is enclosed between double quotes.</p>
<p>The key type may be omitted and will default to:</p>
<ul>
<li><code>key.type</code> global defaults, if set.</li>
<li>a standard type using the following <b>heuristic</b>:<ul>
<li><b>1</b> keysym: <code>ONE_LEVEL</code></li>
<li><b>2</b> keysyms:<ul>
<li>if the two keysyms are letter and the first is lower case and the other upper case, then <a class="el" href="#ALPHABETIC"><code>ALPHABETIC</code></a>;</li>
<li>if one of the keysyms is numpad, then <code>KEYPAD</code> else <a class="el" href="#TWO_LEVEL"><code>TWO_LEVEL</code></a>.</li>
</ul>
</li>
<li><b>3 or 4</b> keysyms (a missing 4th keysym is set to <code>NoSymbol</code>):<ul>
<li>if the first two keysyms are letters and the first is lower case and the other upper case:<ul>
<li>if the last two keysyms are letters and the first is lower case and the other upper case then <a class="el" href="#FOUR_LEVEL_ALPHABETIC"><code>FOUR_LEVEL_ALPHABETIC</code></a>;</li>
<li>else <a class="el" href="#FOUR_LEVEL_SEMIALPHABETIC"><code>FOUR_LEVEL_SEMIALPHABETIC</code></a>.</li>
</ul>
</li>
<li>if one of the first two keysyms is numpad, then <code>FOUR_LEVEL_KEYPAD</code>;</li>
<li>else <a class="el" href="#FOUR_LEVEL"><code>FOUR_LEVEL</code></a>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure><figcaption><p> Commented examples for inferred types: </p></figcaption><div class="fragment"><div class="line"><span class="comment">// 1 to 2 keysyms</span></div>
<div class="line">key &lt;LFSH&gt; { [Shift_L] };                    <span class="comment">// Type: ONE_LEVEL</span></div>
<div class="line">key &lt;AE01&gt; { [1, exclam] };                  <span class="comment">// Type: TWO_LEVEL</span></div>
<div class="line">key &lt;AD01&gt; { [q, Q] };                       <span class="comment">// Type: ALPHABETIC</span></div>
<div class="line">key &lt;KP1&gt;  { [KP_End, KP_1] };               <span class="comment">// Type: KEYPAD</span></div>
<div class="line"><span class="comment">// Edge case: this is consider alphabetic, although</span></div>
<div class="line"><span class="comment">// the lower case does not correspond to the upper case.</span></div>
<div class="line">key &lt;AD01&gt; { [q, N] };                       <span class="comment">// Type: ALPHABETIC</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// 3 to 4 keysyms</span></div>
<div class="line">key &lt;AE01&gt; { [1, exclam, bar] };             <span class="comment">// Type: FOUR_LEVEL</span></div>
<div class="line">key &lt;AE01&gt; { [1, exclam, bar, exclamdown] }; <span class="comment">// Type: FOUR_LEVEL</span></div>
<div class="line">key &lt;AD01&gt; { [q, Q, at] };                   <span class="comment">// Type: FOUR_LEVEL_SEMIALPHABETIC</span></div>
<div class="line">key &lt;AD01&gt; { [q, Q, at, Greek_OMEGA] };      <span class="comment">// Type: FOUR_LEVEL_SEMIALPHABETIC</span></div>
<div class="line">key &lt;AD05&gt; { [t, T, tslash, Tslash] };       <span class="comment">// Type: FOUR_LEVEL_ALPHABETIC</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// The inferred type is `FOUR_LEVEL`, but using `LevelThree+Lock`</span></div>
<div class="line"><span class="comment">// will produce `Q`, because of the keysyms transformations and</span></div>
<div class="line"><span class="comment">// the corresponding internal capitalization processing.</span></div>
<div class="line">key &lt;AE01&gt; { [1, exclam, q, Q] };            <span class="comment">// Type: FOUR_LEVEL</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Won’t work, because there is no heuristic for more than 4 keysyms</span></div>
<div class="line"><span class="comment">// It will trigger the warnings XKB-183 and XKB-516 and default to ONE_LEVEL,</span></div>
<div class="line"><span class="comment">// ignoring all the keysyms but the first one.</span></div>
<div class="line">key &lt;AD01&gt; {[q, Q, at, any, masculine, U2642]};</div>
<div class="line"><span class="comment">// Will work as expected</span></div>
<div class="line">key &lt;AD01&gt; {</div>
<div class="line">    type[Group1] = <span class="stringliteral">&quot;EIGHT_LEVEL_SEMIALPHABETIC&quot;</span>,</div>
<div class="line">    [q, Q, at, any, masculine, U2642]</div>
<div class="line">};</div>
</div><!-- fragment --> </figure><h3><a class="anchor" id="key-actions-table"></a>
Actions</h3>
<dl class="section note"><dt>Note</dt><dd>This is usually not set explicitly but via the <em><a class="el" href="#interpret-mechanism">interpret mechanism</a></em> by using the <a class="el" href="#interpret-action"><code>action</code></a> statement in the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section.</dd></dl>
<figure><figcaption><p> Example: Set the modifier action of the key <code>&lt;LALT&gt;</code> manually. </p></figcaption><div class="fragment"><div class="line">key &lt;LALT&gt; {</div>
<div class="line">    symbols[Group1]=[Alt_L],</div>
<div class="line">    actions[Group1]=[SetMods(modifiers=modMapMods)]</div>
<div class="line">};</div>
</div><!-- fragment --> </figure><p>For further details see <a class="el" href="#key-actions">key actions</a>.</p>
<h3><a class="anchor" id="key-groups"></a>
Multiple groups</h3>
<p>Each group represents a list of symbols mapped to a keycode: </p><pre class="fragment">name[Group1]= "US/ASCII";
name[Group2]= "Russian";
...
key &lt;AD01&gt; { [ q, Q ],
             [ Cyrillic_shorti, Cyrillic_SHORTI ] };
</pre><p>A long-form syntax can also be used: </p><pre class="fragment">key &lt;AD01&gt; {
    symbols[Group1]= [ q, Q ],
    symbols[Group2]= [ Cyrillic_shorti, Cyrillic_SHORTI ]
};
</pre><p>Groups can also be omitted, but the brackets must be present. The following statement only defines the Group3 of a mapping: </p><pre class="fragment">key &lt;AD01&gt; { [], [], [ q, Q ] };
</pre><dl class="section warning"><dt>Warning</dt><dd>Using multiple groups in <em>symbols</em> files is not recommended, because some tools rely on the assumption that an <code>xkb_symbols</code> section only affect a single group. It is fine with a <em>keymap</em> file though.</dd></dl>
<h3><a class="anchor" id="key-virtual-modifiers"></a>
Virtual modifiers</h3>
<dl class="section note"><dt>Note</dt><dd>This is usually not set explicitly but via the <em><a class="el" href="#interpret-mechanism">interpret mechanism</a></em> by using the <a class="el" href="#interpret-virtualModifier"><code>virtualModifier</code></a> statement from the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>When setting a <a class="el" href="#modifiers-actions">modifier action</a>, it is required to declare the corresponding virtual modifier using a <a class="el" href="#virtual-modifier-statements"><code>virtual_modifiers</code></a> statement.</dd></dl>
<figure><figcaption><p> Example: Set the virtual modifier of the key <code>&lt;LALT&gt;</code> to <code>Alt</code>. </p></figcaption><div class="fragment"><div class="line"><span class="comment">// Declare the virtual modifier that will be used</span></div>
<div class="line">virtual_modifiers Alt;</div>
<div class="line"> </div>
<div class="line">key  &lt;LALT&gt; {</div>
<div class="line">    virtualModifiers = Alt,</div>
<div class="line">    [ Alt_L ]</div>
<div class="line">};</div>
</div><!-- fragment --> </figure><h3><a class="anchor" id="key-repeat"></a>
Repeat</h3>
<dl class="section note"><dt>Note</dt><dd>This is usually not set explicitly but via the <em><a class="el" href="#interpret-mechanism">interpret mechanism</a></em> by using the <a class="el" href="#interpret-repeat"><code>repeat</code></a> statement in the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section.</dd></dl>
<figure><figcaption><p> Example: make the <code>&lt;LALT&gt;</code> key not repeating. </p></figcaption><div class="fragment"><div class="line">key  &lt;LALT&gt; {</div>
<div class="line">    repeat = False,</div>
<div class="line">    [ Alt_L ]</div>
<div class="line">};</div>
</div><!-- fragment --> </figure><h1><a class="anchor" id="virtual-modifier-statements"></a>
Virtual modifier statements</h1>
<p>Statements of the form: </p><pre class="fragment">virtual_modifiers LControl;
</pre><p>Can appear in the <code>xkb_types</code>, <code>xkb_compat</code>, <code>xkb_symbols</code> sections.</p>
<h1><a class="anchor" id="modifiers-bindings"></a>
Modifiers bindings</h1>
<h2><a class="anchor" id="real-and-virtual-modifiers"></a>
Real and virtual modifiers</h2>
<p>Modifiers are a particularly tricky part of XKB. For historical reasons they are divided in two categories: <a class="el" href="#real-modifier-def">real modifiers</a> and <a class="el" href="#virtual-modifier-def">virtual modifiers</a>.</p>
<p>Note that in X11, the maximum of virtual modifiers is 16 (see <code>XkbNumVirtualMods</code>).</p>
<p>The following table summarizes the modifiers defined in <code><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a></code> (this is subject to change).</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Modifier   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Compat files   </th><th class="markdownTableHeadNone">Associated keysyms    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Shift</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>compat/basic</code>   </td><td class="markdownTableBodyNone"><code>Shift_L</code>, <code>Shift_R</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">″   </td><td class="markdownTableBodyNone">″   </td><td class="markdownTableBodyNone"><code>compat/iso9995</code>   </td><td class="markdownTableBodyNone"><code>Shift_L</code>, <code>Shift_R</code>, <code>ISO_Level2_Latch</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Lock</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>compat/basic</code>,   </td><td class="markdownTableBodyNone"><code>Caps_Lock</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">″   </td><td class="markdownTableBodyNone">″   </td><td class="markdownTableBodyNone"><code>compat/caps</code>   </td><td class="markdownTableBodyNone">″    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Control</code>   </td><td class="markdownTableBodyNone">Real   </td><td class="markdownTableBodyNone"><code>compat/basic</code>   </td><td class="markdownTableBodyNone"><code>Control_L</code>, <code>Control_R</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Alt</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/misc</code>,   </td><td class="markdownTableBodyNone"><code>Alt_L</code>, <code>Alt_R</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">″   </td><td class="markdownTableBodyNone">″   </td><td class="markdownTableBodyNone"><code>compat/pc</code>   </td><td class="markdownTableBodyNone">″    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Meta</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/misc</code>   </td><td class="markdownTableBodyNone"><code>Meta_L</code>, <code>Meta_R</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Super</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/misc</code>   </td><td class="markdownTableBodyNone"><code>Super_L</code>, <code>Super_R</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Hyper</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/misc</code>   </td><td class="markdownTableBodyNone"><code>Hyper_L</code>, <code>Hyper_R</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ScrollLock</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/misc</code>   </td><td class="markdownTableBodyNone"><code>Scroll_Lock</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>NumLock</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/basic</code>,   </td><td class="markdownTableBodyNone"><code>Num_Lock</code>,    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">″   </td><td class="markdownTableBodyNone">″   </td><td class="markdownTableBodyNone"><code>compat/level5</code>   </td><td class="markdownTableBodyNone">(<code>ISO_Level5_Lock</code>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LevelThree</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/iso9995</code>   </td><td class="markdownTableBodyNone"><code>ISO_Level3_Shift</code>, <code>ISO_Level3_Latch</code>, <code>ISO_Level3_Lock</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LevelFive</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/level5</code>   </td><td class="markdownTableBodyNone"><code>ISO_Level5_Shift</code>, <code>ISO_Level5_Latch</code>, <code>ISO_Level5_Lock</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Kana_Lock</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/japan</code>   </td><td class="markdownTableBodyNone"><code>Kana_Lock</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Square</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/olpc</code>   </td><td class="markdownTableBodyNone"><code>KP_Home</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Cross</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/olpc</code>   </td><td class="markdownTableBodyNone"><code>KP_Next</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Circle</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/olpc</code>   </td><td class="markdownTableBodyNone"><code>KP_End</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Triangle</code>   </td><td class="markdownTableBodyNone">Virtual   </td><td class="markdownTableBodyNone"><code>compat/olpc</code>   </td><td class="markdownTableBodyNone"><code>KP_Prior</code>   </td></tr>
</table>
<h2><a class="anchor" id="define-and-use-a-modifier"></a>
Define and use a modifier</h2>
<p>We will use the example of the <em>real</em> modifier <code>Shift</code> and the virtual modifier <code>LevelThree</code> in <code>xkeyboard-config</code>.</p>
<p>In order to define and use a modifier, one must:</p>
<ol type="1">
<li><p class="startli">Define its behavior and <a class="el" href="#keysym-def">keysym</a> binding in the <code><a class="el" href="#the-xkb_compat-section">xkb_compat</a></code> section:</p>
<div class="fragment"><div class="line"><span class="comment">// Declare virtual modifiers. Shift being real modifier,</span></div>
<div class="line"><span class="comment">// we do not need to add it here.</span></div>
<div class="line">virtual_modifiers LevelThree;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set defaults. They are overridden if set directly in the xkb_symbols.</span></div>
<div class="line">interpret.repeat= False; <span class="comment">// only applied on first level</span></div>
<div class="line">setMods.clearLocks= True;</div>
<div class="line">latchMods.clearLocks= True;</div>
<div class="line">latchMods.latchToLock= True;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Default statement for real modifiers: any key bound to a real</span></div>
<div class="line"><span class="comment">// modifier via modifier_map will set this modifier at all its</span></div>
<div class="line"><span class="comment">// levels.</span></div>
<div class="line"><span class="comment">// Here only to illustrate: do not add it!</span></div>
<div class="line">interpret Any + Any {</div>
<div class="line">    action= SetMods(modifiers=modMapMods);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Shift being real modifier, we do not need a corresponding</span></div>
<div class="line"><span class="comment">// interpret statement because the previous one suffices.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Let’s associate LevelThree to the keysym ISO_Level3_Shift</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// First, match the keys and their levels with the</span></div>
<div class="line"><span class="comment">// ISO_Level3_Shift keysym and with any real modifier</span></div>
<div class="line"><span class="comment">// (Any = AnyOf(all)) in its modmap.</span></div>
<div class="line">interpret ISO_Level3_Shift+Any {</div>
<div class="line">    <span class="comment">// Only match the first level of the first group</span></div>
<div class="line">    useModMapMods= level1;</div>
<div class="line">    <span class="comment">// Add the virtual modifier to the key’s vmodmap</span></div>
<div class="line">    virtualModifier= LevelThree;</div>
<div class="line">    <span class="comment">// Activate the LevelThree modifier (depressed mode)</span></div>
<div class="line">    action= SetMods(modifiers=LevelThree);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Then for keys and their levels with the</span></div>
<div class="line"><span class="comment">// ISO_Level3_Shift keysym but with either no real modifier</span></div>
<div class="line"><span class="comment">// in its modmap or a level higher than 1.</span></div>
<div class="line"><span class="comment">// Indeed:</span></div>
<div class="line"><span class="comment">// • In case the level is higher than 1 there is no match</span></div>
<div class="line"><span class="comment">//   in the previous statement.</span></div>
<div class="line"><span class="comment">// • The condition is equivalent to</span></div>
<div class="line"><span class="comment">//   ISO_Level3_Shift+AnyOfOrNone(all), but since</span></div>
<div class="line"><span class="comment">//   the previous statement ISO_Level3_Shift+Any is more</span></div>
<div class="line"><span class="comment">//   specific, it will be matched before this one.</span></div>
<div class="line">interpret ISO_Level3_Shift {</div>
<div class="line">    <span class="comment">// Activate the LevelThree modifier (depressed mode)</span></div>
<div class="line">    action= SetMods(modifiers=LevelThree);</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><p class="startli">Define <a class="el" href="#key-type-def">key types</a> that use it in the <code><a class="el" href="#the-xkb_types-section">xkb_types</a></code> section:</p>
<div class="fragment"><div class="line"><span class="comment">// Declare virtual modifiers. Shift being real modifier,</span></div>
<div class="line"><span class="comment">// we do not need to add it here.</span></div>
<div class="line">virtual_modifiers LevelThree;</div>
<div class="line"> </div>
<div class="line">type <span class="stringliteral">&quot;FOUR_LEVEL&quot;</span> {</div>
<div class="line">    <span class="comment">// Key type modifier mask: all the modifiers used in the key type</span></div>
<div class="line">    modifiers = Shift + LevelThree;</div>
<div class="line">    map[None] = Level1;</div>
<div class="line">    map[Shift] = Level2;</div>
<div class="line">    map[LevelThree] = Level3;</div>
<div class="line">    map[Shift+LevelThree] = Level4;</div>
<div class="line">    level_name[Level1] = <span class="stringliteral">&quot;Base&quot;</span>;</div>
<div class="line">    level_name[Level2] = <span class="stringliteral">&quot;Shift&quot;</span>;</div>
<div class="line">    level_name[Level3] = <span class="stringliteral">&quot;AltGr&quot;</span>;</div>
<div class="line">    level_name[Level4] = <span class="stringliteral">&quot;Shift AltGr&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><p class="startli">Bind it to a <a class="el" href="#keycode-def">keycode</a> in the <code><a class="el" href="#the-xkb_symbols-section">xkb_symbols</a></code> section:</p><ol type="a">
<li>Map <a class="el" href="#keysym-def">keysyms</a> used in the <code>xkb_compat</code> section hereinabove.</li>
<li>Bind <a class="el" href="#real-modifier-def">real modifiers</a> to keys using these keysyms with <code>modifier_map</code>.</li>
</ol>
<p class="startli"><em>Note:</em> Only one key binding to real modifier is required. The corresponding keysym must then be on the first level of the first Group.</p>
<p class="startli"><em>Note:</em> One can optionally bind directly a virtual modifier to a key using <code>virtualmodifiers</code> instead of doing it in the <code>xkb_compat</code> section. But the recommended way is to use the <code>xkb_compat</code> section.</p>
<div class="fragment"><div class="line"><span class="comment">// Shift: defined in pc symbols</span></div>
<div class="line">key &lt;LFSH&gt; {[  Shift_L    ]};</div>
<div class="line">key &lt;RTSH&gt; {[  Shift_R    ]};</div>
<div class="line">modifier_map Shift { Shift_L, Shift_R };</div>
<div class="line"><span class="comment">// The previous will resolve to:</span></div>
<div class="line"><span class="comment">// modifier_map Shift { &lt;LFSH&gt;, &lt;RTSH&gt; };</span></div>
<div class="line"><span class="comment">// Thus the real modifier Shift is added to the modmap of</span></div>
<div class="line"><span class="comment">// &lt;LFSH&gt; and &lt;RTSH&gt;.</span></div>
<div class="line"><span class="comment">// The “Any + Any” interpret statement matches &lt;LFSH&gt; and &lt;RTSH&gt;,</span></div>
<div class="line"><span class="comment">// therefore these keys set the Shift modifier.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// LevelThree: defined in pc symbols</span></div>
<div class="line"><span class="comment">// With the following 2 lines:</span></div>
<div class="line"><span class="comment">// 1. The modifier keysym is on the first level of the first group.</span></div>
<div class="line"><span class="comment">// 2. The real modifier Mod5 is bound to &lt;LVL3&gt;,</span></div>
<div class="line"><span class="comment">//    i.e. Mod5 is added to its modmap.</span></div>
<div class="line"><span class="comment">// 3. It matches the interpret statement “ISO_Level3_Shift+Any”,</span></div>
<div class="line"><span class="comment">//    which adds the LevelThree modifier to the vmodmap of &lt;LVL3&gt;.</span></div>
<div class="line"><span class="comment">// 4. The mapping of LevelThree to real modifiers is the union</span></div>
<div class="line"><span class="comment">//    of modmaps with corresponding vmodmaps containing</span></div>
<div class="line"><span class="comment">//    LevelThree. In our case there is only one: therefore</span></div>
<div class="line"><span class="comment">//    LevelThree maps to Mod5.</span></div>
<div class="line">key &lt;LVL3&gt; {[  ISO_Level3_Shift  ]};</div>
<div class="line">modifier_map Mod5  { &lt;LVL3&gt; };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// LevelThree: defined in level3 symbols</span></div>
<div class="line"><span class="comment">// Not bound to a real modifier, so interpret statement</span></div>
<div class="line"><span class="comment">// “ISO_Level3_Shift” applies.</span></div>
<div class="line">key &lt;RALT&gt; {[ISO_Level3_Shift], type[group1]=<span class="stringliteral">&quot;ONE_LEVEL&quot;</span> };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Note: we could have the following line, but it is not necessary</span></div>
<div class="line"><span class="comment">// because we have the mappings of &lt;LVL3&gt;.</span></div>
<div class="line"><span class="comment">// modifier_map Mod5  { &lt;RALT&gt; };</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Warning: if we had the for example the following line, the</span></div>
<div class="line"><span class="comment">// mapping of LevelThree to real modifiers would be “Mod1+Mod5”.</span></div>
<div class="line"><span class="comment">// modifier_map Mod1  { &lt;RALT&gt; };</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Alternative definitions, without using interpret statements</span></div>
<div class="line">virtual_modifiers LevelThree;</div>
<div class="line">key &lt;LVL3&gt; { virtualmodifiers=LevelThree</div>
<div class="line">           , repeats=False</div>
<div class="line">           , symbols[Group1] = [ISO_Level3_Shift]</div>
<div class="line">           , actions[Group1] = [SetMods(modifiers=LevelThree)] };</div>
<div class="line">modifier_map Mod5  { &lt;LVL3&gt; };</div>
<div class="line">key &lt;RALT&gt; { repeat=False</div>
<div class="line">           , symbols[Group1] = [ISO_Level3_Shift]</div>
<div class="line">           , actions[Group1] = [SetMods(modifiers=LevelThree)]</div>
<div class="line">           , type[group1]=<span class="stringliteral">&quot;ONE_LEVEL&quot;</span> };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// FOUR_LEVEL key type example from latin symbols</span></div>
<div class="line">key &lt;AB05&gt; {[b, B, leftdoublequotemark, leftsinglequotemark]};</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="key-actions"></a>
Key actions</h1>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo</a></b></dt><dd>list of all actions and their parameters</dd></dl>
<p>The following table provide an overview of the available actions:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Category   </th><th class="markdownTableHeadNone">Action   </th><th class="markdownTableHeadNone">Alias   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>NoAction</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Do nothing.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="3"><a class="el" href="#modifiers-actions">Modifier action</a>   </td><td class="markdownTableBodyNone"><code>SetMods</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em>depressed</em> modifiers    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LatchMods</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em>latched</em> modifiers    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LockMods</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Modifies the <em>locked</em> modifiers    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="3"><a class="el" href="#group-actions">Group action</a>   </td><td class="markdownTableBodyNone"><code>SetGroup</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LatchGroup</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LockGroup</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="9"><a class="el" href="#legacy-actions">Legacy action</a>   </td><td class="markdownTableBodyNone"><code>MovePointer</code>   </td><td class="markdownTableBodyNone"><code>MovePtr</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>PointerButton</code>   </td><td class="markdownTableBodyNone"><code>PtrBtn</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LockPointerButton</code>   </td><td class="markdownTableBodyNone"><code>LockPtrBtn</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SetPointerDefault</code>   </td><td class="markdownTableBodyNone"><code>SetPtrDflt</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SetControls</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LockControls</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>TerminateServer</code>   </td><td class="markdownTableBodyNone"><code>Terminate</code>   </td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SwitchScreen</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><span class="todo">TODO</span>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Private</code>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><span class="todo">TODO</span>   </td></tr>
</table>
<p>Common syntax:</p><ul>
<li>Boolean values:<ul>
<li><code>true</code>, <code>yes</code>, <code>on</code></li>
<li><code>false</code>, <code>no</code>, <code>off</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="modifiers-actions"></a>
Modifiers actions</h2>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo</a></b></dt><dd>default values</dd></dl>
<p>There are 3 modifiers actions:</p>
<dl>
<dt><code>SetMods</code> </dt>
<dd><p class="startdd">Modifies the <em>depressed</em> modifiers.</p>
<p class="enddd">Parameters:</p><ul>
<li><code>modifiers</code> or <code>mods</code>: the list of modifiers to modify, separated by <code>+</code>, or the special value <code>modMapMods</code>. The latter means the parameter value has to be read from the <code>vmodmap</code> attribute of the key.</li>
<li><code>clearLocks</code>: boolean (see its use hereinafter). </li>
</ul>
</dd>
<dt><code>LatchMods</code> </dt>
<dd><p class="startdd">Modifies the <em>latched</em> modifiers</p>
<p class="enddd">Parameters:</p><ul>
<li><code>modifiers</code> or <code>mods</code>: see <code>SetMods</code>.</li>
<li><code>clearLocks</code>: boolean (see its use hereinafter).</li>
<li><code>latchToLock</code>: boolean (see its use hereinafter). </li>
</ul>
</dd>
<dt><code>LockMods</code> </dt>
<dd><p class="startdd">Modifies the <em>locked</em> modifiers.</p>
<p class="enddd">Parameters:</p><ul>
<li><code>modifiers</code> or <code>mods</code>: see <code>SetMods</code>.</li>
<li><code>affect</code>:<ul>
<li><code>lock</code>: the action only locks the modifier, but cannot unlock it.</li>
<li><code>unlock</code>: the action only unlocks modifier, but cannot lock it.</li>
<li><code>both</code>: the first key press locks the modifier and the second key press releases the modifier. It is a default mode.</li>
<li><code>neither</code>: do not lock nor unlock, i.e. do nothing. </li>
</ul>
</li>
</ul>
</dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo</a></b></dt><dd>highlight that there is reference counting for the modifiers, e.g. to manage multiple physical keys for the same modifier.</dd></dl>
<p>These actions perform different tasks on key press and on key release:</p>
<table class="doxtable">
<caption>Effects of modifiers actions </caption>
<tr>
<th>Action </th><th>On key press </th><th><p class="starttd">On key release </p>
<p class="endtd"></p>
</th></tr>
<tr>
<th><code>SetMods</code> </th><td><ul>
<li>
Adds modifiers to <em>depressed</em> modifiers </li>
</ul>
</td><td><ul>
<li>
Removes modifiers from <em>depressed</em> modifiers, provided that no other key which affects the same modifiers is logically down.  </li>
<li>
If <code>clearLocks=yes</code> and no other key were operated simultaneously with this key, then the modifiers will be removed as well from the <em>locked</em> modifiers.  </li>
</ul>
</td></tr>
<tr>
<th><code>LatchMods</code> </th><td><ul>
<li>
Adds modifiers to <em>latched</em> modifiers. </li>
</ul>
</td><td><ul>
<li>
Removes modifiers from <em>latched</em> modifiers. </li>
<li>
If <code>clearLocks=yes</code> and no other key has been pressed since this key press, then the modifiers will be removed as well from the <em>locked</em> modifiers.  </li>
<li>
If <code>latchToLock=yes</code> then the modifiers are added to the <em>locked</em> modifiers.  </li>
</ul>
</td></tr>
<tr>
<th><code>LockMods</code>  </th><td><ul>
<li>
Adds modifiers to <em>depressed</em> modifiers. </li>
<li>
Toggle these modifiers in <em>locked</em> modifiers.  </li>
</ul>
</td><td><ul>
<li>
Removes modifiers from <em>depressed</em> modifiers. </li>
<li>
<em>Locked</em> modifiers stay unchanged. </li>
</ul>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo</a></b></dt><dd>Finish</dd></dl>
<h2><a class="anchor" id="group-actions"></a>
Group actions</h2>
<p>There are 3 group actions:</p>
<dl>
<dt>SetGroup </dt>
<dd><span class="todo">TODO</span>  </dd>
<dt>LatchGroup </dt>
<dd><span class="todo">TODO</span>  </dd>
<dt>LockGroup </dt>
<dd><span class="todo">TODO</span>  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo</a></b></dt><dd>Describe each action</dd></dl>
<h2><a class="anchor" id="legacy-actions"></a>
Unsupported legacy actions</h2>
<dl class="section attention"><dt>Attention</dt><dd>The following legacy actions are kept for compatibility only: they are parsed and validated but have no effect. This allows to use keymaps defined in <code><a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a></code> for both X11 and Wayland.</dd></dl>
<h3><a class="anchor" id="pointer-actions"></a>
Pointer actions</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Action   </th><th class="markdownTableHeadNone">Alias   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>MovePointer</code>   </td><td class="markdownTableBodyNone"><code>MovePtr</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>PointerButton</code>   </td><td class="markdownTableBodyNone"><code>PtrBtn</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LockPtrButton</code>   </td><td class="markdownTableBodyNone"><code>LockPtrBtn</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LockPointerButton</code>   </td><td class="markdownTableBodyNone"><code>LockPointerBtn</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SetPointerDefault</code>   </td><td class="markdownTableBodyNone"><code>SetPtrDflt</code>   </td><td class="markdownTableBodyNone"></td></tr>
</table>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo</a></b></dt><dd>Describe each action</dd></dl>
<h3><a class="anchor" id="control-flags-actions"></a>
Control flags actions</h3>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo</a></b></dt><dd><code>SetControls</code>, <code>LockControls</code></dd></dl>
<h3><a class="anchor" id="server-actions"></a>
Server actions</h3>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo</a></b></dt><dd><code>TerminateServer</code>, <code>SwitchScreen</code></dd></dl>
<h3><a class="anchor" id="private-action"></a>
Private action</h3>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo</a></b></dt><dd><code>Private</code> </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
