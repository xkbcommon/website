<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libxkbcommon: Release notes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libxkbcommon<span id="projectnumber">&#160;1.12.2</span>
   </div>
   <div id="projectbrief">Library implementing the XKB specification for parsing                           keyboard descriptions and handling keyboard state</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Release notes </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#libxkbcommon-1122--2025-10-20">libxkbcommon 1.12.2 – 2025-10-20 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-1121--2025-10-17">libxkbcommon 1.12.1 – 2025-10-17 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-1120--2025-10-10">libxkbcommon 1.12.0 – 2025-10-10 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-1110--2025-08-08">libxkbcommon 1.11.0 – 2025-08-08 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-1100--2025-05-21">libxkbcommon 1.10.0 – 2025-05-21 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-192--2025-05-07">libxkbcommon 1.9.2 – 2025-05-07 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-191--2025-05-02">libxkbcommon 1.9.1 – 2025-05-02 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-190--2025-04-26">libxkbcommon 1.9.0 – 2025-04-26 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-181--2025-03-12">libxkbcommon 1.8.1 – 2025-03-12 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-180--2025-02-04">libxkbcommon 1.8.0 – 2025-02-04 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-170--2024-03-24">libxkbcommon 1.7.0 – 2024-03-24 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-160--2023-10-08">libxkbcommon 1.6.0 – 2023-10-08 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-150--2023-01-02">libxkbcommon 1.5.0 – 2023-01-02 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-141--2022-05-21">libxkbcommon 1.4.1 – 2022-05-21 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-140--2022-02-04">libxkbcommon 1.4.0 – 2022-02-04 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-131--2021-09-10">libxkbcommon 1.3.1 – 2021-09-10 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-130--2021-05-01">libxkbcommon 1.3.0 – 2021-05-01 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-121--2021-04-07">libxkbcommon 1.2.1 – 2021-04-07 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-120--2021-04-03">libxkbcommon 1.2.0 – 2021-04-03 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-110--2021-02-27">libxkbcommon 1.1.0 – 2021-02-27 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-103--2020-11-23">libxkbcommon 1.0.3 – 2020-11-23 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-102--2020-11-20">libxkbcommon 1.0.2 – 2020-11-20 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-101--2020-09-11">libxkbcommon 1.0.1 – 2020-09-11 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-100--2020-09-05">libxkbcommon 1.0.0 – 2020-09-05 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-0100--2020-01-18">libxkbcommon 0.10.0 – 2020-01-18 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-091--2019-10-19">libxkbcommon 0.9.1 – 2019-10-19 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-090--2019-10-19">libxkbcommon 0.9.0 – 2019-10-19 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-084--2019-02-22">libxkbcommon 0.8.4 – 2019-02-22 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-083--2019-02-08">libxkbcommon 0.8.3 – 2019-02-08 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-082--2018-08-05">libxkbcommon 0.8.2 – 2018-08-05 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-081--2018-08-03">libxkbcommon 0.8.1 – 2018-08-03 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-080--2017-12-15">libxkbcommon 0.8.0 – 2017-12-15 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-072--2017-08-04">libxkbcommon 0.7.2 – 2017-08-04 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-071--2017-01-18">libxkbcommon 0.7.1 – 2017-01-18 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-070--2016-11-11">libxkbcommon 0.7.0 – 2016-11-11 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-061--2016-04-08">libxkbcommon 0.6.1 – 2016-04-08 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-060--2016-03-16">libxkbcommon 0.6.0 – 2016-03-16 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-050--2014-10-18">libxkbcommon 0.5.0 – 2014-10-18 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-043--2014-08-19">libxkbcommon 0.4.3 – 2014-08-19 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-042--2014-05-15">libxkbcommon 0.4.2 – 2014-05-15 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-041--2014-03-27">libxkbcommon 0.4.1 – 2014-03-27 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-040--2014-02-02">libxkbcommon 0.4.0 – 2014-02-02 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-032--2013-11-22">libxkbcommon 0.3.2 – 2013-11-22 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-031--2013-06-03">libxkbcommon 0.3.1 – 2013-06-03 </a>
  </li>
  <li class="level1">
    <a href="#libxkbcommon-030--2013-04-01">libxkbcommon 0.3.0 – 2013-04-01 </a>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_2release-notes"></a></p>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-1122--2025-10-20"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.12.2">1.12.2</a> – 2025-10-20</h1>
<h2 class="doxsection"><a class="anchor" id="api-3"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="fixes"></a>
Fixes</h3>
<ul>
<li><p class="startli">Context: Added fallback to the legacy X11 path for misconfigured setups where the canonical XKB root is not available.</p>
<p class="startli">Some setups use the assumption that the canonical XKB root is always the legacy X11 one, but this is no longer true since <a href="https://xkeyboard-config.freedesktop.org/blog/2-45-release/#build-system">xkeyboard-config 2.45</a>, where the X11 path is now a mere symlink to a dedicated xkeyboard-config data directory (usually <span class="tt">/usr/share/xkeyboard-config-2</span>).</p>
</li>
<li>Compose: Fixed some C standard libraries such as musl not detecting missing locales. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/879">#879</a>)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-1121--2025-10-17"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.12.1">1.12.1</a> – 2025-10-17</h1>
<h2 class="doxsection"><a class="anchor" id="api-4"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="fixes-1"></a>
Fixes</h3>
<ul>
<li>X11: Added a fix to circumvent libX11 and xserver improperly handling missing XKB canonical key types. The fix prevents triggering an error when retrieving such keymap using libxkbcommon-x11.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-1"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="fixes-2"></a>
Fixes</h3>
<ul>
<li><p class="startli"><span class="tt">xkbcli interactive-wayland</span>: memory error triggering in some setups.</p>
<p class="startli">Contributed by Jan Alexander Steffens</p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-1120--2025-10-10"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.12.0">1.12.0</a> – 2025-10-10</h1>
<p>The highlight of this release is the performance improvements for keymap handling:</p><ul>
<li>about 1.6× speedup at <em>serializing</em> with default options;</li>
<li>about 1.7× speedup at <em>parsing</em> keymaps serialized by libxkbcommon, otherwise at least 1.1×.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="api-5"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes"></a>
Breaking changes</h3>
<ul>
<li><span class="tt"><a class="el" href="group__keymap.html#gad41304fe0b54e1cc5739b12a4796396b" title="Get the compiled keymap as a string.">xkb_keymap::xkb_keymap_get_as_string()</a></span> does not pretty-print the keymap anymore. Use <span class="tt"><a class="el" href="group__keymap.html#gadb909827cba2a5ad0913e2c23db402ee" title="Get the compiled keymap as a string.">xkb_keymap::xkb_keymap_get_as_string2()</a></span> with <span class="tt"><a class="el" href="group__keymap.html#gga4701abb896607d318254bcd26c7905aca9bced62f03866bb33ad1584c0a9e43da" title="Enable pretty-printing.">XKB_KEYMAP_SERIALIZE_PRETTY</a></span> to get the previous behavior. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/640">#640</a>)</li>
<li><span class="tt"><a class="el" href="group__keymap.html#gad41304fe0b54e1cc5739b12a4796396b" title="Get the compiled keymap as a string.">xkb_keymap::xkb_keymap_get_as_string()</a></span> does not serialize <em>unused</em> types and compatibility entries anymore. Use <span class="tt"><a class="el" href="group__keymap.html#gadb909827cba2a5ad0913e2c23db402ee" title="Get the compiled keymap as a string.">xkb_keymap::xkb_keymap_get_as_string2()</a></span> with <span class="tt"><a class="el" href="group__keymap.html#gga4701abb896607d318254bcd26c7905aca37962ae86aa09ece064d75c34c12fc7d" title="Do not drop unused bits (key types, compatibility entries).">XKB_KEYMAP_SERIALIZE_KEEP_UNUSED</a></span> to get the previous behavior. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/769">#769</a>)</li>
<li>Updated keysyms case mappings to cover full <b><a href="https://www.unicode.org/versions/Unicode17.0.0/">Unicode 17.0</a></b>.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="deprecated"></a>
Deprecated</h3>
<ul>
<li>Deprecated keysyms from latest <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto">xorgproto</a> (commit: <span class="tt">81931cc0fd4761b42603f7da7d4f50fc282cecc6</span>, <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/103">xorproto-103</a>):<ul>
<li><span class="tt">XKB_KEY_XF86BrightnessAuto</span> (use <span class="tt">XKB_KEY_XF86MonBrightnessAuto</span> instead)</li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="new"></a>
New</h3>
<ul>
<li>Added <span class="tt"><a class="el" href="group__keymap.html#gadb909827cba2a5ad0913e2c23db402ee" title="Get the compiled keymap as a string.">xkb_keymap::xkb_keymap_get_as_string2()</a></span>, which enables to configure the serialization.</li>
<li>Added keysyms from latest <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto">xorgproto</a> (commit: <span class="tt">81931cc0fd4761b42603f7da7d4f50fc282cecc6</span>, <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/103">xorproto-103</a>):<ul>
<li><span class="tt">XKB_KEY_XF86Sport</span></li>
<li><span class="tt">XKB_KEY_XF86MonBrightnessAuto</span> (alias for <span class="tt">XKB_KEY_XF86BrightnessAuto</span>)</li>
<li><span class="tt">XKB_KEY_XF86LinkPhone</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F1</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F2</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F3</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F4</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F5</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F6</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F7</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F8</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F9</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F10</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F11</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F12</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_1</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_2</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_D</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_E</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_F</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_S</span></li>
<li><span class="tt">XKB_KEY_XF86Fn_B</span></li>
<li><span class="tt">XKB_KEY_XF86PerformanceMode</span></li>
</ul>
</li>
<li>Enable to parse the full range of keycodes <span class="tt">0 .. 0xfffffffe</span>, which was previously limited to <span class="tt">0 .. 0xfff</span>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/849">#849</a>)</li>
<li>Compose: Custom locales now fallback to <span class="tt">en_US.UTF-8</span>. Custom locales requiring a dedicated Compose file are not yet supported. The workaround is to use the various ways to <a class="el" href="group__compose.html#ga69376b0303c6ac0c17468e0c215a872e">specify a user Compose file</a>.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-2"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="new-1"></a>
New</h3>
<ul>
<li><span class="tt">xkbcli {compile-keymap,dump-keymap*}</span>: Added <span class="tt">--no-pretty</span> to disable pretty-printing in keymap serialization. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/640">#640</a>)</li>
<li><span class="tt">xkbcli {compile-keymap,dump-keymap*}</span>: Added <span class="tt">--keep-unused</span> to not discard unused bit for keymap serialization. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/769">#769</a>)</li>
<li><span class="tt">xkbcli-compile-keymap</span>: Added <span class="tt">--kccgst-yaml</span> to output KcCGST components in YAML format.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="build-system"></a>
Build system</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-1"></a>
Breaking changes</h3>
<ul>
<li>The <em>default</em> XKB root directory is now set from the <em>most recent</em> <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> installed package, in case <a href="https://xkeyboard-config.freedesktop.org/doc/versioning/">multiple versions</a> are installed in parallel. If no such package is found, it fallbacks to the historical X11 directory, as previously.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-1110--2025-08-08"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.11.0">1.11.0</a> – 2025-08-08</h1>
<p>The highlight of this release is the introduction of a new keymap text format, <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>, in order to fix decade-old issues inherited from the X11 ecosystem. See the API section for documentation of its use.</p>
<h2 class="doxsection"><a class="anchor" id="keymap-text-format-1"></a>
Keymap text format</h2>
<h3 class="doxsection"><a class="anchor" id="new-2"></a>
New</h3>
<p>A new keymap text format <b>v2</b> has been introduced as a superset of the legacy <b>v1</b> format. The format is not yet frozen and considered a living standard, although future iterations should be backward-compatible. See the <a href="https://xkbcommon.org/doc/current/xkbcommon-compatibility.html">compatibility page</a> for detailed information of the features of each format.</p>
<ul>
<li><p class="startli">Added the new parameter <span class="tt">lockOnRelease</span> for the key action <span class="tt">LockGroup()</span> (<a href="https://github.com/xkbcommon/libxkbcommon/issues/420">#420</a>).</p>
<p class="startli">It enables to use e.g. the combination <span class="tt">Alt + Shift</span> <em>alone</em> to switch layouts, while keeping the use of <span class="tt">Alt + Shift + other key</span> (typically for keyboard shortcuts).</p>
<p class="startli">It enables to fix a <a href="https://gitlab.freedesktop.org/xorg/xserver/-/issues/258">20-year old issue</a> inherited from the X11 ecosystem, by extending the <a href="https://www.x.org/releases/current/doc/kbproto/xkbproto.html#Key_Actions">XKB protocol key actions</a>.</p>
<p class="startli">As it is incompatible with X11, this feature is available only using <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>.</p>
</li>
<li><p class="startli">Added the new parameter <span class="tt">unlockOnPress</span> for the key modifier action <span class="tt">SetMods()</span>, <span class="tt">LatchMods()</span> and <span class="tt">LockMods()</span> (<a href="https://github.com/xkbcommon/libxkbcommon/issues/372">#372</a> and <a href="https://github.com/xkbcommon/libxkbcommon/issues/780">#780</a>).</p>
<p class="startli">It enables e.g. to deactivate <span class="tt">CapsLock</span> <em>on press</em> rather than on release, as in other platforms such as Windows.</p>
<p class="startli">It enables to fix the following two issues inherited from the X11 ecosystem, by extending the <a href="https://www.x.org/releases/current/doc/kbproto/xkbproto.html#Key_Actions">XKB protocol key actions</a>:</p><ul>
<li>a <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/issues/74">18-year old issue</a>;</li>
<li>a <a href="https://gitlab.freedesktop.org/xorg/xserver/-/issues/312">12-year old issue</a>.</li>
</ul>
<p class="startli">As it is incompatible with X11, this feature is available only using <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>.</p>
</li>
<li><p class="startli">Added the new parameter <span class="tt">latchOnPress</span> for the key action <span class="tt">LatchMods()</span>.</p>
<p class="startli">Some keyboard layouts use <span class="tt">ISO_Level3_Latch</span> or <span class="tt">ISO_Level5_Latch</span> to define “built-in” dead keys. <span class="tt">latchOnPress</span> enables to behave as usual dead keys, i.e. to latch on press and to deactivate as soon as another (non-modifier) key is pressed.</p>
<p class="startli">As it is incompatible with X11, this feature is available only using <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>.</p>
</li>
<li><p class="startli">Raised the layout count limit from 4 to 32. Requires using <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/37">#37</a>)</p>
<p class="startli">It enables to fix a <a href="https://gitlab.freedesktop.org/xorg/xserver/-/issues/262">16-year old issue</a> inherited from the X11 ecosystem.</p>
</li>
<li><p class="startli">Virtual modifiers are now mapped to their <em><a href="https://xkbcommon.org/doc/current/keymap-text-format-v1-v2.html#canonical-and-non-canonical-modifiers">canonical encoding</a></em> if they are not mapped <em>explicitly</em> (<span class="tt">virtual_modifiers M = …</span>) nor <em>implicitly</em> (using <span class="tt">modifier_map</span>/<span class="tt">virtualModifier</span>).</p>
<p class="startli">This feature is enabled only when using <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>, as it may result in encodings not compatible with X11.</p>
</li>
<li>Added support for the constants <span class="tt">Level&lt;INDEX&gt;</span> for <em>any</em> valid level index, instead of the previous limited range <span class="tt">Level1</span>..<span class="tt">Level8</span>.</li>
<li>Enable to use absolute paths and <span class="tt">%</span>-expansion variables for including <em>keymap components</em>, in the same fashion than the <em>rules</em> files.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="rules-text-format"></a>
Rules text format</h2>
<h3 class="doxsection"><a class="anchor" id="new-3"></a>
New</h3>
<ul>
<li>Added support for <em>layout-specific options</em>. It enables specifying a layout index for each option by appending <span class="tt">!</span> + 1-indexed layout, so that it applies only if the layout matches. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/500">#500</a>)</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="api-6"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-2"></a>
Breaking changes</h3>
<ul>
<li><span class="tt">xkb_keymap_new_from_names()</span> now uses the new keymap format <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>.</li>
<li>When using <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3ad63ee709a87611a89b42c3e1275347ed" title="The classic XKB text format, as generated by xkbcomp -xkb.">XKB_KEYMAP_FORMAT_TEXT_V1</a></span>, multiple actions per level are now serialized using <span class="tt">VoidAction()</span>, in order to maintain compatibility with X11. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/793">#793</a>)</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="deprecated-1"></a>
Deprecated</h3>
<ul>
<li><span class="tt">xkb_keymap_new_from_names()</span> is now deprecated; please use <span class="tt">xkb_keymap_new_from_names2()</span> instead with an explicit keymap format.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="new-4"></a>
New</h3>
<ul>
<li><p class="startli">Added the new keymap format <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>, which enables libxkbcommon’s extensions incompatible with X11.</p>
<p class="startli">Note that <em>fallback</em> mechanisms ensure that it is possible to parse using one format and serialize using another.</p>
<p class="startli"><b>Wayland compositors</b> may use the new format to <em>parse</em> keymaps, but they <em>must</em> use the previous format <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3ad63ee709a87611a89b42c3e1275347ed" title="The classic XKB text format, as generated by xkbcomp -xkb.">XKB_KEYMAP_FORMAT_TEXT_V1</a></span> whenever <em>serializing</em> for interchange. Since almost features available only in the v2 format deal with state handling which is managed in the server, clients should not be affected by a v2-to-v1 conversion.</p>
<p class="startli"><b>Client applications</b> should use the previous <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3ad63ee709a87611a89b42c3e1275347ed" title="The classic XKB text format, as generated by xkbcomp -xkb.">XKB_KEYMAP_FORMAT_TEXT_V1</a></span> to parse keymaps, at least for now. They may use <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span> only if used with a Wayland compositor using the same version of libxkbcommon <em>and</em> serializing to the new format. This precaution will be necessary until the new format is stabilized.</p>
</li>
<li>Added <span class="tt">xkb_keymap_new_from_names2()</span> as an alternative to <span class="tt">xkb_keymap_new_from_names()</span>, which is deprecated.</li>
<li>Added <span class="tt">xkb_keymap_new_from_rmlvo()</span> to compile a keymap using the new RMLVO builder API.</li>
<li>Added a API to safely build a RMLVO configuration:<ul>
<li><span class="tt">xkb_rmlvo_builder_new()</span></li>
<li><span class="tt">xkb_rmlvo_builder_append_layout()</span></li>
<li><span class="tt">xkb_rmlvo_builder_append_option()</span></li>
<li><span class="tt">xkb_rmlvo_builder_ref()</span></li>
<li><span class="tt">xkb_rmlvo_builder_unref()</span></li>
</ul>
</li>
<li>Added <span class="tt">xkb_keymap_mod_get_mask2()</span> to query the mapping of a modifier by its index rather than it name.</li>
<li><p class="startli">Update keysyms using latest <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto">xorgproto</a> (commit: <span class="tt">ce7786ebb90f70897f8038d02ae187ab22766ab2</span>).</p>
<p class="startli">Additions (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/93">xorgproto-93</a>):</p><ul>
<li><span class="tt">XKB_KEY_XF86MediaSelectCD</span> (alias for <span class="tt">XKB_KEY_XF86CD</span>)</li>
<li><span class="tt">XKB_KEY_XF86OK</span></li>
<li><span class="tt">XKB_KEY_XF86GoTo</span></li>
<li><span class="tt">XKB_KEY_XF86VendorLogo</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectProgramGuide</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectHome</span></li>
<li><span class="tt">XKB_KEY_XF86MediaLanguageMenu</span></li>
<li><span class="tt">XKB_KEY_XF86MediaTitleMenu</span></li>
<li><span class="tt">XKB_KEY_XF86AudioChannelMode</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectPC</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectTV</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectCable</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectVCR</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectVCRPlus</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectSatellite</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectTape</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectRadio</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectTuner</span></li>
<li><span class="tt">XKB_KEY_XF86MediaPlayer</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectTeletext</span></li>
<li><span class="tt">XKB_KEY_XF86MediaSelectDVD</span> (alias for <span class="tt">XKB_KEY_XF86DVD</span>)</li>
<li><span class="tt">XKB_KEY_XF86MediaSelectAuxiliary</span></li>
<li><span class="tt">XKB_KEY_XF86MediaPlaySlow</span></li>
<li><span class="tt">XKB_KEY_XF86NumberEntryMode</span></li>
</ul>
</li>
<li>Registry: added <span class="tt"><a class="el" href="group__registry.html#ga5b784f59352341bda4b99696bf692997" title="Return true if the given option accepts layout index specifiers to restrict its application to the co...">rxkb_option_is_layout_specific()</a></span> to query if an option accepts layout index specifiers to restrict its application to the corresponding layouts. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/500">#500</a>)</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-3"></a>
Fixes</h3>
<ul>
<li>Fixed incorrect implementation of <span class="tt">latchToLock</span> for <span class="tt">LatchMods()</span>, which could result in unintended <span class="tt">CapsLock</span> unlock. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/808">#808</a>)</li>
<li>Fixed <span class="tt"><a class="el" href="group__keysyms.html#ga5fde9cc397ae996b4efac56c9cd6bd18" title="Get the keysym corresponding to a Unicode/UTF-32 codepoint.">xkb_utf32_to_keysym()</a></span> returning deprecated keysyms for some Unicode code points.</li>
<li>Fixed breaking a latch not honoring <span class="tt">clearLocks=no</span>.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-3"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-3"></a>
Breaking changes</h3>
<ul>
<li><p class="startli">The tools now use:</p><ul>
<li><span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span> as a default <em>input</em> format.</li>
<li><span class="tt"><a class="el" href="group__keymap.html#ga95e4461eb947cc61c3574ee4f0d24fb6" title="Get the keymap as a string in the format from which it was created.">XKB_KEYMAP_USE_ORIGINAL_FORMAT</a></span> as a default <em>output</em> format. So if the input format is not specified, it will resolve to <span class="tt"><a class="el" href="group__keymap.html#ggab0f75d6cc5773e5dd404e2c3f61366a3a3a8d8e0c27ea5b4dc56a30b973ce6402" title="Xkbcommon extensions of the classic XKB text format, incompatible with X11.">XKB_KEYMAP_FORMAT_TEXT_V2</a></span>.</li>
</ul>
<p class="startli">The formats can be explicitly specified using the new <span class="tt">--*format</span> options.</p>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="new-5"></a>
New</h3>
<ul>
<li>Added <span class="tt">--*format</span> options to various tools for specifying and explicit keymap format for parsing and serializing.</li>
<li>Added commands that automatically select the appropriate backend:<ul>
<li><span class="tt">xkbcli interactive</span>: try Wayland, X11 then fallback to the evdev backend.</li>
<li><span class="tt">xkbcli dump-keymap</span>: try Wayland then fallback to the X11 backend.</li>
</ul>
</li>
<li>Improved <span class="tt">xkbcli interactive-*</span>:<ul>
<li>Print key release events.</li>
<li>Print detailed state change events.</li>
<li>Added <span class="tt">--uniline</span> to enable uniline event output (default).</li>
<li>Added <span class="tt">--multiline</span> to enable multiline event output, which provides more details than the uniline mode.</li>
<li>Wayland and X11: Added <span class="tt">--local-state</span> to enable handling the keyboard state with a local state machine instead of the display server. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/832">#832</a>)</li>
<li>Wayland and X11: Added <span class="tt">--<a class="el" href="group__keymap.html" title="Creating and destroying keymaps.">Keymap Creation</a></span> to enable to use a custom keymap instead of the keymap from the display server. Implies <span class="tt">--local-state</span>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/833">#833</a>)</li>
</ul>
</li>
<li><span class="tt">xkbcli how-to-type</span>: Added <span class="tt">--<a class="el" href="group__keymap.html" title="Creating and destroying keymaps.">Keymap Creation</a></span> to enable loading the keymap from a file or stdin instead of resolving RMLVO names.</li>
<li><span class="tt">xkbcli how-to-type</span>: Added Compose support, enabled by default and disabled using <span class="tt">--disable-compose</span>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/361">#361</a>)</li>
<li><span class="tt">xkbcli-list</span>: Added <span class="tt">layout-specific</span> field for options. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/500">#500</a>)</li>
<li>Added <span class="tt">--verbose</span> to various tools, so that all tools have the option. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/833">#833</a>)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-1100--2025-05-21"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.10.0">1.10.0</a> – 2025-05-21</h1>
<h2 class="doxsection"><a class="anchor" id="api-7"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-4"></a>
Breaking changes</h3>
<ul>
<li><em>Modifiers masks</em> handling has been refactored to properly handle virtual modifiers. Modifier masks are now always considered as an <em>opaque encoding</em> of the modifiers state:<ul>
<li>Modifiers masks should not be interpreted by other means than the provided API. In particular, one should not assume that modifiers masks always denote the modifiers <em>indices</em> of the keymap.</li>
<li>It enables using virtual modifiers with arbitrary mappings. E.g. one can now reliably create virtual modifiers without relying on the legacy X11 mechanism, that requires a careful use of keys’ real and virtual modmaps.</li>
<li>It enables <em>interoperability</em> with further implementations of XKB.</li>
</ul>
</li>
<li><p class="startli">Changed <em>Compose</em> behavior so that sequences defined later always override ones defined earlier, even if the new sequence is shorter.</p>
<p class="startli">Contributed by Jules Bertholet</p>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="deprecated-2"></a>
Deprecated</h3>
<ul>
<li>Server applications using <span class="tt">xkb_state_update_mask()</span> should migrate to using <span class="tt">xkb_state_update_latched_locked()</span> instead, for proper handling of the keyboard state. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/310">#310</a>)</li>
<li><p class="startli">The following modifiers names in <span class="tt"><a class="el" href="xkbcommon-names_8h.html" title="Predefined names for common modifiers and LEDs.">xkbcommon/xkbcommon-names.h</a></span> are now deprecated and will be removed in a future version:</p><ul>
<li><span class="tt"><a class="el" href="group__legacy-virtual-modifier-names.html#ga0d90db2803640168b5a2550e6ca517a3" title="Usual real modifier for the virtual modifier Alt.">XKB_MOD_NAME_ALT</a></span>: use <span class="tt"><a class="el" href="group__virtual-modifier-names.html#gadfe1a2b7808fbe3e93ab5e4d4922912c">XKB_VMOD_NAME_ALT</a></span> instead.</li>
<li><span class="tt"><a class="el" href="group__legacy-virtual-modifier-names.html#ga7efda533574bf2db15fc2e0d906704dd" title="Usual real modifier for the virtual modifier Super.">XKB_MOD_NAME_LOGO</a></span>: use <span class="tt"><a class="el" href="group__virtual-modifier-names.html#gad93af5e24b8fe28a5fffc11f2cc39eb8">XKB_VMOD_NAME_SUPER</a></span> instead.</li>
<li><span class="tt"><a class="el" href="group__legacy-virtual-modifier-names.html#ga2b462af975ff990368ca7119d6ae8cd8" title="Usual real modifier for the virtual modifier NumLock.">XKB_MOD_NAME_NUM</a></span>: use <span class="tt"><a class="el" href="group__virtual-modifier-names.html#ga0cb38463b488ead8f43950b6c0e03fc2">XKB_VMOD_NAME_NUM</a></span> instead.</li>
</ul>
<p class="startli">(<a href="https://github.com/xkbcommon/libxkbcommon/issues/538">#538</a>)</p>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="new-6"></a>
New</h3>
<ul>
<li><p class="startli">Added <span class="tt">xkb_state_update_latched_locked()</span> to update the keyboard state to change the latched and locked state of the modifiers and layout.</p>
<p class="startli">This entry point is intended for <em>server</em> applications and should not be used by <em>client</em> applications. This can be use for e.g. a GUI layout switcher. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/310">#310</a>)</p>
</li>
<li>Added <span class="tt">xkb_keymap_mod_get_mask()</span> to query the mapping of a modifier.</li>
<li><p class="startli">Added <span class="tt">VoidAction()</span> action to match the keysym pair <span class="tt">NoSymbol</span>/<span class="tt">VoidSymbol</span>. It enables erasing a previous action and breaks latches.</p>
<p class="startli">This is a libxkbcommon extension. When serializing it will be converted to <span class="tt">LockControls(controls=none,affect=neither)</span> for backward compatibility. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/622">#622</a>)</p>
</li>
<li>Improved syntax errors in XKB files to include the expected/got tokens. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/644">#644</a>)</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-4"></a>
Fixes</h3>
<ul>
<li><em>Compose</em>: fixed sequence not fully overriden if the new sequence has no keysym or string.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-4"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="new-7"></a>
New</h3>
<ul>
<li><span class="tt">xkbcli-compile-keymap</span>: Added option <span class="tt">--modmaps</span> that prints modifiers mappings. This is similar to the legacy <span class="tt">xmodmap -pm</span>.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="build-system-1"></a>
Build system</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-5"></a>
Breaking changes</h3>
<ul>
<li>Removed support for byacc &ndash; use bison instead. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/644">#644</a>)</li>
<li>Required bison ≥ 3.6.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-192--2025-05-07"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.9.2">1.9.2</a> – 2025-05-07</h1>
<h2 class="doxsection"><a class="anchor" id="api-8"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="fixes-5"></a>
Fixes</h3>
<ul>
<li>Fixed empty compatibility interpretation statement not parsable by X11’s <span class="tt">xkbcomp</span>. This particularly affects Japanese layout <span class="tt">jp</span> when used with Xwayland. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/750">#750</a>)</li>
<li>Fixed empty compatibility interpretations map not parsable by X11’s <span class="tt">xkbcomp</span>.</li>
<li>Fixed key type map entries with a mix of bound and unbound modifiers not being ignored. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/758">#758</a>)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-191--2025-05-02"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.9.1">1.9.1</a> – 2025-05-02</h1>
<h2 class="doxsection"><a class="anchor" id="api-9"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="fixes-6"></a>
Fixes</h3>
<ul>
<li>X11: Fixed capitalization transformation not set properly, resulting in some keys (e.g. arrows, Home, etc.) not working when Caps Lock is on. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/740">#740</a>)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-190--2025-04-26"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.9.0">1.9.0</a> – 2025-04-26</h1>
<h2 class="doxsection"><a class="anchor" id="api-10"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-6"></a>
Breaking changes</h3>
<ul>
<li><em>Merge modes</em> and <em>include mechanism</em> were completely refactored to fix inconsistencies. Included files are now always processed in isolation and do not propagate the local merge modes. This makes the reasoning about included files much easier and consistent.</li>
<li><p class="startli">Trailing <span class="tt">NoSymbol</span> and <span class="tt">NoAction()</span> are now dropped. This may affect keys that rely on an <em>implicit</em> key type.</p>
<p class="startli">Example:</p><ul>
<li>Input: <div class="fragment"><div class="line">key &lt;&gt; { [a, A, NoSymbol] };</div>
</div><!-- fragment --></li>
<li>Compilation with libxkbcommon &lt; 1.9.0: <div class="fragment"><div class="line">key &lt;&gt; {</div>
<div class="line">  type= <span class="stringliteral">&quot;FOUR_LEVEL_SEMIALPHABETIC&quot;</span>,</div>
<div class="line">  [a, A, NoSymbol, NoSymbol]</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li>Compilation with libxkbcommon ≥ 1.9.0: <span class="tt">c
    key &lt;&gt; {
      type= "ALPHABETIC",
      [a, A]
    };
    </span></li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="new-8"></a>
New</h3>
<ul>
<li><p class="startli">Added function <span class="tt">xkb_components_names_from_rules()</span> to compute  <!-- -->
  <abbr title="Keycodes, Compatibility, Geometry, Symbols, Types">KcCGST</abbr>
  keymap components from
  <abbr title="Rules, Model, Layout, Variant, Options">RMLVO</abbr> names resolution.
  <!--! --></p>
<p class="startli">This mainly for <em>debugging</em> purposes and to enable the <span class="tt">--kccgst</span> option in the tools. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/669">#669</a>)</p>
</li>
<li>Added the following <em>wild cards</em> to the <b>rules</b> file syntax, in addition to the current <span class="tt">*</span> legacy wild card:<ul>
<li><span class="tt">&lt;none&gt;</span>: Match <em>empty</em> value.</li>
<li><span class="tt">&lt;some&gt;</span>: Match <em>non-empty</em> value.</li>
<li><span class="tt">&lt;any&gt;</span>: Match <em>any</em> (optionally empty) value. Its behavior does not depend on the context, contrary to the legacy wild card <span class="tt">*</span>.</li>
</ul>
</li>
<li>All keymap components are now optional, e.g. a keymap without a <span class="tt">xkb_types</span> section is now legal. The missing components will still be serialized explicitly in order to maintain backward compatibility.</li>
<li><p class="startli">Added support for further empty compound statements:</p><ul>
<li><span class="tt">xkb_types</span>: <span class="tt">type "xxx" {};</span></li>
<li><span class="tt">xkb_compat</span>: <span class="tt">interpret x {};</span> and <span class="tt">indicator "xxx" {};</span>.</li>
</ul>
<p class="startli">Such statements are initialized using the current defaults, i.e. the factory implicit defaults or some explicit custom defaults (e.g. <span class="tt">indicator.modifiers = Shift</span>).</p>
</li>
<li>Added support for actions and keysyms level list of length 0 and 1: respectively <span class="tt">{}</span> and <span class="tt">{a}</span>. Example: <span class="tt">key &lt;A&gt; { [{}, {a}, {a, A}] };</span>.</li>
<li>Enable using the merge mode <em>replace</em> in include statements using the prefix <span class="tt">^</span>, such as: <span class="tt">include "a^b"</span>. The main motivation is to enable this new syntax in <em>rules</em>, which previously could not handle this merge mode.</li>
<li>Added support for sequences of actions in <span class="tt">interpret</span> statements of the <span class="tt">xkb_compat</span> component, mirroring the syntax used in <span class="tt">xkb_symbols</span>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/695">#695</a>)</li>
<li>Added support for keysym Capitalization transformation to <span class="tt">xkb_state_key_get_syms()</span>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/552">#552</a>)</li>
<li><span class="tt"><a class="el" href="group__keysyms.html#ga5fde9cc397ae996b4efac56c9cd6bd18" title="Get the keysym corresponding to a Unicode/UTF-32 codepoint.">xkb_utf32_to_keysym</a></span>: Allow <a href="https://en.wikipedia.org/wiki/Universal_Character_Set_characters#Noncharacters">Unicode noncharacters</a>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/715">#715</a>)</li>
<li><p class="startli"><span class="tt"><a class="el" href="group__keysyms.html#gadf335e065050f306ff9094aefa6c9736" title="Get a keysym from its name.">xkb_keysym_from_name()</a></span>:</p><ul>
<li>Unicode format <span class="tt">UNNNN</span>: allow control characters C0 and C1 and use <span class="tt"><a class="el" href="group__keysyms.html#ga5fde9cc397ae996b4efac56c9cd6bd18" title="Get the keysym corresponding to a Unicode/UTF-32 codepoint.">xkb_utf32_to_keysym()</a></span> for the conversion when <span class="tt">NNNN &lt; 0x100</span>, for backward compatibility.</li>
<li>Numeric hexadecimal format <span class="tt">0xNNNN</span>: <em>unchanged</em>. Contrary to the Unicode format, it does not normalize any keysym values in order to enable roundtrip with <span class="tt"><a class="el" href="group__keysyms.html#ga2a06b575bfc0fef9655bb7f860737965" title="Get the name of a keysym.">xkb_keysym_get_name()</a></span>.</li>
</ul>
<p class="startli">(<a href="https://github.com/xkbcommon/libxkbcommon/issues/715">#715</a>)</p>
</li>
<li>Added <a href="https://en.wikipedia.org/wiki/Unicode#Codespace_and_code_points">Unicode code point</a> escape sequences <span class="tt">\u{NNNN}</span>. They are replaced with the <a href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a> encoding of their corresponding code point <span class="tt">U+NNNN</span>, if legal. Supported Unicode code points are in the range <span class="tt">1‥0x10ffff</span>. This is intended mainly for writing keysyms as <a href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a> encoded strings.</li>
<li>Enable to write keysyms as UTF-8-encoded strings:<ul>
<li><em>Single</em> Unicode code point <span class="tt">U+1F3BA</span> (TRUMPET) <span class="tt">"🎺"</span> is converted into a single keysym: <span class="tt">U1F3BA</span>.</li>
<li><em>Multiple</em> Unicode code points are converted to a keysym <em>list</em> where it is allowed (i.e. in key symbols). E.g. <span class="tt">"J́"</span> is converted to U+004A LATIN CAPITAL LETTER J plus U+0301 COMBINING ACUTE ACCENT: <span class="tt">{J, U0301}</span>.</li>
<li>An empty string <span class="tt">""</span> denotes the keysym <span class="tt">NoSymbol</span>.</li>
</ul>
</li>
<li>Enable displaying bidirectional text in XKB files using the following Unicode code points, wherever a white space can be used:<ul>
<li><span class="tt">U+200E</span> LEFT-TO-RIGHT MARK</li>
<li><span class="tt">U+200F</span> RIGHT-TO-LEFT MARK</li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-7"></a>
Fixes</h3>
<ul>
<li>Added support for <span class="tt">libxml2-2.14+</span>, which now disallows parsing trailing <span class="tt">NULL</span> bytes. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/692">#692</a>)</li>
<li><p class="startli">Fixed included <em>default</em> section not resolving to an <em>exact</em> match in some cases. It may occur if one creates a file name in a <em>user</em> XKB directory that also exists in the XKB <em>system</em> directory.</p>
<p class="startli">Example: if one creates a custom variant <span class="tt">my_variant</span> in the file <span class="tt">$XDG_CONFIG_HOME/xkb/symbols/us</span>, then <em>before</em> libxkbcommon 1.9.0 every statement loading the <em>default</em> map of the <span class="tt">us</span> file, <span class="tt">include "us"</span>, would wrongly resolve including <span class="tt">us(my_variant)</span> from the <em>user</em> configuration directory instead of <span class="tt">us(basic)</span> from the XKB <em>system</em> directory. Starting from libxkbcommon 1.9.0, <span class="tt">include "us"</span> would correctly resolve to the system file, unless <span class="tt">$XDG_CONFIG_HOME/xkb/symbols/us</span> contains an <em>explicit default</em> section. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/726">#726</a>)</p>
</li>
<li><p class="startli">Fixed floating-point number parsing failling on locales that use a decimal separator different than the period <span class="tt">.</span>.</p>
<p class="startli">Note that the issue is unlikely to happen even with such locales, unless <em>parsing</em> a keymap with a <em>geometry</em> component which contains floating-point numbers.</p>
<p class="startli">Affected API:</p><ul>
<li><span class="tt">xkb_keymap_new_from_file()</span>,</li>
<li><span class="tt">xkb_keymap_new_from_buffer()</span>,</li>
<li><span class="tt">xkb_keymap_new_from_string()</span>.</li>
</ul>
<p class="startli">Unaffected API:</p><ul>
<li><span class="tt">xkb_keymap_new_from_names()</span>: none of the components loaded use floating-point number. libxkbcommon does not load <em>geometry</em> files.</li>
<li><span class="tt">libxkbcommon-x11</span>: no such parsing is involved.</li>
</ul>
</li>
<li><p class="startli">Fixed the handling of empty keys. Previously keys with no symbols nor actions would simply be skipped entirely. E.g. in the following:</p>
<div class="fragment"><div class="line">key &lt;A&gt; { vmods = M };</div>
<div class="line">modifier_map Shift { &lt;A&gt; };</div>
</div><!-- fragment --><p class="startli">the key <span class="tt">&lt;A&gt;</span> would be skipped and the virtual modifier <span class="tt">M</span> would not be mapped to <span class="tt">Shift</span>. This is now handled properly.</p>
</li>
<li>Fixed characters not escaped properly in the keymap serialization, resulting in a keymap string with erroneous string literals and possible syntax errors.</li>
<li>Fixed octal escape sequences valid in Xorg’s xkbcomp but not in xkbcommon. Now up to <em>4</em> digits are parsed, compared to <em>3</em> previously.</li>
<li>Fixed the serialization of the <span class="tt">whichGroupState</span> indicator field.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-5"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="new-9"></a>
New</h3>
<ul>
<li><p class="startli"><span class="tt">xkbcli compile-keymap</span>: Added <span class="tt">--kccgst</span> option to display the result of  <!-- -->
  <abbr title="Rules, Model, Layout, Variant, Options">RMLVO</abbr>
  names resolution to
  <abbr title="Keycodes, Compatibility, Geometry, Symbols, Types">KcCGST</abbr>
  components.
  <!--! --></p>
<p class="startli">This option has the same function than <span class="tt">setxkbmap -print</span>. This is particularly useful for debugging issues with the rules. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/669">#669</a>)</p>
</li>
<li>Honor user locale in all tools.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-181--2025-03-12"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.8.1">1.8.1</a> – 2025-03-12</h1>
<h2 class="doxsection"><a class="anchor" id="api-11"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="fixes-8"></a>
Fixes</h3>
<ul>
<li><p class="startli">Fixed segfault due to invalid arithmetic to bring <em>negative</em> layout indices into range. It triggers with the following settings:</p><ul>
<li>layouts count (per key or total) N: <span class="tt">N &gt; 0</span>, and</li>
<li>layout index n: <span class="tt">n = - k * N</span> (<span class="tt">k &gt; 0</span>)</li>
</ul>
<p class="startli">Note that these settings are unlikely in usual use cases.</p>
</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-6"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-7"></a>
Breaking changes</h3>
<ul>
<li>The tools do not load the <em>default</em> RMLVO (rules, model, layout, variant, options) values from the environment anymore. The previous behavior may be restored by using the new <span class="tt">--enable-environment-names</span> option.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="build-system-2"></a>
Build system</h2>
<h3 class="doxsection"><a class="anchor" id="new-10"></a>
New</h3>
<ul>
<li>Source files are now annotated with SPDX short license identifiers. The LICENSE file was updated to accommodate this. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/628">#628</a>)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-180--2025-02-04"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.8.0">1.8.0</a> – 2025-02-04</h1>
<h2 class="doxsection"><a class="anchor" id="api-12"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-8"></a>
Breaking changes</h3>
<ul>
<li><p class="startli"><span class="tt">NoSymbol</span> is now systematically dropped in multi-keysyms levels:</p>
<div class="fragment"><div class="line"><span class="comment">// Before normalization</span></div>
<div class="line">key &lt;&gt; { [{NoSymbol}, {a, NoSymbol}, {NoSymbol,b}, {a, NoSymbol, b}] };</div>
<div class="line"><span class="comment">// After normalization</span></div>
<div class="line">key &lt;&gt; { [NoSymbol, a, b, {a, b}] };</div>
</div><!-- fragment --></li>
<li>Added the upper case mapping ß → ẞ (<span class="tt">ssharp</span> → <span class="tt">U1E9E</span>). This enable to type ẞ using CapsLock thanks to the internal capitalization rules.</li>
<li><p class="startli">Updated keysyms case mappings to cover full <b>[Unicode 16.0]</b>. This change provides a <em>consistent behavior</em> with respect to case mappings, and affects the following:</p><ul>
<li><p class="startli"><span class="tt"><a class="el" href="group__keysyms.html#gaf888d4d0f209222fe9c0b7b324fd90ca" title="Convert a keysym to its lowercase form.">xkb_keysym_to_lower()</a></span> and <span class="tt"><a class="el" href="group__keysyms.html#ga616148547139853f6f413c9c0720780d" title="Convert a keysym to its uppercase form.">xkb_keysym_to_upper()</a></span> give different output for keysyms not covered previously and handle <em>title</em>-cased keysyms.</p>
<p class="startli">Example of title-cased keysym: <span class="tt">U01F2</span> “ǲ”:</p><ul>
<li><span class="tt">xkb_keysym_to_lower(U01F2) == U01F3</span> “ǲ” → “ǳ”</li>
<li><span class="tt">xkb_keysym_to_upper(U01F2) == U01F1</span> “ǲ” → “Ǳ”</li>
</ul>
</li>
<li><em>Implicit</em> alphabetic key types are better detected, because they use the latest Unicode case mappings and now handle the <em>title</em>-cased keysyms the same way as upper-case ones.</li>
</ul>
<p class="startli">Note: There is a single <em>exception</em> that do not follow the Unicode mappings:</p><ul>
<li><span class="tt">xkb_keysym_to_upper(ssharp) == U1E9E</span> “ß” → “ẞ”</li>
</ul>
<p class="startli">Note: As before, only <em>simple</em> case mappings (i.e. one-to-one) are supported. For example, the full upper case of <span class="tt">U+01F0</span> “ǰ” is “J̌” (2 characters: <span class="tt">U+004A</span> and <span class="tt">U+030C</span>), which would require 2 keysyms, which is not supported by the current API.</p>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="new-11"></a>
New</h3>
<ul>
<li>Implemented the <span class="tt">GroupLatch</span> action, usually activated with the keysym <span class="tt">ISO_Group_Latch</span>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/455">#455</a>)</li>
<li><p class="startli">Symbols: Added support for <em>multiple actions per levels:</em></p><ul>
<li>When no action is specified, <span class="tt">interpret</span> statements are used to find an action corresponding to <em>each</em> keysym, as expected.</li>
<li>When both keysyms and actions are specified, they may have a different count for each level.</li>
<li><p class="startli">For now, at most one action of each of the following categories is allowed per level:</p><ul>
<li>modifier actions: <span class="tt">SetMods</span>, <span class="tt">LatchMods</span>, <span class="tt">LockMods</span>;</li>
<li>group actions: <span class="tt">SetGroup</span>, <span class="tt">LatchGroup</span>, <span class="tt">LockGroup</span>.</li>
</ul>
<p class="startli">Some examples:</p><ul>
<li><span class="tt">SetMods</span> + <span class="tt">SetGroup</span>: ok</li>
<li><span class="tt">SetMods</span> + <span class="tt">SetMods</span>: error</li>
<li><span class="tt">SetMods</span> + <span class="tt">LockMods</span>: error</li>
<li><span class="tt">SetMods</span> + <span class="tt">LockGroup</span>: ok</li>
</ul>
</li>
</ul>
<p class="startli">(<a href="https://github.com/xkbcommon/libxkbcommon/issues/486">#486</a>)</p>
</li>
<li><p class="startli">Updated keysyms using latest <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto">xorgproto</a> (commit: <span class="tt">d7ea44d5f04cc476dee83ef439a847172f7a6bd1</span>):</p>
<p class="startli">Additions:</p><ul>
<li><span class="tt">XKB_KEY_XF86RefreshRateToggle</span></li>
<li><span class="tt">XKB_KEY_XF86Accessibility</span></li>
<li><span class="tt">XKB_KEY_XF86DoNotDisturb</span></li>
</ul>
<p class="startli">Relevant upstream merge request: <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/91">xorgproto-91</a>.</p>
</li>
<li><p class="startli">Added deprecated keysym warnings:</p><ul>
<li><em>name</em> deprecation (typo, historical alias), reporting the reference name;</li>
<li><em>keysym</em> deprecation (ambiguous meaning, all names deprecated).</li>
</ul>
<p class="startli">These warnings are activated by setting the log verbosity to at least 2.</p>
<p class="startli">It is advised to fix these warnings, as the deprecated items may be removed in a future release.</p>
</li>
<li><span class="tt"><a class="el" href="xkbcommon-names_8h.html" title="Predefined names for common modifiers and LEDs.">xkbcommon-names.h</a></span>: Added the following modifiers names definitions:<ul>
<li><span class="tt">XKB_MOD_NAME_MOD1</span></li>
<li><span class="tt">XKB_MOD_NAME_MOD2</span></li>
<li><span class="tt">XKB_MOD_NAME_MOD3</span></li>
<li><span class="tt">XKB_MOD_NAME_MOD4</span></li>
<li><span class="tt">XKB_MOD_NAME_MOD5</span></li>
<li><span class="tt"><a class="el" href="group__virtual-modifier-names.html#gadfe1a2b7808fbe3e93ab5e4d4922912c">XKB_VMOD_NAME_ALT</a></span></li>
<li><span class="tt"><a class="el" href="group__virtual-modifier-names.html#gae63a14704bfb08d41ea499be0726e6bc">XKB_VMOD_NAME_META</a></span></li>
<li><span class="tt"><a class="el" href="group__virtual-modifier-names.html#ga0cb38463b488ead8f43950b6c0e03fc2">XKB_VMOD_NAME_NUM</a></span></li>
<li><span class="tt"><a class="el" href="group__virtual-modifier-names.html#gad93af5e24b8fe28a5fffc11f2cc39eb8">XKB_VMOD_NAME_SUPER</a></span></li>
<li><span class="tt"><a class="el" href="group__virtual-modifier-names.html#ga9ad97e96b4b7fa38644f18bcf4a8e2a9">XKB_VMOD_NAME_HYPER</a></span></li>
<li><span class="tt"><a class="el" href="group__virtual-modifier-names.html#gab7e939dd1d78f2abbee84ef149221eae">XKB_VMOD_NAME_LEVEL3</a></span></li>
<li><span class="tt"><a class="el" href="group__virtual-modifier-names.html#gaac006b67fc3d6b1e3bd02b6285586142">XKB_VMOD_NAME_LEVEL5</a></span></li>
<li><span class="tt"><a class="el" href="group__virtual-modifier-names.html#gac196de40ece2164901c43f13ca477ede">XKB_VMOD_NAME_SCROLL</a></span></li>
</ul>
</li>
<li><p class="startli"><span class="tt"><a class="el" href="xkbcommon-names_8h.html" title="Predefined names for common modifiers and LEDs.">xkbcommon-names.h</a></span>: Added <span class="tt"><a class="el" href="group__led-names.html#ga7714550c34e32ea29e3fc7e6cf5d2094">XKB_LED_NAME_COMPOSE</a></span> and <span class="tt">XKB_LED_NAME_KANA</span> definitions to cover all LEDs defined in <a href="https://usb.org/sites/default/files/hid1_11.pdf">USB HID</a>.</p>
<p class="startli">Contributed by Martin Rys</p>
</li>
<li>Rules: Use XKB paths to resolve relative paths in include statements. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/501">#501</a>)</li>
<li><p class="startli">Rules: Added support for special layouts indices:</p><ul>
<li><em>single</em>: matches a single layout; <span class="tt">layout[single]</span> is the same as without explicit index: <span class="tt">layout</span>.</li>
<li><em>first</em>: matches the first layout/variant, no matter how many layouts are in the RMLVO configuration. Acts as both <span class="tt">layout</span> and <span class="tt">layout[1]</span>.</li>
<li><em>later</em>: matches all but the first layout. This is an index range. Acts as <span class="tt">layout[2]</span> .. <span class="tt">layout[MAX_LAYOUT]</span>, where <span class="tt">MAX_LAYOUT</span> is currently 4.</li>
<li><em>any</em>: matches layout at any position. This is an index range.</li>
</ul>
<p class="startli">Also added:</p><ul>
<li>the special index <span class="tt">i</span> which correspond to the index of the matched layout.</li>
<li>the <span class="tt">:all</span> qualifier: it applies the qualified item to all layouts.</li>
</ul>
<p class="startli">See the <a href="https://xkbcommon.org/doc/current/rule-file-format.html">documentation</a> for further information.</p>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-9"></a>
Fixes</h3>
<ul>
<li><p class="startli">Previously, setting <em>explicit actions</em> for a group in symbols files made the parser skip compatibility interpretations for <em>all</em> groups in the corresponding key, resulting in possibly broken groups with <em>no</em> explicit actions or missing key fields.</p>
<p class="startli">Fixed by skipping interpretations only for groups with explicit actions when parsing a keymap and setting relevant fields explicitly when serializing a keymap to a string. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/511">#511</a>)</p>
</li>
<li><p class="startli"><span class="tt">xkb_keymap_new_from_names()</span>: Allow only one group per key in symbols sections. While the original issue was <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/merge_requests/253">fixed in <span class="tt">xkeyboard-config</span></a> project, the previous handling in <span class="tt">libxkbcommon</span> of extra key groups was deemed unintuitive.</p>
<p class="startli">Note: rules resolution may still produce more groups than the input layouts. This is currently true for some <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/-/blob/6a2eb9e63bcb3c52584580570d31cd91110d1f2e/rules/0013-modellayout_symbols.part#L2">legacy rules in <span class="tt">xkeyboard-config</span></a>.</p>
<p class="startli">(<a href="https://github.com/xkbcommon/libxkbcommon/issues/262">#262</a>)</p>
</li>
<li>Fixed <span class="tt">xkb_keymap_get_as_string</span> truncating the <em>4</em> longest keysyms names, such as <span class="tt">Greek_upsilonaccentdieresis</span>.</li>
<li><span class="tt"><a class="el" href="group__keysyms.html#ga55d6ce9127d42d37402d6df08a138de2" title="Get the Unicode/UTF-8 representation of a keysym.">xkb_keysym_to_utf8</a></span>: Require only 5 bytes for the buffer, as UTF-8 encodes code points on up to 4 bytes + 1 byte for the NULL-terminating byte. Previous standard <a href="https://datatracker.ietf.org/doc/html/rfc2279">RFC 2279</a> (1998) required up to 6 bytes per code point, but has been superseded by <a href="https://datatracker.ietf.org/doc/html/rfc3629">RFC 3629</a> (2003). (<a href="https://github.com/xkbcommon/libxkbcommon/issues/418">#418</a>)</li>
<li><p class="startli">Registry: Fixed <span class="tt">libxml2</span> global error handler not reset after parsing, which could trigger a crash if the corresponding <span class="tt"><a class="el" href="structrxkb__context.html" title="Opaque top level library context object.">rxkb_context</a></span> has been freed.</p>
<p class="startli">Contributed by Sebastian Keller. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/529">#529</a>)</p>
</li>
<li><p class="startli">Rules: Fix handling of wild card <span class="tt">*</span> to match the behavior of <span class="tt">libxkbfile</span>. Previously <span class="tt">*</span> would match any value, even empty one. Now:</p><ul>
<li>For <span class="tt">model</span> and <span class="tt">options</span>: <em>always</em> match.</li>
<li>For <span class="tt">layout</span> and <span class="tt">variant</span>: match any <em>non-empty</em> value.</li>
</ul>
<p class="startli">(<a href="https://github.com/xkbcommon/libxkbcommon/issues/497">#497</a>)</p>
</li>
<li>Fixed <span class="tt">LatchGroup</span> action with the <span class="tt">latchToLock</span> option disabled not applying its latch effect multiple times. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/577">#577</a>)</li>
<li>Fixed incorrect handling of group indicators when <span class="tt">whichGroupState</span> is set with <span class="tt">Base</span> or <span class="tt">Latched</span>. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/579">#579</a>)</li>
<li>Fixed missing explicit virtual modifier mappings when export the keymap as a string.</li>
<li>Fixed the lower case mapping ẞ → ß (<span class="tt">U1E9E</span> → <span class="tt">ssharp</span>). This re-enable the detection of alphabetic key types for the pair (ß, ẞ).</li>
<li>Fixed modifiers not properly unset when multiple latches are used simultaneously. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/583">#583</a>)</li>
<li><p class="startli">The following functions now allow to query also <em>virtual</em> modifiers, so they work with <em>any</em> modifiers (real <em>and</em> virtual):</p><ul>
<li><span class="tt">xkb_state_mod_index_is_active()</span></li>
<li><span class="tt">xkb_state_mod_indices_are_active()</span></li>
<li><span class="tt">xkb_state_mod_name_is_active()</span></li>
<li><span class="tt">xkb_state_mod_names_are_active()</span></li>
<li><span class="tt">xkb_state_mod_index_is_consumed()</span></li>
<li><span class="tt">xkb_state_mod_index_is_consumed2()</span></li>
<li><span class="tt">xkb_state_mod_mask_remove_consumed()</span></li>
</ul>
<p class="startli">Warning: they may overmatch in case there are overlappings virtual-to-real modifiers mappings.</p>
</li>
<li>X11: Do not drop a level when the keysym is undefined but not the action.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-7"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="new-12"></a>
New</h3>
<ul>
<li>Added <span class="tt">xkbcli dump-keymap-wayland</span> and <span class="tt">xkbcli dump-keymap-x11</span> debugging tools to dump a keymap from a Wayland compositor or a X server, similar to what <span class="tt">xkbcomp -xkb $DISPLAY -</span> does for X servers.</li>
<li><span class="tt">xkbcli compile-compose</span>: the Compose file may be passed as a positional argument and <span class="tt">--file</span> is now deprecated. The file can also be piped to the standard input by setting the path to <span class="tt">-</span>.</li>
<li><span class="tt">xkbcli compile-keymap</span>: Added <span class="tt">--<a class="el" href="group__keymap.html" title="Creating and destroying keymaps.">Keymap Creation</a></span> as a more intuitive alias for <span class="tt">--from-xkb</span>. Both now accept an optional keymap file argument. These flags may be omitted; in this case the keymap file may be passed as a positional argument.</li>
<li>Added <span class="tt">--test</span> option to <span class="tt">compile-keymap</span> and <span class="tt">compile-compose</span>, to enable testing compilation without printing the resulting file.</li>
<li><p class="startli"><span class="tt">xkbcli how-to-type</span>: added new input formats and their corresponding documentation.</p>
<p class="startli"><em>Unicode code points</em> can be passed in the following formats:</p><ul>
<li>Literal character (requires UTF-8 character encoding of the terminal);</li>
<li>Decimal number;</li>
<li>Hexadecimal number: either <span class="tt">0xNNNN</span> or <span class="tt">U+NNNN</span>.</li>
</ul>
<p class="startli"><em>Keysyms</em> can to be passed in the following formats:</p><ul>
<li>Decimal number;</li>
<li>Hexadecimal number: <span class="tt">0xNNNN</span>;</li>
<li>Name.</li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-10"></a>
Fixes</h3>
<ul>
<li>Fixed various tools truncating the <em>4</em> longest keysyms names, such as <span class="tt">Greek_upsilonaccentdieresis</span>.</li>
<li><span class="tt">xkbcli list</span>: Fix duplicate variants. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/587">#587</a>)</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="build-system-3"></a>
Build system</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-9"></a>
Breaking changes</h3>
<ul>
<li>Raised minimal meson version requirement to 0.58.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-11"></a>
Fixes</h3>
<ul>
<li>Make the test of <span class="tt">-Wl,--version-script</span> more robust. (<a href="https://github.com/xkbcommon/libxkbcommon/issues/481">#481</a>)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-170--2024-03-24"></a>
libxkbcommon <a href="https://github.com/xkbcommon/libxkbcommon/tree/xkbcommon-1.7.0">1.7.0</a> – 2024-03-24</h1>
<h2 class="doxsection"><a class="anchor" id="api-13"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="new-13"></a>
New</h3>
<ul>
<li>Added early detection of invalid encodings and BOM for keymaps, rules &amp; Compose. Also added a hint that the expected encoding must be UTF-8 compatible.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-12"></a>
Fixes</h3>
<ul>
<li><p class="startli">Updated keysyms using latest <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto">xorgproto</a> (commit: <span class="tt">cd33097fc779f280925c6d6bbfbd5150f93ca5bc</span>):</p>
<p class="startli">For the sake of compatibility, this reintroduces some deleted keysyms and postpones the effective deprecation of others, that landed in xkbcommon 1.6.0.</p><ul>
<li>Additions (reverted removal):<ul>
<li><span class="tt">XKB_KEY_dead_lowline</span></li>
<li><span class="tt">XKB_KEY_dead_aboveverticalline</span></li>
<li><span class="tt">XKB_KEY_dead_belowverticalline</span></li>
<li><span class="tt">XKB_KEY_dead_longsolidusoverlay</span></li>
</ul>
</li>
<li>The following keysyms names remain deprecated, but are set again (i.e. as before xkbcommon 1.6.0) as the reference names for their respective keysyms, in order to ensure the transition to the newer names that replace them. This affects functions such as <span class="tt">xkb_keymap_key_get_name</span> and <span class="tt">xkb_keymap_get_as_string</span>.<ul>
<li><span class="tt">XKB_KEY_masculine</span>: is deprecated in favor of <span class="tt">XKB_KEY_ordmasculine</span></li>
<li><span class="tt">XKB_KEY_guillemotleft</span>: is deprecated in favor of <span class="tt">XKB_KEY_guillemetleft</span></li>
<li><span class="tt">XKB_KEY_guillemotright</span>: is deprecated in favor of <span class="tt">XKB_KEY_guillemetright</span></li>
<li><span class="tt">XKB_KEY_dead_small_schwa</span>: is deprecated in favor of <span class="tt">XKB_KEY_dead_schwa</span></li>
<li><span class="tt">XKB_KEY_dead_capital_schwa</span>: is deprecated in favor of <span class="tt">XKB_KEY_dead_SCHWA</span></li>
</ul>
</li>
</ul>
<p class="startli">Relevant upstream merge requests: <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/83">xorgproto-83</a>, <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/84">xorgproto-84</a>.</p>
</li>
<li>Keysyms: Fixed inconsistent results in <span class="tt"><a class="el" href="group__keysyms.html#gadf335e065050f306ff9094aefa6c9736" title="Get a keysym from its name.">xkb_keysym_from_name</a></span> when used with the flag <span class="tt"><a class="el" href="group__keysyms.html#gga0b4e78037b911489b68fe8b2a11f5487a9f7133fedc8e627fe663021ea7d9087d" title="Find keysym by case-insensitive search.">XKB_KEYSYM_CASE_INSENSITIVE</a></span>. In some rare cases it would return a keysym with an upper-case name instead of the expected lower-case (e.g. <span class="tt">XKB_KEY_dead_A</span> instead of <span class="tt">XKB_KEY_dead_a</span>).</li>
<li>Keysyms: Fixed case mapping for 3 Latin 1 keysyms:<ul>
<li><span class="tt">XKB_KEY_ydiaeresis</span></li>
<li><span class="tt">XKB_KEY_mu</span></li>
<li><span class="tt">XKB_KEY_ssharp</span></li>
</ul>
</li>
<li>Keysyms: Fixed <span class="tt">xkb_keysym_is_modifier</span> to detect also the following keysyms:<ul>
<li><span class="tt">XKB_KEY_ISO_Level5_Shift</span></li>
<li><span class="tt">XKB_KEY_ISO_Level5_Latch</span></li>
<li><span class="tt">XKB_KEY_ISO_Level5_Lock</span></li>
</ul>
</li>
<li>Prevent recursive includes of keymap components.</li>
<li><p class="startli">Fixed global default statements <span class="tt">x.y = z;</span> in wrong scope not raising an error.</p>
<p class="startli">Contributed by Mikhail Gusarov</p>
</li>
<li><p class="startli">Keymap: Fixed empty symbols declaration.</p>
<p class="startli">Contributed by Yuichiro Hanada.</p>
</li>
<li><p class="startli">Rules: Made newline required after <span class="tt">!include</span> line.</p>
<p class="startli">Contributed by Mikhail Gusarov.</p>
</li>
<li><p class="startli">Rules: Fixed a bug where variant indices were ignored with the layout index used instead. They are practically always the same, but don’t have to be.</p>
<p class="startli">Contributed by @wysiwys.</p>
</li>
<li>Compose: Fixed a segfault with <span class="tt">xkb_compose_table_iterator_next</span> when used on an empty table.</li>
<li>Compose: Added check to ensure to open only regular files, not e.g. directories.</li>
<li>Registry: Updated the DTD and always parse the “popularity” attribute.</li>
<li>Fixed a few memory leaks and keymap symbols parsing.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-8"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="new-14"></a>
New</h3>
<ul>
<li><span class="tt">xkbcli compile-compose</span>: added new CLI utility to test Compose files.</li>
<li><span class="tt">xkbcli interactive-evdev</span>: added <span class="tt">--verbose</span> option.</li>
<li><span class="tt">xkbcli interactive-x11</span>: added support for Compose.</li>
<li><span class="tt">xkbcli interactive-wayland</span>: added support for Compose.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-13"></a>
Fixes</h3>
<ul>
<li>Bash completion: Fixed completion in some corner cases.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="build-system-4"></a>
Build system</h2>
<ul>
<li><p class="startli">Fix building with clang when using <span class="tt">-Wl,--gc-sections</span>.</p>
<p class="startli">Contributed by ppw0.</p>
</li>
<li><p class="startli">Fixed linking using <span class="tt">lld 1.17</span>.</p>
<p class="startli">Contributed by Baptiste Daroussin.</p>
</li>
<li>Fix building X11 tests on macOS.</li>
<li>Documentation is no longer built by default; it requires <span class="tt">-Denable-docs=true</span>.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-160--2023-10-08"></a>
libxkbcommon 1.6.0 – 2023-10-08</h1>
<h2 class="doxsection"><a class="anchor" id="api-14"></a>
API</h2>
<h3 class="doxsection"><a class="anchor" id="breaking-changes-10"></a>
Breaking changes</h3>
<ul>
<li><p class="startli"><em>Remove</em> keysyms that were intended for German T3 layout but are unused:</p><ul>
<li><span class="tt">XKB_KEY_dead_lowline</span></li>
<li><span class="tt">XKB_KEY_dead_aboveverticalline</span></li>
<li><span class="tt">XKB_KEY_dead_belowverticalline</span></li>
<li><span class="tt">XKB_KEY_dead_longsolidusoverlay</span></li>
</ul>
<p class="startli">See the upstream <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/70"><span class="tt">xorgproto</span> MR</a>. See hereinafter for further changes related to keysyms.</p>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="new-15"></a>
New</h3>
<ul>
<li>Add Compose iterator API to iterate the entries in a compose table:<ul>
<li><span class="tt">xkb_compose_table_entry_sequence()</span></li>
<li><span class="tt">xkb_compose_table_entry_keysym()</span></li>
<li><span class="tt">xkb_compose_table_entry_utf8()</span></li>
<li><span class="tt">xkb_compose_table_iterator_new()</span></li>
<li><span class="tt">xkb_compose_table_iterator_free()</span></li>
<li><span class="tt">xkb_compose_table_iterator_next()</span></li>
</ul>
</li>
<li><em>Structured log messages</em> with a message registry. There is an <em>ongoing</em> work to assign unique identifiers to log messages and add a corresponding error index documentation page:<ul>
<li>The log entries are preceded with an identifier in the form <span class="tt">XKB-NNN</span>, where <span class="tt">NNN</span> is a decimal number.</li>
<li>The log entries can then be parsed with third-party tools, to check for specific identifiers.</li>
<li>The new documentation page “**Error index**” lists all the kind of error messages with their identifiers. The aim is that each entry could present detailed information on the error and how to fix it.</li>
</ul>
</li>
<li>Add a new warning for numeric keysyms references in XKB files: the preferred keysym reference form is its name or its Unicode value, if relevant.</li>
<li>Add the upper bound <span class="tt"><a class="el" href="group__keysyms.html#gad54a22fd582c0a0f0efc34f1ea527930" title="Maximum keysym value.">XKB_KEYSYM_MAX</a></span> to check valid keysyms.</li>
<li>Add a warning when loading a keymap using RMLVO with no layout but with the variant set. The variant is actually discarded and both layout and variant are set to default values, but this was done previously with no warning, confusing end users.</li>
<li>Add support for <span class="tt">modifier_map None { … }</span>. This feature is missing compared to the X11 implementation. It allows to reset the modifier map of a key.</li>
<li>Update keysyms using latest <a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto">xorgproto</a> (commit: <span class="tt">1c8128d72df22843a2022576850bc5ab5e3a46ea</span>):<ul>
<li>Additions:<ul>
<li><span class="tt">XKB_KEY_ordmasculine</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/68">xorgproto-68</a>)</li>
<li><span class="tt">XKB_KEY_guillemetleft</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/68">xorgproto-68</a>)</li>
<li><span class="tt">XKB_KEY_guillemetright</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/68">xorgproto-68</a>)</li>
<li><span class="tt">XKB_KEY_dead_schwa</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/78">xorgproto-78</a>)</li>
<li><span class="tt">XKB_KEY_dead_SCHWA</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/78">xorgproto-78</a>)</li>
<li><span class="tt">XKB_KEY_dead_hamza</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/71">xorgproto-71</a>)</li>
<li><span class="tt">XKB_KEY_XF86EmojiPicker</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/44">xorgproto-44</a>)</li>
<li><span class="tt">XKB_KEY_XF86Dictate</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/49">xorgproto-49</a>)</li>
<li><span class="tt">XKB_KEY_XF86CameraAccessEnable</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86CameraAccessDisable</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86CameraAccessToggle</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86NextElement</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86PreviousElement</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86AutopilotEngageToggle</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86MarkWaypoint</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86Sos</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86NavChart</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86FishingChart</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86SingleRangeRadar</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86DualRangeRadar</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86RadarOverlay</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86TraditionalSonar</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86ClearvuSonar</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86SidevuSonar</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
<li><span class="tt">XKB_KEY_XF86NavInfo</span> (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/82">xorgproto-82</a>)</li>
</ul>
</li>
<li>Deprecations:<ul>
<li><span class="tt">XKB_KEY_masculine</span>: use <span class="tt">XKB_KEY_ordmasculine</span> instead (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/68">xorgproto-68</a>)</li>
<li><span class="tt">XKB_KEY_guillemotleft</span>: use <span class="tt">XKB_KEY_guillemetleft</span> instead (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/68">xorgproto-68</a>)</li>
<li><span class="tt">XKB_KEY_guillemotright</span>: use <span class="tt">XKB_KEY_guillemetright</span> instead (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/68">xorgproto-68</a>)</li>
<li><span class="tt">XKB_KEY_dead_small_schwa</span>: use <span class="tt">XKB_KEY_dead_schwa</span> instead (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/78">xorgproto-78</a>)</li>
<li><span class="tt">XKB_KEY_dead_capital_schwa</span>: use <span class="tt">XKB_KEY_dead_SCHWA</span> instead (<a href="https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/merge_requests/78">xorgproto-78</a>)</li>
</ul>
</li>
</ul>
</li>
<li>Ongoing work to improve the documentation about XKB and its V1 format.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-14"></a>
Fixes</h3>
<ul>
<li>Prevent <span class="tt"><a class="el" href="group__keysyms.html#gadf335e065050f306ff9094aefa6c9736" title="Get a keysym from its name.">xkb_keysym_from_name</a></span> to parse out-of-range hexadecimal keysyms.</li>
<li>Disallow producing NULL character with escape sequences <span class="tt">\0</span> and <span class="tt">\x0</span>.</li>
<li>Prevent overflow of octal escape sequences by making <span class="tt">\400..\777</span> invalid.</li>
<li>Prevent interpreting and emitting invalid Unicode encoding forms: surrogates are invalid in both UTF-32 and UTF-8.</li>
<li><span class="tt">xkb_keymap_new_from_buffer</span>: Allow for a NULL-terminated keymap string.</li>
<li><p class="startli">Compose: Increase the limit of possible entries to handle huge Compose files.</p>
<p class="startli">Contributed by alois31.</p>
</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="tools-9"></a>
Tools</h2>
<h3 class="doxsection"><a class="anchor" id="new-16"></a>
New</h3>
<ul>
<li>Add bash completions for <span class="tt">xkbcli</span> and its subcommands.</li>
<li><span class="tt">xkbcli interactive-*</span>: Add options <span class="tt">--short</span> to hide some fields.</li>
<li><span class="tt">xkbcli interactive-evdev</span>: Add <span class="tt">--includes</span> and <span class="tt">--include-defaults</span> options.</li>
<li>Add <span class="tt">xkb-check-messages</span> <em>experimental</em> tool (not installed). It checks whether given log messages identifiers are supported.</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="fixes-15"></a>
Fixes</h3>
<ul>
<li><span class="tt">xkbcli compile-keymap</span>: Allow to use without arguments.</li>
<li><span class="tt">xkbcli interactive-*</span>: Always print keycode.</li>
<li><span class="tt">xkbcli interactive-*</span>: Escape control characters for Unicode output, instead of printing them as-is, messing the output.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="build-system-5"></a>
Build system</h2>
<ul>
<li>Bump required meson to 0.52.0.</li>
<li><p class="startli">Allow <span class="tt">xkbcommon</span> to be used as a subproject.</p>
<p class="startli">Contributed by Simon Ser.</p>
</li>
<li>Improve Windows compilation.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-150--2023-01-02"></a>
libxkbcommon 1.5.0 – 2023-01-02</h1>
<ul>
<li><p class="startli">Add <span class="tt"><a class="el" href="structxkb__context.html" title="Opaque top level library context object.">xkb_context</a></span> flag <span class="tt"><a class="el" href="group__context.html#ggaea2acb5b9e06239e20a7c34f5b223092a6b41cadc8f0c2d295a167951216bf52d" title="Disable the use of secure_getenv for this context, so that privileged processes can use environment v...">XKB_CONTEXT_NO_SECURE_GETENV</a></span> and <span class="tt"><a class="el" href="structrxkb__context.html" title="Opaque top level library context object.">rxkb_context</a></span> flag <span class="tt"><a class="el" href="group__registry.html#gga51409c26e106c66e71d95fa27f8c4603aa368ff84d321081d888afd69cc3e55b3" title="Disable the use of secure_getenv() for this context, so that privileged processes can use environment...">RXKB_CONTEXT_NO_SECURE_GETENV</a></span>.</p>
<p class="startli">xkbcommon uses <span class="tt">getenv_secure()</span> to obtain environment variables. This flag makes xkbcommon use <span class="tt">getenv()</span> instead.</p>
<p class="startli">This is useful for some clients that have relatively benign capabilities set, like <span class="tt">CAP_SYS_NICE</span>, that also want to use e.g. the XKB configuration from the environment and user configs in <span class="tt">$XDG_CONFIG_HOME</span>.</p>
<p class="startli">Contributed by Ronan Pigott.</p>
</li>
<li><p class="startli">Fix crash in <span class="tt">xkbcli interactive-wayland</span> under a compositor which supports new versions of the xdg-shell protocol.</p>
<p class="startli">Contributed by Jan Alexander Steffens (heftig).</p>
</li>
<li>Fix some MSVC build issues.</li>
<li>Fix some issues when including xkbcommon as a meson subproject.</li>
<li>meson&gt;=0.51 is now required.</li>
<li>New API: <span class="tt"><a class="el" href="group__context.html#ggaea2acb5b9e06239e20a7c34f5b223092a6b41cadc8f0c2d295a167951216bf52d" title="Disable the use of secure_getenv for this context, so that privileged processes can use environment v...">XKB_CONTEXT_NO_SECURE_GETENV</a></span> <span class="tt"><a class="el" href="group__registry.html#gga51409c26e106c66e71d95fa27f8c4603aa368ff84d321081d888afd69cc3e55b3" title="Disable the use of secure_getenv() for this context, so that privileged processes can use environment...">RXKB_CONTEXT_NO_SECURE_GETENV</a></span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-141--2022-05-21"></a>
libxkbcommon 1.4.1 – 2022-05-21</h1>
<ul>
<li><p class="startli">Fix compose sequence overriding (common prefix) not working correctly. Regressed in 1.2.0.</p>
<p class="startli">Contributed by Weng Xuetian.</p>
</li>
<li><p class="startli">Remove various bogus currency sign (particulary Euro and Korean Won) entries from the keysym ↔ Unicode mappings. They prevented the real keysyms/codepoints for these from mapping correctly.</p>
<p class="startli">Contributed by Sam Lantinga and Simon Ser.</p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-140--2022-02-04"></a>
libxkbcommon 1.4.0 – 2022-02-04</h1>
<ul>
<li><p class="startli">Add <span class="tt">enable-tools</span> option to Meson build (on by default) to allow disabling the <span class="tt">xkbcli</span> tools.</p>
<p class="startli">Contributed by Alex Xu (Hello71).</p>
</li>
<li><p class="startli">In <span class="tt">xkbcli list</span>, fix “YAML Norway problem” in output.</p>
<p class="startli">Contributed by Peter Hutterer.</p>
</li>
<li><p class="startli">In libxkbregistry, variants now inherit iso639, iso3166 and brief from parent layout if omitted.</p>
<p class="startli">Contributed by M Hickford.</p>
</li>
<li><p class="startli">In libxkbregistry, don’t call <span class="tt">xmlCleanupParser()</span> - it’s not supposed to be called by libraries.</p>
<p class="startli">Contributed by Peter Hutterer.</p>
</li>
<li><p class="startli">In libxkbregistry, skip over invalid ISO-639 or ISO-3166 entries.</p>
<p class="startli">Contributed by Peter Hutterer.</p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-131--2021-09-10"></a>
libxkbcommon 1.3.1 – 2021-09-10</h1>
<ul>
<li><p class="startli">In <span class="tt">xkbcli interactive-x11</span>, use the Esc keysym instead of the Esc keycode for quitting.</p>
<p class="startli">Contributed by Simon Ser.</p>
</li>
<li>In <span class="tt">xkbcli how-to-type</span>, add <span class="tt">--keysym</span> argugment for how to type a keysym instead of a Unicode codepoint.</li>
<li><p class="startli">Fix a crash in <span class="tt">xkb_x11_keymap_new_from_device()</span> error handling given some invalid keymaps. Regressed in 1.2.0.</p>
<p class="startli">Reported by Zack Weinberg. Tested by Uli Schlachter.</p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-130--2021-05-01"></a>
libxkbcommon 1.3.0 – 2021-05-01</h1>
<ul>
<li><p class="startli">Change <span class="tt">xkbcli list</span> to output YAML, instead of the previous ad-hoc format.</p>
<p class="startli">This allows to more easily process the information in a programmetic way, for example </p><pre class="fragment">xkbcli list | yq -r ".layouts[].layout"
</pre><p class="startli">Contributed by Peter Hutterer.</p>
</li>
<li>Optimize a certain part of keymap compilation (atom interning).</li>
<li><p class="startli">Fix segmentation fault in case-insensitive <span class="tt"><a class="el" href="group__keysyms.html#gadf335e065050f306ff9094aefa6c9736" title="Get a keysym from its name.">xkb_keysym_from_name()</a></span> for certain values like the empty string.</p>
<p class="startli">Contributed by Isaac Freund.</p>
</li>
<li><p class="startli">Support building libxkbcommon as a meson subproject.</p>
<p class="startli">Contributed by Adrian Perez de Castro.</p>
</li>
<li><p class="startli">Add <span class="tt">ftruncate</span> fallback for <span class="tt">posix_fallocate</span> in <span class="tt">xkbcli interactive-wayland</span> for FreeBSD.</p>
<p class="startli">Contributed by Evgeniy Khramtsov.</p>
</li>
<li><p class="startli">Properly export library symbols in MSVC.</p>
<p class="startli">Contributed by Adrian Perez de Castro.</p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-121--2021-04-07"></a>
libxkbcommon 1.2.1 – 2021-04-07</h1>
<ul>
<li>Fix <span class="tt">xkb_x11_keymap_new_from_device()</span> failing when the keymap contains key types with missing level names, like the one used by the <span class="tt">numpad:mac</span> option in <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/">xkeyboard-config</a>. Regressed in 1.2.0.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-120--2021-04-03"></a>
libxkbcommon 1.2.0 – 2021-04-03</h1>
<ul>
<li><p class="startli"><span class="tt">xkb_x11_keymap_new_from_device()</span> is much faster. It now performs only 2 roundtrips to the X server, instead of dozens (in first-time calls).</p>
<p class="startli">Contributed by Uli Schlachter.</p>
</li>
<li>Case-sensitive <span class="tt"><a class="el" href="group__keysyms.html#gadf335e065050f306ff9094aefa6c9736" title="Get a keysym from its name.">xkb_keysym_from_name()</a></span> is much faster.</li>
<li>Keysym names of the form <span class="tt">0x12AB</span> and <span class="tt">U12AB</span> are parsed more strictly. Previously the hexadecimal part was parsed with <span class="tt">strtoul()</span>, now only up to 8 hexadecimal digits (<span class="tt">0-9A-Fa-f</span>) are allowed.</li>
<li>Compose files now have a size limit (65535 internal nodes). Further sequences are discared and a warning is issued.</li>
<li>Compose table loading (<span class="tt">xkb_compose_table_new_from_locale()</span> and similar) is much faster.</li>
<li>Use <span class="tt">poll()</span> instead of <span class="tt">epoll()</span> for <span class="tt">xlbcli interactive-evdev</span>, making it portable to FreeBSD which provides evdev but not epoll. On FreeBSD, remember to install the <span class="tt">evdev-proto</span> package to get the evdev headers.</li>
<li>The build now requires a C11 compiler (uses anonymous structs/unions).</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-110--2021-02-27"></a>
libxkbcommon 1.1.0 – 2021-02-27</h1>
<ul>
<li>Publish the <span class="tt">xkb-format-text-v1.md</span> file in the HTML documentation. This file existed for a long time but only in the Git repository. Link: <a href="https://xkbcommon.org/doc/current/md_doc_keymap_format_text_v1.html">https://xkbcommon.org/doc/current/md_doc_keymap_format_text_v1.html</a></li>
<li><p class="startli">Add partial documentation for <span class="tt">xkb_symbols</span> to <span class="tt">xkb-format-text-v1.md</span>.</p>
<p class="startli">Contributed by Simon Zeni.</p>
</li>
<li><p class="startli">Update keysym definitions to latest xorgproto. In particular, this adds many special keysyms corresponding to Linux evdev keycodes.</p>
<p class="startli">Contributed by Peter Hutterer &lt;@who-t.net&gt;.</p>
</li>
<li>New API: Too many <span class="tt">XKB_KEY_*</span> definitions to list here.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-103--2020-11-23"></a>
libxkbcommon 1.0.3 – 2020-11-23</h1>
<ul>
<li>Fix (hopefully) a segfault in <span class="tt">xkb_x11_keymap_new_from_device()</span> in some unclear situation (bug introduced in 1.0.2).</li>
<li>Fix keymaps created with <span class="tt">xkb_x11_keymap_new_from_device()</span> don’t have level names (bug introduced in 0.8.0).</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-102--2020-11-20"></a>
libxkbcommon 1.0.2 – 2020-11-20</h1>
<ul>
<li>Fix a bug where a keysym that cannot be resolved in a keymap gets compiled to a garbage keysym. Now it is set to <span class="tt">XKB_KEY_NoSymbol</span> instead.</li>
<li>Improve the speed of <span class="tt">xkb_x11_keymap_new_from_device()</span> on repeated calls in the same <span class="tt"><a class="el" href="structxkb__context.html" title="Opaque top level library context object.">xkb_context()</a></span>.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-101--2020-09-11"></a>
libxkbcommon 1.0.1 – 2020-09-11</h1>
<ul>
<li>Fix the <span class="tt">tool-option-parsing</span> test failing.</li>
<li>Remove requirement for pytest in the tool-option-parsing test.</li>
<li>Make the table output of <span class="tt">xkbcli how-to-type</span> aligned.</li>
<li>Some portability and test isolation fixes.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-100--2020-09-05"></a>
libxkbcommon 1.0.0 – 2020-09-05</h1>
<p>Note: this release is API and ABI compatible with previous releases –the major version bump is only an indication of stability.</p>
<ul>
<li><p class="startli">Add libxkbregistry as configure-time optional library. libxkbregistry is a C library that lists available XKB models, layouts and variants for a given ruleset. This is a separate library (<span class="tt">libxkbregistry.so</span>, pkgconfig file <span class="tt">xkbregistry.pc</span>) and aimed at tools that provide a listing of available keyboard layouts to the user. See the Documentation for details on the API.</p>
<p class="startli">Contributed by Peter Hutterer &lt;@who-t.net&gt;.</p>
</li>
<li><p class="startli">Better support custom user configuration:</p><ul>
<li><p class="startli">Allow including XKB files from other paths.</p>
<p class="startli">Previously, a <span class="tt">symbols/us</span> file in path A would shadow the same file in path B. This is suboptimal, we rarely need to hide the system files - we care mostly about <em>extending</em> them. By continuing to check other lookup paths, we make it possible for a <span class="tt">$XDG_CONFIG_HOME/xkb/symbols/us</span> file to have sections including those from <span class="tt">/usr/share/X11/xkb/symbols/us</span>.</p>
<p class="startli">Note that this is not possible for rules files, which need to be manually controlled to get the right bits resolved.</p>
</li>
<li><p class="startli">Add /etc/xkb as extra lookup path for system data files.</p>
<p class="startli">This completes the usual triplet of configuration locations available for most processes:</p><ul>
<li>vendor-provided data files in <span class="tt">/usr/share/X11/xkb</span></li>
<li>system-specific data files in <span class="tt">/etc/xkb</span></li>
<li>user-specific data files in <span class="tt">$XDG_CONFIG_HOME/xkb</span></li>
</ul>
<p class="startli">The default lookup order user, system, vendor, just like everything else that uses these conventions.</p>
<p class="startli">For include directives in rules files, the <span class="tt">E</span> resolves to that path.</p>
</li>
<li>Add a new section to the documentation for custom user configuration.</li>
</ul>
<p class="startli">Contributed by Peter Hutterer &lt;@who-t.net&gt;.</p>
</li>
<li><p class="startli">Add an <span class="tt">xkbcli</span> command-line utility.</p>
<p class="startli">This tool offers various subcommands for introspection and debugging. Currently the available subcommands are:</p>
<dl>
<dt>list </dt>
<dd>List available rules, models, layouts, variants and options </dd>
<dt>interactive-wayland </dt>
<dd>Interactive debugger for XKB keymaps for Wayland </dd>
<dt>interactive-x11 </dt>
<dd>Interactive debugger for XKB keymaps for X11 </dd>
<dt>interactive-evdev </dt>
<dd>Interactive debugger for XKB keymaps for evdev (Linux) </dd>
<dt>compile-keymap </dt>
<dd>Compile an XKB keymap </dd>
<dt>how-to-type </dt>
<dd>See separate entry below. </dd>
</dl>
<p class="startli">See the manpages for usage information.</p>
<p class="startli">Contributed by Peter Hutterer &lt;@who-t.net&gt;.</p>
</li>
<li><p class="startli">Add <span class="tt"><a class="el" href="group__keysyms.html#ga5fde9cc397ae996b4efac56c9cd6bd18" title="Get the keysym corresponding to a Unicode/UTF-32 codepoint.">xkb_utf32_to_keysym()</a></span> to translate a Unicode codepoint to a keysym. When a special keysym (<span class="tt">XKB_KEY_</span> constant) for the codepoint exists, it is returned, otherwise the direct encoding is used, if permissible.</p>
<p class="startli">Contributed by Jaroslaw Kubik &lt;@froglogic.com&gt;.</p>
</li>
<li><p class="startli">Add <span class="tt">xkb_keymap_key_get_mods_for_level()</span> which retrieves sets of modifiers which produce a given shift level in a given key+layout.</p>
<p class="startli">Contributed by Jaroslaw Kubik &lt;@froglogic.com&gt;.</p>
</li>
<li><p class="startli">Add <span class="tt">xkbcli how-to-type</span> command, which, using <span class="tt"><a class="el" href="group__keysyms.html#ga5fde9cc397ae996b4efac56c9cd6bd18" title="Get the keysym corresponding to a Unicode/UTF-32 codepoint.">xkb_utf32_to_keysym()</a></span> and <span class="tt">xkb_keymap_key_get_mods_for_level()</span> and other APIs, prints out all the ways to produce a given keysym.</p>
<p class="startli">For example, how to type <span class="tt">?</span> (codepoint 63) in a <span class="tt">us,de</span> keymap? </p><pre class="fragment">$ xkbcli how-to-type --layout us,de 63 | column -ts $'\t'
keysym: question (0x3f)
KEYCODE  KEY NAME  LAYOUT#  LAYOUT NAME   LEVEL#  MODIFIERS
20       AE11      2        German        2       [ Shift ]
20       AE11      2        German        2       [ Shift Lock ]
61       AB10      1        English (US)  2       [ Shift ]
</pre></li>
</ul>
<ul>
<li>Add a new section to the documentation describing the format of the XKB rules file.</li>
<li><p class="startli">Search for Compose in <span class="tt">$XDG_CONFIG_HOME/XCompose</span> (fallback to <span class="tt">~/.config/XCompose</span>) before trying <span class="tt">$HOME/.XCompose</span>.</p>
<p class="startli">Note that libX11 still only searches in <span class="tt">$HOME/.XCompose</span>.</p>
<p class="startli">Contributed by Emmanuel Gil Peyrot &lt;@linkmauve.fr&gt;.</p>
</li>
<li>Bump meson requirement to &gt;= 0.49.0.</li>
<li>Fix build with byacc.</li>
<li><p class="startli">Fix building X11 tests on PE targets.</p>
<p class="startli">Contributed by Jon Turney &lt;@dronecode.org.uk&gt;</p>
</li>
<li>The tests no longer rely on bash, only Python (which is already used by meson).</li>
<li>New API: <span class="tt"><a class="el" href="group__keysyms.html#ga5fde9cc397ae996b4efac56c9cd6bd18" title="Get the keysym corresponding to a Unicode/UTF-32 codepoint.">xkb_utf32_to_keysym</a></span> <span class="tt">xkb_keymap_key_get_mods_for_level</span> <span class="tt">XKB_KEY_XF86FullScreen</span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-0100--2020-01-18"></a>
libxkbcommon 0.10.0 – 2020-01-18</h1>
<ul>
<li>(security) Fix quadratic complexity in the XKB file parser. See commit message 7c42945e04a2107827a057245298dedc0475cc88 for details.</li>
<li><p class="startli">Add <span class="tt">$XDG_CONFIG_HOME/xkb</span> to the default search path. If <span class="tt">$XDG_CONFIG_HOME</span> is not set, <span class="tt">$HOME/.config/xkb</span> is used. If <span class="tt">$HOME</span> is not set, the path is not added.</p>
<p class="startli">The XDG path is looked up before the existing default search path $HOME/.xkb.</p>
<p class="startli">Contributed by Peter Hutterer &lt;@who-t.net&gt;.</p>
</li>
<li><p class="startli">Add support for include statements in XKB rules files.</p>
<p class="startli">This is a step towards making local XKB customizations more tenable and convenient, without modifying system files.</p>
<p class="startli">You can now include other rules files like this: </p><pre class="fragment">! include %S/evdev
</pre><p class="startli">Two directives are supported, <span class="tt">H</span> to <span class="tt">$HOME</span> and <span class="tt">S</span> for the system-installed rules directory (usually <span class="tt">/usr/share/X11/xkb/rules</span>).</p>
<p class="startli">See commit message ca033a29d2ca910fd17b1ae287cb420205bdddc8 and doc/rules-format.txt in the xkbcommon source code for more information.</p>
<p class="startli">Contributed by Peter Hutterer &lt;@who-t.net&gt;.</p>
</li>
<li><p class="startli">Downgrade “Symbol added to modifier map for multiple modifiers” log to a warning.</p>
<p class="startli">This error message was too annoying to be shown by default. When working on keymaps, set <span class="tt">XKB_LOG_LEVEL=debug XKB_LOG_VERBOSITY=10</span> to see all possible messages.</p>
</li>
<li><p class="startli">Support building on Windows using the meson MSVC backend.</p>
<p class="startli">Contributed by Adrian Perez de Castro &lt;@igalia.com&gt;.</p>
</li>
<li><p class="startli">Fix bug where the merge mode only applied to the first vmod in a <span class="tt">virtual_modifiers</span> statement. Given </p><pre class="fragment">augment virtual_modifiers NumLock,Alt,LevelThree
</pre><p class="startli">Previously it was incorrectly treated as </p><pre class="fragment">augment virtual_modifiers NumLock;
virtual_modifiers Alt;
virtual_modifiers LevelThree;
</pre><p class="startli">Now it is treated as </p><pre class="fragment">augment virtual_modifiers NumLock;
augment virtual_modifiers Alt;
augment virtual_modifiers LevelThree;
</pre></li>
</ul>
<ul>
<li><p class="startli">Reject interpret modifier predicate with more than one value. Given </p><pre class="fragment">interpret ISO_Level3_Shift+AnyOf(all,extraneous) { ... };
</pre><p class="startli">Previously, extraneous (and further) was ignored. Now it’s rejected.</p>
</li>
<li>Correctly handle capitalization of the ssharp keysym.</li>
<li><p class="startli">Speed up and improve the internal <span class="tt">xkeyboard-config</span> tool. This tool compiles all layout/variant combinations in the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/">xkeyboard-config</a> dataset and reports any issues it finds.</p>
<p class="startli">Contributed by Peter Hutterer &lt;@who-t.net&gt;.</p>
</li>
<li>Speed up “atoms” (string interning). This code goes back at least to X11R1 (released 1987).</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-091--2019-10-19"></a>
libxkbcommon 0.9.1 – 2019-10-19</h1>
<ul>
<li>Fix context creation failing when run in privileged processes as defined by <span class="tt">secure_getenv(3)</span>, e.g. GDM.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-090--2019-10-19"></a>
libxkbcommon 0.9.0 – 2019-10-19</h1>
<ul>
<li>Move <span class="tt">~/.xkb</span> to before <span class="tt">XKB_CONFIG_ROOT</span> (the system XKB path, usually <span class="tt">/usr/share/X11/xkb</span>) in the default include path. This enables the user to have full control of the keymap definitions, instead of only augmenting them.</li>
<li>Remove the Autotools build system. Use the meson build system instead.</li>
<li>Fix invalid names used for levels above 8 when dumping keymaps. Previously, e.g. <span class="tt">Level20</span> was dumped, but only up to <span class="tt">Level8</span> is accepted by the parser. Now <span class="tt">20</span> is dumped.</li>
<li><p class="startli">Change level references to always be dumped as e.g. <span class="tt">5</span> instead of <span class="tt">Level5</span>.</p>
<p class="startli">Change group references to always be dumped capitalized e.g. <span class="tt">Group3</span> instead of <span class="tt">group3</span>. Previously it was inconsistent.</p>
<p class="startli">These changes affect the output of <span class="tt">xkb_keymap_get_as_string()</span>.</p>
</li>
<li>Fix several build issues on macOS/Darwin, Solaris, NetBSD, cross compilation.</li>
<li>Port the <span class="tt">interactive-wayland</span> test program to the stable version of <span class="tt">xdg-shell</span>.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-084--2019-02-22"></a>
libxkbcommon 0.8.4 – 2019-02-22</h1>
<ul>
<li>Fix build of xkbcommon-x11 static library with meson.</li>
<li>Fix building using meson from the tarball generated by autotools.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-083--2019-02-08"></a>
libxkbcommon 0.8.3 – 2019-02-08</h1>
<ul>
<li>Fix build of static libraries with meson. (Future note: xkbcommon-x11 was <em>not</em> fixed in this release.)</li>
<li>New API: <span class="tt">XKB_KEY_XF86MonBrightnessCycle</span> <span class="tt">XKB_KEY_XF86RotationLockToggle</span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-082--2018-08-05"></a>
libxkbcommon 0.8.2 – 2018-08-05</h1>
<ul>
<li>Fix various problems found with fuzzing (see commit messages for more details):<ul>
<li>Fix a few NULL-dereferences, out-of-bounds access and undefined behavior in the XKB text format parser.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-081--2018-08-03"></a>
libxkbcommon 0.8.1 – 2018-08-03</h1>
<ul>
<li>Fix various problems found in the meson build (see commit messages for more details):<ul>
<li>Fix compilation on Darwin.</li>
<li>Fix compilation of the x11 tests and demos when XCB is installed in a non-standard location.</li>
<li>Fix <span class="tt">xkbcommon-x11.pc</span> missing the Requires specification.</li>
</ul>
</li>
<li>Fix various problems found with fuzzing and Coverity (see commit messages for more details):<ul>
<li>Fix stack overflow in the XKB text format parser when evaluating boolean negation.</li>
<li>Fix NULL-dereferences in the XKB text format parser when some unsupported tokens appear (the tokens are still parsed for backward compatibility).</li>
<li>Fix NULL-dereference in the XKB text format parser when parsing an <span class="tt">xkb_geometry</span> section.</li>
<li>Fix an infinite loop in the Compose text format parser on some inputs.</li>
<li>Fix an invalid <span class="tt">free()</span> when using multiple keysyms.</li>
</ul>
</li>
<li>Replace the Unicode characters for the leftanglebracket and rightanglebracket keysyms from the deprecated LEFT/RIGHT-POINTING ANGLE BRACKET to MATHEMATICAL LEFT/RIGHT ANGLE BRACKET.</li>
<li>Reject out-of-range Unicode codepoints in <span class="tt"><a class="el" href="group__keysyms.html#ga55d6ce9127d42d37402d6df08a138de2" title="Get the Unicode/UTF-8 representation of a keysym.">xkb_keysym_to_utf8()</a></span> and <span class="tt"><a class="el" href="group__keysyms.html#gaa21f81e097317fa9074fefeb0b265507" title="Get the Unicode/UTF-32 representation of a keysym.">xkb_keysym_to_utf32()</a></span>.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-080--2017-12-15"></a>
libxkbcommon 0.8.0 – 2017-12-15</h1>
<ul>
<li>Added <span class="tt">xkb_keysym_to_{upper,lower}</span> to perform case-conversion directly on keysyms. This is useful in some odd cases, but working with the Unicode representations should be preferred when possible.</li>
<li>Added Unicode conversion rules for the <span class="tt">signifblank</span> and <span class="tt">permille</span> keysyms.</li>
<li><p class="startli">Fixed a bug in the parsing of XKB key type definitions where the number of levels were determined by the number of level <em>names</em>. Keymaps which omit level names were hence miscompiled.</p>
<p class="startli">This regressed in version 0.4.3. Keymaps from <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config/">xkeyboard-config</a> were not affected since they don’t omit level names.</p>
</li>
<li>New API: <span class="tt"><a class="el" href="group__keysyms.html#ga616148547139853f6f413c9c0720780d" title="Convert a keysym to its uppercase form.">xkb_keysym_to_upper()</a></span> <span class="tt"><a class="el" href="group__keysyms.html#gaf888d4d0f209222fe9c0b7b324fd90ca" title="Convert a keysym to its lowercase form.">xkb_keysym_to_lower()</a></span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-072--2017-08-04"></a>
libxkbcommon 0.7.2 – 2017-08-04</h1>
<ul>
<li><p class="startli">Added a Meson build system as an alternative to existing autotools build system.</p>
<p class="startli">The intent is to remove the autotools build in one of the next releases. Please try to convert to it and report any problems.</p>
<p class="startli">See <a href="http://mesonbuild.com/Quick-guide.html">http://mesonbuild.com/Quick-guide.html</a> for basic usage, the <span class="tt">meson_options.txt</span> for the project-specific configuration options, and the PACKAGING file for more details.</p>
<p class="startli">There are some noteworthy differences compared to the autotools build:</p><ul>
<li>Feature auto-detection is not performed. By default, all features are enabled (currently: <span class="tt">docs</span>, <span class="tt"><a class="el" href="group__x11.html" title="Additional X11 support for xkbcommon.">X11 support</a></span>, <span class="tt">wayland</span>). The build fails if any of the required dependencies are not available. To disable a feature, pass <span class="tt">-Denable-&lt;feature&gt;=false</span> to meson.</li>
<li>The libraries are either installed as shared or static, as specified by the <span class="tt">-Ddefault_library=shared/static</span> option. With autotools, both versions are installed by default.</li>
<li><span class="tt">xorg-util-macros</span> is not used.</li>
<li>A parser generator (bison/byacc) is always required - there is no fallback to pre-generated output bundled in the tarball, as there is in autotools.</li>
</ul>
</li>
<li>Removed <span class="tt">Android.mk</span> support.</li>
<li>Removed the <span class="tt">*-uninstalled.pc</span> pkgconfig files.</li>
<li>Ported the <span class="tt">interactive-wayland</span> demo program to v6 of the <span class="tt">xdg-shell</span> protocol.</li>
<li>Added new keysym definitions from xproto.</li>
<li>New API: <span class="tt">XKB_KEY_XF86Keyboard</span> <span class="tt">XKB_KEY_XF86WWAN</span> <span class="tt">XKB_KEY_XF86RFKill</span> <span class="tt">XKB_KEY_XF86AudioPreset</span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-071--2017-01-18"></a>
libxkbcommon 0.7.1 – 2017-01-18</h1>
<ul>
<li><p class="startli">Fixed various reported problems when the current locale is <span class="tt">tr_TR.UTF-8</span>.</p>
<p class="startli">The function <span class="tt"><a class="el" href="group__keysyms.html#gadf335e065050f306ff9094aefa6c9736" title="Get a keysym from its name.">xkb_keysym_from_name()</a></span> used to perform case-insensitive string comparisons in a locale-dependent way, but required it to to work as in the C/ASCII locale (the so called “Turkish i problem”).</p>
<p class="startli">The function is now no longer affected by the current locale.</p>
</li>
<li>Fixed compilation in NetBSD.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-070--2016-11-11"></a>
libxkbcommon 0.7.0 – 2016-11-11</h1>
<ul>
<li><p class="startli">Added support for different “modes” of calculating consumed modifiers. The existing mode, based on the XKB standard, has proven to be unintuitive in various shortcut implementations.</p>
<p class="startli">A new mode, based on the calculation used by the GTK toolkit, is added. This mode is less eager to declare a modifier as consumed.</p>
</li>
<li>Added a new interactive demo program using the Wayland protocol. See the PACKAGING file for the new (optional) test dependencies.</li>
<li>Fixed a compilation error on GNU Hurd.</li>
<li>New API: <span class="tt">enum <a class="el" href="group__state.html#ga66c3ae7ebaf4ccd60e5dab61dc1c29fb" title="Consumed modifiers mode.">xkb_consumed_mode</a></span> <span class="tt"><a class="el" href="group__state.html#gga66c3ae7ebaf4ccd60e5dab61dc1c29fba14b9cdb7b905f3fdd7b0abcae2f597b1" title="This is the mode defined in the XKB specification and used by libX11.">XKB_CONSUMED_MODE_XKB</a></span> <span class="tt"><a class="el" href="group__state.html#gga66c3ae7ebaf4ccd60e5dab61dc1c29fba5e01146412303501dc7db2c2cf5c48d4" title="This is the mode used by the GTK+ toolkit.">XKB_CONSUMED_MODE_GTK</a></span> <span class="tt">xkb_state_key_get_consumed_mods2()</span> <span class="tt">xkb_state_mod_index_is_consumed2()</span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-061--2016-04-08"></a>
libxkbcommon 0.6.1 – 2016-04-08</h1>
<ul>
<li>Added LICENSE to distributed files in tarball releases.</li>
<li>Minor typo fix in <span class="tt">xkb_keymap_get_as_string()</span> documentation.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-060--2016-03-16"></a>
libxkbcommon 0.6.0 – 2016-03-16</h1>
<ul>
<li>If the <span class="tt">XKB_CONFIG_ROOT</span> environment variable is set, it is used as the XKB configuration root instead of the path determined at build time.</li>
<li>Tests and benchmarks now build correctly on OSX.</li>
<li><p class="startli">An XKB keymap provides a name for each key it defines. Traditionally, these names are limited to at most 4 characters, and are thus somewhat obscure, but might still be useful (xkbcommon lifts the 4 character limit).</p>
<p class="startli">The new functions <span class="tt">xkb_keymap_key_get_name()</span> and <span class="tt">xkb_keymap_key_by_name()</span> can be used to get the name of a key or find a key by name. Note that a key may have aliases.</p>
</li>
<li>Documentation improvements.</li>
<li>New API: <span class="tt">xkb_keymap_key_by_name()</span> <span class="tt">xkb_keymap_key_get_name()</span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-050--2014-10-18"></a>
libxkbcommon 0.5.0 – 2014-10-18</h1>
<ul>
<li>Added support for Compose/dead keys in a new module (included in libxkbcommon). See the documentation or the <span class="tt"><a class="el" href="xkbcommon-compose_8h.html" title="libxkbcommon Compose API - support for Compose and dead-keys.">xkbcommon/xkbcommon-compose.h</a></span> header file for more details.</li>
<li>Improved and reordered some sections of the documentation.</li>
<li>The doxygen HTML pages were made nicer to read.</li>
<li>Most tests now run also on non-linux platforms.</li>
<li>A warning is emitted by default about RMLVO values which are not used during keymap compilation, which are most often a user misconfiguration. For example, <span class="tt">terminate:ctrl_alt_backspace</span> instead of <span class="tt">terminate:ctrl_alt_bksp</span>.</li>
<li>Added symbol versioning for libxkbcommon and libxkbcommon-x11. Note: binaries compiled against this and future versions will not be able to link against the previous versions of the library.</li>
<li><p class="startli">Removed several compatablity symbols from the binary (the API isn’t affected). This affects binaries which</p><ol type="1">
<li>Were compiled against a pre-stable (&lt;0.2.0) version of libxkbcommon, and</li>
<li>Are linked against the this or later version of libxkbcommon.</li>
</ol>
<p class="startli">Such a scenario is likely to fail already.</p>
</li>
<li>If Xvfb is not available, the x11comp test is now correctly skipped instead of hanging.</li>
<li>Benchmarks were moved to a separate bench/ directory.</li>
<li>Build fixes from OpenBSD.</li>
<li>Fixed a bug where key type entries such as <span class="tt">map[None] = Level2;</span> were ignored.</li>
<li>New API: <span class="tt">XKB_COMPOSE_*</span> <span class="tt">xkb_compose_*</span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-043--2014-08-19"></a>
libxkbcommon 0.4.3 – 2014-08-19</h1>
<ul>
<li><p class="startli">Fixed a bug which caused <span class="tt">xkb_x11_keymap_new_from_device()</span> to misrepresent modifiers for some keymaps.</p>
<p class="startli"><a href="https://github.com/xkbcommon/libxkbcommon/issues/9">https://github.com/xkbcommon/libxkbcommon/issues/9</a></p>
</li>
<li>Fixed a bug which caused <span class="tt">xkb_x11_keymap_new_from_device()</span> to ignore XKB <span class="tt">PrivateAction</span>’s.</li>
<li>Modifiers are now always fully resolved after <span class="tt">xkb_state_update_mask()</span>. Previously the given state components were used as-is, without considering virtual modifier mappings. Note: this only affects non-standard uses of <span class="tt">xkb_state_update_mask()</span>.</li>
<li>Added a test for xkbcommon-x11, <span class="tt">x11comp</span>. The test uses the system’s Xvfb server and xkbcomp. If they do not exist or fail, the test is skipped.</li>
<li>Fixed memory leaks after parse errors in the XKB yacc parser. The fix required changes which are currently incompatible with byacc.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-042--2014-05-15"></a>
libxkbcommon 0.4.2 – 2014-05-15</h1>
<ul>
<li>Fixed a bug where explicitly passing <span class="tt">--enable-x11</span> to <span class="tt">./configure</span> would in fact disable it (regressed in 0.4.1).</li>
<li>Added <span class="tt">@since</span> version annotations to the API documentation for everything introduced after the initial stable release (0.2.0).</li>
<li>Added a section to the documentation about keysym transformations, and clarified which functions perform a given transformation.</li>
<li>XKB files which fail to compile during keymap construction can no longer have any effect on the resulting keymap: changes are only applied when the entire compilation succeeds. Note: this was a minor correctness issue inherited from xkbcomp.</li>
<li>Fix an out-of-bounds array access in <span class="tt">src/x11/util.c:adopt_atoms()</span> error-handling code. Note: it seems impossible to trigger in the current code since the input size cannot exceed the required size.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-041--2014-03-27"></a>
libxkbcommon 0.4.1 – 2014-03-27</h1>
<ul>
<li>Converted README to markdown and added a Quick Guide to the documentation, which breezes through the most common parts of xkbcommon.</li>
<li>Added two new functions, <span class="tt">xkb_state_key_get_utf{8,32}()</span>. They combine the operations of <span class="tt">xkb_state_key_get_syms()</span> and <span class="tt">xkb_keysym_to_utf{8,32}()</span>, and provide a nicer interface for it (especially for multiple-keysyms-per-level).</li>
<li><p class="startli">The <span class="tt">xkb_state_key_get_utf{8,32}()</span> functions now apply Control transformation: when the Control modifier is active, the string is converted to an appropriate control character. This matches the behavior of libX11’s <span class="tt">XLookupString(3)</span>, and required by the XKB specification: <a href="https://www.x.org/releases/current/doc/kbproto/xkbproto.html#Interpreting_the_Control_Modifier">https://www.x.org/releases/current/doc/kbproto/xkbproto.html#Interpreting_the_Control_Modifier</a></p>
<p class="startli"><a href="https://bugs.freedesktop.org/show_bug.cgi?id=75892">https://bugs.freedesktop.org/show_bug.cgi?id=75892</a></p>
</li>
<li>The consumed modifiers for a key are now calculated similarly to libX11. The previous behavior caused a bug where Shift would not cancel an active Caps Lock.</li>
<li><p class="startli">Make xkbcommon-x11 work with the keymap reported by the XQuartz X server.</p>
<p class="startli"><a href="https://bugs.freedesktop.org/show_bug.cgi?id=75798">https://bugs.freedesktop.org/show_bug.cgi?id=75798</a></p>
</li>
<li>Reduce memory usage during keymap compilation some more.</li>
<li>New API: <span class="tt">xkb_state_key_get_consumed_mods()</span> <span class="tt">xkb_state_key_get_utf8()</span> <span class="tt">xkb_state_key_get_utf32()</span></li>
<li>Deprecated API: <span class="tt">XKB_MAP_COMPILE_PLACEHOLDER,</span> <span class="tt">XKB_MAP_NO_FLAGS</span> use <span class="tt">XKB_KEYMAP_NO_FLAGS</span> instead.</li>
<li>Bug fixes.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-040--2014-02-02"></a>
libxkbcommon 0.4.0 – 2014-02-02</h1>
<ul>
<li>Add a new add-on library, <span class="tt">xkbcommon-x11</span>, to support creating keymaps with the XKB X11 protocol, by querying the X server directly. See the <span class="tt"><a class="el" href="xkbcommon-x11_8h.html" title="libxkbcommon-x11 API - Additional X11 support for xkbcommon.">xkbcommon/xkbcommon-x11.h</a></span> header file for more details. This library requires <span class="tt">libxcb-xkb &gt;= 1.10</span>, and is enabled by default. It can be disabled with the <span class="tt">--disable-x11</span> configure switch. Distributions are encouraged to split the necessary files for this library (<span class="tt">libxkbcommon-x11.so</span>, <span class="tt">xkbcommon-x11.pc</span>, <span class="tt"><a class="el" href="xkbcommon-x11_8h.html" title="libxkbcommon-x11 API - Additional X11 support for xkbcommon.">xkbcommon/xkbcommon-x11.h</a></span>) to a separate package, such that the main package does not depend on X11 libraries.</li>
<li>Fix the keysym ↔ name lookup table to not require huge amounts of relocations.</li>
<li>Fix a bug in the keysym ↔ name lookup, whereby lookup might fail in some rare cases.</li>
<li>Reduce memory usage during keymap compilation.</li>
<li>New API: New keysyms from xproto 7.0.25 (German T3 layout keysyms). <span class="tt"><a class="el" href="group__legacy-virtual-modifier-names.html#ga2b462af975ff990368ca7119d6ae8cd8" title="Usual real modifier for the virtual modifier NumLock.">XKB_MOD_NAME_NUM</a></span> for the usual NumLock modifier. <span class="tt">xkb_x11_*</span> types and functions, <span class="tt">XKB_X11_*</span> constants.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-032--2013-11-22"></a>
libxkbcommon 0.3.2 – 2013-11-22</h1>
<ul>
<li>Log messages from the library now look like <span class="tt">xkbcommon: ERROR</span> by default, instead of xkbcomp-like <span class="tt">Error:   </span>.</li>
<li>Apply capitalization transformation on keysyms in <span class="tt">xkb_keysym_get_one_sym()</span>, to match the behavior specified in the XKB specification: <a href="https://www.x.org/releases/current/doc/kbproto/xkbproto.html#Interpreting_the_Lock_Modifier">https://www.x.org/releases/current/doc/kbproto/xkbproto.html#Interpreting_the_Lock_Modifier</a></li>
<li>Support byacc for generating the parser, in addition to Bison.</li>
<li>New API: <span class="tt">XKB_KEY_XF86AudioMicMute</span> keysym from xproto 7.0.24. <span class="tt"><a class="el" href="group__keysyms.html#gga0b4e78037b911489b68fe8b2a11f5487aee9f9c3544dfdc3db42aa85e4f4d3f32" title="Do not apply any flags.">XKB_KEYSYM_NO_FLAGS</a></span> <span class="tt"><a class="el" href="group__context.html#ggaea2acb5b9e06239e20a7c34f5b223092a52382673b85690e1990796b1c9c20538" title="Do not apply any context flags.">XKB_CONTEXT_NO_FLAGS</a></span> <span class="tt">XKB_MAP_COMPILE_NO_FLAGS</span></li>
<li>Bug fixes.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-031--2013-06-03"></a>
libxkbcommon 0.3.1 – 2013-06-03</h1>
<ul>
<li>Replace the flex scanner with a hand-written one. flex is no longer a build requirement.</li>
<li>New API: <span class="tt">xkb_keymap_min_keycode()</span> <span class="tt">xkb_keymap_max_keycode()</span> <span class="tt">xkb_keymap_key_for_each()</span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="libxkbcommon-030--2013-04-01"></a>
libxkbcommon 0.3.0 – 2013-04-01</h1>
<ul>
<li>Allow passing NULL to <span class="tt">*_unref()</span> functions; do nothing instead of crashing.</li>
<li>The functions <span class="tt">xkb_keymap_num_levels_for_key()</span> and <span class="tt">xkb_keymap_get_syms_by_level()</span> now allow out-of-range values for the <span class="tt">layout</span> parameter. The functions now wrap the value around the number of layouts instead of failing.</li>
<li>The function <span class="tt"><a class="el" href="group__keysyms.html#ga2a06b575bfc0fef9655bb7f860737965" title="Get the name of a keysym.">xkb_keysym_get_name()</a></span> now types unicode keysyms in uppercase and 0-padding, to match the format used by <span class="tt">XKeysymToString()</span>.</li>
<li>Building Linux-specific tests is no longer attempted on non-Linux environments.</li>
<li>The function <span class="tt">xkb_keymap_new_from_names()</span> now accepts a NULL value for the <span class="tt">names</span> parameter, instead of failing. This is equivalent to passing a <span class="tt">struct <a class="el" href="structxkb__rule__names.html" title="Names to compile a keymap with, also known as RMLVO.">xkb_rule_names</a></span> with all fields set to NULL.</li>
<li>New API: <span class="tt">xkb_keymap_new_from_buffer()</span></li>
<li>Bug fixes.   </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
