<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libxkbcommon: Frequently Asked Question (FAQ)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libxkbcommon<span id="projectnumber">&#160;1.12.2</span>
   </div>
   <div id="projectbrief">Library implementing the XKB specification for parsing                           keyboard descriptions and handling keyboard state</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Frequently Asked Question (FAQ) </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#xkb">XKB </a>
    <ul>
      <li class="level2">
        <a href="#what-is-xkb">What is XKB? </a>
      </li>
      <li class="level2">
        <a href="#what-does--mean">What does â€¦ mean? </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#keyboard-layout">Keyboard layout </a>
    <ul>
      <li class="level2">
        <a href="#where-are-the-keyboard-layouts-defined">Where are the keyboard layouts defined? </a>
      </li>
      <li class="level2">
        <a href="#why-do-my-keyboard-shortcuts-not-work-properly">Why do my keyboard shortcuts not work properly? </a>
      </li>
      <li class="level2">
        <a href="#why-does-my-key-combination-to-switch-between-layouts-not-work">Why does my key combination to switch between layouts not work? </a>
      </li>
      <li class="level2">
        <a href="#why-does-my-keyboard-layout-not-work-as-expected">Why does my keyboard layout not work as expected? </a>
      </li>
      <li class="level2">
        <a href="#how-do-i-customize-my-layout">How do I customize my layout? </a>
      </li>
      <li class="level2">
        <a href="#how-do-i-test-my-custom-layout-without-installing-it">How do I test my custom layout without installing it? </a>
      </li>
      <li class="level2">
        <a href="#how-do-i-swap-some-keys">How do I swap some keys? </a>
      </li>
      <li class="level2">
        <a href="#how-do-i-break-a-latch-before-triggering-another-latch-or-lock">How do I break a latch before triggering another latch or lock? </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#legacy-x-tools-replacement">Legacy X tools replacement </a>
    <ul>
      <li class="level2">
        <a href="#xmodmap">xmodmap </a>
      </li>
      <li class="level2">
        <a href="#setxkbmap">setxkbmap </a>
      </li>
      <li class="level2">
        <a href="#xkbcomp">xkbcomp </a>
      </li>
      <li class="level2">
        <a href="#xev">xev </a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#api-1">API </a>
    <ul>
      <li class="level2">
        <a href="#modifiers">Modifiers </a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_2faq"></a></p>
<h1 class="doxsection"><a class="anchor" id="xkb"></a>
XKB</h1>
<h2 class="doxsection"><a class="anchor" id="what-is-xkb"></a>
What is XKB?</h2>
<p>See: <a class="el" href="xkb-intro.html#md_doc_2introduction-to-xkb">Introduction to XKB</a>.</p>
<h2 class="doxsection"><a class="anchor" id="what-does--mean"></a>
What does â€¦ mean?</h2>
<p>See: <a class="el" href="keymap-text-format-v1-v2.html#terminology">terminology</a>.</p>
<h1 class="doxsection"><a class="anchor" id="keyboard-layout"></a>
Keyboard layout</h1>
<h2 class="doxsection"><a class="anchor" id="where-are-the-keyboard-layouts-defined"></a>
Where are the keyboard layouts defined?</h2>
<p>The xkbcommon project does not provide keyboard layouts. See the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> project for further information.</p>
<h2 class="doxsection"><a class="anchor" id="why-do-my-keyboard-shortcuts-not-work-properly"></a>
Why do my keyboard shortcuts not work properly?</h2>
<ul>
<li>ðŸš§ TODO: Setups with multiple layout and/or non-Latin keyboard layouts may have some issues.</li>
<li>ðŸš§ TODO: <a href="https://github.com/xkbcommon/libxkbcommon/issues/420">#420</a></li>
</ul>
<h2 class="doxsection"><a class="anchor" id="why-does-my-key-combination-to-switch-between-layouts-not-work"></a>
Why does my key combination to switch between layouts not work?</h2>
<p>See <a href="https://github.com/xkbcommon/libxkbcommon/issues/420">this issue</a>.</p>
<h2 class="doxsection"><a class="anchor" id="why-does-my-keyboard-layout-not-work-as-expected"></a>
Why does my keyboard layout not work as expected?</h2>
<p>There could be many reasons!</p>
<dl>
<dt>There is an issue with your keyboard layout database </dt>
<dd><p class="startdd">libxkbcommon may not be able to load your configuration due to an issue (file not found, syntax error, unsupported keysym, etc.). Please use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a> to get further information.</p>
<p class="enddd">Note that the xkbcommon project does not provide keyboard layouts. See the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> project for further information.  </p>
</dd>
<dt>Diacritics/accents do not work </dt>
<dd><p class="startdd">This is most probably an issue with your <em>Compose</em> configuration. If you customized it, do not forget to restart your session before trying it.</p>
<p class="enddd">Please use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a> with the option <span class="tt">--enable-compose</span> to get further information.  </p>
</dd>
<dt>The application you use does not handle the keyboard properly </dt>
<dd>Please use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a> to ensure that it is specific to the application.  </dd>
<dt>Your keyboard layout uses features not supported by libxkbcommon </dt>
<dd>See: <a class="el" href="xkbcommon-compatibility.html#md_doc_2compatibility">compatibility</a> </dd>
<dt>None of the previous </dt>
<dd>If none of the previous is conclusive, then this may an issue with libxkbcommon. Please use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a> to provide the maximum information (setup, log, expected/got results) and file a <a href="https://github.com/xkbcommon/libxkbcommon/issues/new">bug report</a>!  </dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="how-do-i-customize-my-layout"></a>
How do I customize my layout?</h2>
<p>This project does not provide any keyboard layout database:</p><ul>
<li>If you want to modify only your <em>local</em> keyboard configuration, see: <a class="el" href="user-configuration.html#md_doc_2user-configuration">User-configuration</a>.</li>
<li>If you want to modify the standard keyboard layout database, please first try it <em>locally</em> (see our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a>) and then file an issue or a merge request at the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> project.</li>
</ul>
<p>See also the <a class="el" href="keymap-text-format-v1-v2.html#md_doc_2keymap-text-format-v1-v2">keymap text format</a> documentation for the syntax.</p>
<h2 class="doxsection"><a class="anchor" id="how-do-i-test-my-custom-layout-without-installing-it"></a>
How do I test my custom layout without installing it?</h2>
<p>Use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a>.</p>
<h2 class="doxsection"><a class="anchor" id="how-do-i-swap-some-keys"></a>
How do I swap some keys?</h2>
<p>ðŸš§ TODO</p>
<h2 class="doxsection"><a class="anchor" id="how-do-i-break-a-latch-before-triggering-another-latch-or-lock"></a>
How do I break a latch before triggering another latch or lock?</h2>
<p>Consider the following use cases:</p><ol type="1">
<li>If <span class="tt">Caps_Lock</span> is on the second level of some key, and <span class="tt">Shift</span> is latched, pressing the key locks <span class="tt">Caps</span> while also breaking the <span class="tt">Shift</span> latch, ensuring that the next character is properly uppercase.</li>
<li>On the German E1 layout, <span class="tt">ISO_Level5_Latch</span> is on the third level of <span class="tt">&lt;AC04&gt;</span>. So if a level 3 latch (typically on <span class="tt">&lt;RALT&gt;</span>) is used to access it, the level 5 must break the previous level 3 latch, else both latches would be active: the effective level would be 7 instead of the intended 5.</li>
</ol>
<p>Both uses cases can be implemented using the following features:</p><ul>
<li>explicit action;</li>
<li>multiple actions per level;</li>
<li><span class="tt">VoidAction()</span>: to break latches.</li>
</ul>
<p>Patch that fixes the first use case:</p>
<div class="fragment"><div class="line">--- old</div>
<div class="line">+++ new</div>
<div class="line">  key &lt;LFSH&gt; {</div>
<div class="line">      [ISO_Level2_Latch, Caps_Lock],</div>
<div class="line">+     [LatchMods(modifiers=Shift,latchToLock,clearLocks),</div>
<div class="line">+      {VoidAction(), LockMods(modifiers=Lock)}],</div>
<div class="line">      type=\&quot;ALPHABETIC\&quot;</div>
<div class="line">  };</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="legacy-x-tools-replacement"></a>
Legacy X tools replacement</h1>
<h2 class="doxsection"><a class="anchor" id="xmodmap"></a>
xmodmap</h2>
<dl>
<dt><span class="tt">xmodmap -pm</span> </dt>
<dd><p class="startdd"></p>
<p class="interdd">There is no strict equivalent. Since 1.10 <span class="tt">xkbcli compile-keymap</span> has the option <span class="tt">--modmaps</span> to print the modifiers maps from a keymap, but it does not print keysyms. In order to get the output for the current keymap, use it with <span class="tt">xkbcli dump-keymap-*</span>:</p>
<dl>
<dt>Automatic session type detection </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap | xkbcli compile-keymap --modmaps</div>
</div><!-- fragment -->  </dd>
<dt>Wayland session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap-wayland | xkbcli compile-keymap --modmaps</div>
</div><!-- fragment -->  </dd>
<dt>X11 session / XWayland </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap-x11 | xkbcli compile-keymap --modmaps</div>
</div><!-- fragment -->  </dd>
</dl>
</dd>
<dt><span class="tt">xmodmap -e "â€¦"</span> </dt>
<dd></dd>
<dt><span class="tt">xmodmap /path/to/file</span> </dt>
<dd>No equivalent: <span class="tt">xkbcli</span> does not modify the display server keymap. </dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="setxkbmap"></a>
setxkbmap</h2>
<dl>
<dt><span class="tt">setxkbmap -print -layout â€¦</span></dt>
<dd></dd>
<dt></dt>
<dd><p class="startdd"></p>
<p class="interdd">Since 1.9 one can use the <span class="tt">--kccgst</span> option:</p>
<div class="fragment"><div class="line">xkbcli compile-keymap --kccgst --layout â€¦</div>
</div><!-- fragment -->  </dd>
<dt><span class="tt">setxkbmap -query</span> </dt>
<dd><p class="startdd"></p>
<p class="enddd">No equivalent: <span class="tt">xkbcli</span> only query <em>raw</em> keymaps and has no access to the original <a class="el" href="xkb-intro.html#RMLVO-intro">RMLVO</a> settings.  </p>
</dd>
<dt><span class="tt">setxkbmap -layout â€¦</span> </dt>
<dd><p class="startdd">No equivalent: <span class="tt">xkbcli</span> does not modify the display server keymap. One must use the tools <em>specific</em> to each display server in order order to achieve it.</p>
<p class="enddd">If you use a custom layout, please have a look at <a class="el" href="user-configuration.html">User-configuration</a>, which enables making custom layouts <em>discoverable</em> by keyboard configuration GUI.  </p>
</dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="xkbcomp"></a>
xkbcomp</h2>
<dl>
<dt><span class="tt">xkbcomp -xkb /path/to/keymap/file -</span> </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli compile-keymap --keymap /path/to/keymap/file</div>
</div><!-- fragment -->  </dd>
<dt><span class="tt">xkbcomp -xkb $DISPLAY -</span> </dt>
<dd><p class="startdd"></p>
<dl>
<dt>Automatic session type detection </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap</div>
</div><!-- fragment -->  </dd>
<dt>Wayland session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap-wayland</div>
</div><!-- fragment -->  </dd>
<dt>X11 session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap-x11</div>
</div><!-- fragment -->  </dd>
</dl>
</dd>
<dt><span class="tt">xkbcomp - $DISPLAY</span> </dt>
<dd></dd>
<dt><span class="tt">xkbcomp /path/to/keymap/file $DISPLAY</span> </dt>
<dd><p class="startdd"></p>
<p class="enddd">No equivalent: <span class="tt">xkbcli</span> does not modify the display server keymap. One must use the tools <em>specific</em> to each display server in order order to achieve it. Please have a look at <a class="el" href="user-configuration.html">User-configuration</a>, which enables making custom layouts <em>discoverable</em> by keyboard configuration GUI.  </p>
</dd>
</dl>
<h2 class="doxsection"><a class="anchor" id="xev"></a>
xev</h2>
<dl>
<dt><span class="tt">xev -event keyboard</span> </dt>
<dd><dl>
<dt>Automatic session type detection </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli interactive</div>
</div><!-- fragment -->  </dd>
<dt>Wayland session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli interactive-wayland</div>
</div><!-- fragment -->  </dd>
<dt>X11 session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli interactive-x11</div>
</div><!-- fragment -->  </dd>
</dl>
</dd>
</dl>
<h1 class="doxsection"><a class="anchor" id="api-1"></a>
API</h1>
<h2 class="doxsection"><a class="anchor" id="modifiers"></a>
Modifiers</h2>
<h3 class="doxsection"><a class="anchor" id="how-to-get-the-virtual-modifier-encoding"></a>
How to get the virtual modifier encoding?</h3>
<p>The <a class="el" href="keymap-text-format-v1-v2.html#virtual-modifier-def">virtual modifiers</a> encoding, (also: mappings to <a class="el" href="keymap-text-format-v1-v2.html#real-modifier-def">real modifiers</a> in X11 jargon) is an implementation detail. However, some applications may require it in order to interface with legacy code.</p>
<h4 class="doxsection"><a class="anchor" id="libxkbcommon--110"></a>
libxkbcommon â‰¥ 1.10</h4>
<p>Use the dedicated functions <span class="tt"><a class="el" href="group__components.html#ga5054d57a49a205cee0a01f4079f2fbf7" title="Get the encoding of a modifier by name.">xkb_keymap::xkb_keymap_mod_get_mask()</a></span> (since 1.10) and <span class="tt"><a class="el" href="group__components.html#ga8f0ed9a71665e1260b7ad509693b1689" title="Get the encoding of a modifier by index.">xkb_keymap::xkb_keymap_mod_get_mask2()</a></span> (since 1.11).</p>
<h4 class="doxsection"><a class="anchor" id="libxkbcommon--19"></a>
libxkbcommon â‰¤ 1.9</h4>
<p>Use the following snippet:</p>
<div class="fragment"><div class="line"><span class="comment">// Find the real modifier mapping of the virtual modifier `LevelThree`</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="xkbcommon_8h.html">xkbcommon/xkbcommon.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="xkbcommon-names_8h.html">xkbcommon/xkbcommon-names.h</a>&gt;</span></div>
<div class="line"><span class="keyword">const</span> <a class="code hl_typedef" href="xkbcommon_8h.html#a638bf7a52db06f383ce5a4ef99dfe539">xkb_mod_index_t</a> levelThree_idx = xkb_keymap_mod_get_index(keymap, <a class="code hl_define" href="group__virtual-modifier-names.html#gab7e939dd1d78f2abbee84ef149221eae">XKB_VMOD_NAME_LEVEL3</a>);</div>
<div class="line"><span class="keyword">const</span> <a class="code hl_typedef" href="xkbcommon_8h.html#a41b3ee62ae73ec041b68165bf97869e8">xkb_mod_mask_t</a> levelThree = UINT32_C(1) &lt;&lt; levelThree_idx;</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structxkb__state.html">xkb_state</a>* state = <a class="code hl_function" href="group__state.html#ga7981d274ae2e1d720bd55e0d81a4da5c">xkb_state_new</a>(keymap);</div>
<div class="line">assert(state); <span class="comment">// Please handle error properly</span></div>
<div class="line"><a class="code hl_function" href="group__state.html#gae59cdbcc380013e9f12db359728fa098">xkb_state_update_mask</a>(state, levelThree, 0, 0, 0, 0, 0);</div>
<div class="line"><span class="keyword">const</span> <a class="code hl_typedef" href="xkbcommon_8h.html#a41b3ee62ae73ec041b68165bf97869e8">xkb_mod_mask_t</a> levelThree_mapping = <a class="code hl_function" href="group__state.html#gacfdacf066f449b36550e366b398effb8">xkb_state_serialize_mods</a>(state, <a class="code hl_enumvalue" href="group__state.html#gga04e8eac0666cc64dee6f0d5a7a773a03a2357b9f2490e89ab2d549695ea49de4f">XKB_STATE_MODS_EFFECTIVE</a>);</div>
<div class="line"><a class="code hl_function" href="group__state.html#ga3f905c1383b32dcceb5feb9b9fdd0ce4">xkb_state_unref</a>(state);</div>
<div class="ttc" id="agroup__state_html_ga3f905c1383b32dcceb5feb9b9fdd0ce4"><div class="ttname"><a href="group__state.html#ga3f905c1383b32dcceb5feb9b9fdd0ce4">xkb_state::xkb_state_unref</a></div><div class="ttdeci">XKB_EXPORT void xkb_state_unref(struct xkb_state *state)</div><div class="ttdoc">Release a reference on a keyboard state object, and possibly free it.</div></div>
<div class="ttc" id="agroup__state_html_ga7981d274ae2e1d720bd55e0d81a4da5c"><div class="ttname"><a href="group__state.html#ga7981d274ae2e1d720bd55e0d81a4da5c">xkb_state::xkb_state_new</a></div><div class="ttdeci">XKB_EXPORT struct xkb_state * xkb_state_new(struct xkb_keymap *keymap)</div><div class="ttdoc">Create a new keyboard state object.</div></div>
<div class="ttc" id="agroup__state_html_gacfdacf066f449b36550e366b398effb8"><div class="ttname"><a href="group__state.html#gacfdacf066f449b36550e366b398effb8">xkb_state::xkb_state_serialize_mods</a></div><div class="ttdeci">XKB_EXPORT xkb_mod_mask_t xkb_state_serialize_mods(struct xkb_state *state, enum xkb_state_component components)</div><div class="ttdoc">The counterpart to xkb_state::xkb_state_update_mask() for modifiers, to be used on the server side of...</div></div>
<div class="ttc" id="agroup__state_html_gae59cdbcc380013e9f12db359728fa098"><div class="ttname"><a href="group__state.html#gae59cdbcc380013e9f12db359728fa098">xkb_state::xkb_state_update_mask</a></div><div class="ttdeci">XKB_EXPORT enum xkb_state_component xkb_state_update_mask(struct xkb_state *state, xkb_mod_mask_t depressed_mods, xkb_mod_mask_t latched_mods, xkb_mod_mask_t locked_mods, xkb_layout_index_t depressed_layout, xkb_layout_index_t latched_layout, xkb_layout_index_t locked_layout)</div><div class="ttdoc">Update a keyboard state from a set of explicit masks.</div></div>
<div class="ttc" id="agroup__state_html_gga04e8eac0666cc64dee6f0d5a7a773a03a2357b9f2490e89ab2d549695ea49de4f"><div class="ttname"><a href="group__state.html#gga04e8eac0666cc64dee6f0d5a7a773a03a2357b9f2490e89ab2d549695ea49de4f">XKB_STATE_MODS_EFFECTIVE</a></div><div class="ttdeci">@ XKB_STATE_MODS_EFFECTIVE</div><div class="ttdoc">Effective modifiers, i.e.</div><div class="ttdef"><b>Definition</b> xkbcommon.h:1858</div></div>
<div class="ttc" id="agroup__virtual-modifier-names_html_gab7e939dd1d78f2abbee84ef149221eae"><div class="ttname"><a href="group__virtual-modifier-names.html#gab7e939dd1d78f2abbee84ef149221eae">XKB_VMOD_NAME_LEVEL3</a></div><div class="ttdeci">#define XKB_VMOD_NAME_LEVEL3</div><div class="ttdef"><b>Definition</b> xkbcommon-names.h:60</div></div>
<div class="ttc" id="astructxkb__state_html"><div class="ttname"><a href="structxkb__state.html">xkb_state</a></div><div class="ttdoc">Opaque keyboard state object.</div></div>
<div class="ttc" id="axkbcommon-names_8h_html"><div class="ttname"><a href="xkbcommon-names_8h.html">xkbcommon-names.h</a></div><div class="ttdoc">Predefined names for common modifiers and LEDs.</div></div>
<div class="ttc" id="axkbcommon_8h_html"><div class="ttname"><a href="xkbcommon_8h.html">xkbcommon.h</a></div><div class="ttdoc">Main libxkbcommon API.</div></div>
<div class="ttc" id="axkbcommon_8h_html_a41b3ee62ae73ec041b68165bf97869e8"><div class="ttname"><a href="xkbcommon_8h.html#a41b3ee62ae73ec041b68165bf97869e8">xkb_mod_mask_t</a></div><div class="ttdeci">uint32_t xkb_mod_mask_t</div><div class="ttdoc">A mask of modifier indices.</div><div class="ttdef"><b>Definition</b> xkbcommon.h:226</div></div>
<div class="ttc" id="axkbcommon_8h_html_a638bf7a52db06f383ce5a4ef99dfe539"><div class="ttname"><a href="xkbcommon_8h.html#a638bf7a52db06f383ce5a4ef99dfe539">xkb_mod_index_t</a></div><div class="ttdeci">uint32_t xkb_mod_index_t</div><div class="ttdoc">Index of a modifier.</div><div class="ttdef"><b>Definition</b> xkbcommon.h:224</div></div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="how-to-get-the-keys-that-trigger-modifiers"></a>
How to get the keys that trigger modifiers?</h3>
<p>There is no dedicated API, since the use cases are too diverse or niche. Nevertheless, the following snippet provide a minimal example to achieve it.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="xkbcommon_8h.html">xkbcommon/xkbcommon.h</a>&gt;</span></div>
<div class="line"><span class="keyword">static</span> ssize_t</div>
<div class="line">xkb_keymap_mod_get_codes(<span class="keyword">struct</span> <a class="code hl_struct" href="structxkb__keymap.html">xkb_keymap</a> *keymap, <a class="code hl_typedef" href="xkbcommon_8h.html#a638bf7a52db06f383ce5a4ef99dfe539">xkb_mod_index_t</a> mod,</div>
<div class="line">                         <a class="code hl_typedef" href="xkbcommon_8h.html#ac29aee92124c08d1953910ab28ee1997">xkb_keycode_t</a> *codes_out, <span class="keywordtype">size_t</span> codes_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (mod &gt;= xkb_keymap_num_mods(keymap))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    ssize_t idx = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="xkbcommon_8h.html#ac29aee92124c08d1953910ab28ee1997">xkb_keycode_t</a> k = xkb_keymap_min_keycode(keymap);</div>
<div class="line">         k &lt;= xkb_keymap_max_keycode(keymap) &amp;&amp; idx &gt;= 0; k++) {</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * We only test the first level of the first group.</span></div>
<div class="line"><span class="comment">         *</span></div>
<div class="line"><span class="comment">         * Since there is currently no way to reset the state, use a new one to</span></div>
<div class="line"><span class="comment">         * avoid side effects (latches, etc.)</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keyword">struct </span><a class="code hl_struct" href="structxkb__state.html">xkb_state</a> * <span class="keyword">const</span> state = <a class="code hl_function" href="group__state.html#ga7981d274ae2e1d720bd55e0d81a4da5c">xkb_state_new</a>(keymap);</div>
<div class="line">        assert(state);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code hl_enumeration" href="group__state.html#ga631f03db07f30774659ab3f787b152e7">xkb_key_direction</a> directions[] = {</div>
<div class="line">            <a class="code hl_enumvalue" href="group__state.html#gga631f03db07f30774659ab3f787b152e7a10b02b45f1fceae1b43bc69162f84678">XKB_KEY_DOWN</a>,</div>
<div class="line">            <a class="code hl_enumvalue" href="group__state.html#gga631f03db07f30774659ab3f787b152e7aa685cb474cd090014d1049f74c3e3ec5">XKB_KEY_UP</a></div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> d = 0; d &lt; ARRAY_SIZE(directions); d++) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_function" href="group__state.html#ga3134cc3645cea6063bfb7e27d9a24d58">xkb_state_update_key</a>(state, k, directions[d]) &amp;&amp;</div>
<div class="line">                <a class="code hl_function" href="group__state.html#gaa856e0ad47b0aaa0240a5afe9963f835">xkb_state_mod_index_is_active</a>(state, mod,</div>
<div class="line">                                              <a class="code hl_enumvalue" href="group__state.html#gga04e8eac0666cc64dee6f0d5a7a773a03a2357b9f2490e89ab2d549695ea49de4f">XKB_STATE_MODS_EFFECTIVE</a>)) {</div>
<div class="line">                <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>) idx &lt; codes_size) {</div>
<div class="line">                    assert(idx &lt; (ssize_t) (SIZE_MAX / 2));</div>
<div class="line">                    codes_out[idx++] = k;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    idx = -2;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="group__state.html#ga3f905c1383b32dcceb5feb9b9fdd0ce4">xkb_state_unref</a>(state);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> idx;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
