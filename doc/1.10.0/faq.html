<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libxkbcommon: Frequently Asked Question (FAQ)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libxkbcommon<span id="projectnumber">&#160;1.10.0</span>
   </div>
   <div id="projectbrief">Library implementing the XKB specification for parsing                           keyboard descriptions and handling keyboard state</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Frequently Asked Question (FAQ)</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#xkb">XKB</a>
    <ul>
      <li class="level2">
        <a href="#what-is-xkb">What is XKB?</a>
      </li>
      <li class="level2">
        <a href="#what-does--mean">What does â€¦ mean?</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#keyboard-layout">Keyboard layout</a>
    <ul>
      <li class="level2">
        <a href="#where-are-the-keyboard-layouts-defined">Where are the keyboard layouts defined?</a>
      </li>
      <li class="level2">
        <a href="#why-do-my-keyboard-shortcuts-not-work-properly">Why do my keyboard shortcuts not work properly?</a>
      </li>
      <li class="level2">
        <a href="#why-does-my-key-combination-to-switch-between-layouts-not-work">Why does my key combination to switch between layouts not work?</a>
      </li>
      <li class="level2">
        <a href="#why-does-my-keyboard-layout-not-work-as-expected">Why does my keyboard layout not work as expected?</a>
      </li>
      <li class="level2">
        <a href="#how-do-i-customize-my-layout">How do I customize my layout?</a>
      </li>
      <li class="level2">
        <a href="#how-do-i-test-my-custom-layout-without-installing-it">How do I test my custom layout without installing it?</a>
      </li>
      <li class="level2">
        <a href="#how-do-i-swap-some-keys">How do I swap some keys?</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#legacy-x-tools-replacement">Legacy X tools replacement</a>
    <ul>
      <li class="level2">
        <a href="#xmodmap">xmodmap</a>
      </li>
      <li class="level2">
        <a href="#setxkbmap">setxkbmap</a>
      </li>
      <li class="level2">
        <a href="#xkbcomp">xkbcomp</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#api-1">API</a>
    <ul>
      <li class="level2">
        <a href="#modifiers">Modifiers</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_2faq"></a></p>
<h1><a class="anchor" id="xkb"></a>
XKB</h1>
<h2><a class="anchor" id="what-is-xkb"></a>
What is XKB?</h2>
<p>See: <a class="el" href="xkb-intro.html#md_doc_2introduction-to-xkb">Introduction to XKB</a>.</p>
<h2><a class="anchor" id="what-does--mean"></a>
What does â€¦ mean?</h2>
<p>See: <a class="el" href="keymap-text-format-v1.html#terminology">terminology</a>.</p>
<h1><a class="anchor" id="keyboard-layout"></a>
Keyboard layout</h1>
<h2><a class="anchor" id="where-are-the-keyboard-layouts-defined"></a>
Where are the keyboard layouts defined?</h2>
<p>The xkbcommon project does not provide keyboard layouts. See the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> project for further information.</p>
<h2><a class="anchor" id="why-do-my-keyboard-shortcuts-not-work-properly"></a>
Why do my keyboard shortcuts not work properly?</h2>
<ul>
<li>ðŸš§ TODO: Setups with multiple layout and/or non-Latin keyboard layouts may have some issues.</li>
<li>ðŸš§ TODO: <a href="https://github.com/xkbcommon/libxkbcommon/issues/420">#420</a></li>
</ul>
<h2><a class="anchor" id="why-does-my-key-combination-to-switch-between-layouts-not-work"></a>
Why does my key combination to switch between layouts not work?</h2>
<p>See <a href="https://github.com/xkbcommon/libxkbcommon/issues/420">this issue</a>.</p>
<h2><a class="anchor" id="why-does-my-keyboard-layout-not-work-as-expected"></a>
Why does my keyboard layout not work as expected?</h2>
<p>There could be many reasons!</p>
<dl>
<dt>There is an issue with your keyboard layout database </dt>
<dd><p class="startdd">libxkbcommon may not be able to load your configuration due to an issue (file not found, syntax error, unsupported keysym, etc.). Please use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a> to get further information.</p>
<p class="enddd">Note that the xkbcommon project does not provide keyboard layouts. See the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> project for further information.  </p>
</dd>
<dt>Diacritics/accents do not work </dt>
<dd><p class="startdd">This is most probably an issue with your <em>Compose</em> configuration. If you customized it, do not forget to restart your session before trying it.</p>
<p class="enddd">Please use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a> with the option <code>--enable-compose</code> to get further information.  </p>
</dd>
<dt>The application you use does not handle the keyboard properly </dt>
<dd>Please use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a> to ensure that it is specific to the application.  </dd>
<dt>Your keyboard layout uses features not supported by libxkbcommon </dt>
<dd>See: <a class="el" href="xkbcommon-compatibility.html#md_doc_2compatibility">compatibility</a> </dd>
<dt>None of the previous </dt>
<dd>If none of the previous is conclusive, then this may an issue with libxkbcommon. Please use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a> to provide the maximum information (setup, log, expected/got results) and file a <a href="https://github.com/xkbcommon/libxkbcommon/issues/new">bug report</a>!  </dd>
</dl>
<h2><a class="anchor" id="how-do-i-customize-my-layout"></a>
How do I customize my layout?</h2>
<p>This project does not provide any keyboard layout database:</p><ul>
<li>If you want to modify only your <em>local</em> keyboard configuration, see: <a class="el" href="user-configuration.html#md_doc_2user-configuration">User-configuration</a>.</li>
<li>If you want to modify the standard keyboard layout database, please first try it <em>locally</em> (see our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a>) and then file an issue or a merge request at the <a href="https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config">xkeyboard-config</a> project.</li>
</ul>
<p>See also the <a class="el" href="keymap-text-format-v1.html#md_doc_2keymap-format-text-v1">keymap text format</a> documentation for the syntax.</p>
<h2><a class="anchor" id="how-do-i-test-my-custom-layout-without-installing-it"></a>
How do I test my custom layout without installing it?</h2>
<p>Use our <a class="el" href="debugging.html#md_doc_2debugging">debugging tools</a>.</p>
<h2><a class="anchor" id="how-do-i-swap-some-keys"></a>
How do I swap some keys?</h2>
<p>ðŸš§ TODO</p>
<h1><a class="anchor" id="legacy-x-tools-replacement"></a>
Legacy X tools replacement</h1>
<h2><a class="anchor" id="xmodmap"></a>
xmodmap</h2>
<dl>
<dt><code>xmodmap -pm</code> </dt>
<dd><p class="startdd"></p>
<p class="interdd">There is no strict equivalent. Since 1.10 <code>xkbcli compile-keymap</code> has the option <code>--modmaps</code> to print the modifiers maps from a keymap, but it does not print keysyms. In order to get the output for the current keymap, use it with <code>xkbcli dump-keymap-*</code>:</p>
<dl>
<dt>Wayland session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap-wayland | xkbcli compile-keymap --modmaps</div>
</div><!-- fragment -->  </dd>
<dt>X11 session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap-x11 | xkbcli compile-keymap --modmaps</div>
</div><!-- fragment -->  </dd>
</dl>
</dd>
<dt><code>xmodmap -e "â€¦"</code> </dt>
<dd></dd>
<dt><code>xmodmap /path/to/file</code> </dt>
<dd>No equivalent: <code>xkbcli</code> does not modify the display server keymap. </dd>
</dl>
<h2><a class="anchor" id="setxkbmap"></a>
setxkbmap</h2>
<dl>
<dt><code>setxkbmap -print -layout â€¦</code></dt>
<dd></dd>
<dt></dt>
<dd><p class="startdd"></p>
<p class="interdd">Since 1.9 one can use the <code>--kccgst</code> option:</p>
<div class="fragment"><div class="line">xkbcli compile-keymap --kccgst --layout â€¦</div>
</div><!-- fragment -->  </dd>
<dt><code>setxkbmap -query</code> </dt>
<dd><p class="startdd"></p>
<p class="enddd">No equivalent: <code>xkbcli</code> only query <em>raw</em> keymaps and has no access to the original <a class="el" href="xkb-intro.html#RMLVO-intro">RMLVO</a> settings.  </p>
</dd>
<dt><code>setxkbmap -layout â€¦</code> </dt>
<dd><p class="startdd">No equivalent: <code>xkbcli</code> does not modify the display server keymap. One must use the tools <em>specific</em> to each display server in order order to achieve it.</p>
<p class="enddd">If you use a custom layout, please have a look at <a class="el" href="user-configuration.html">User-configuration</a>, which enables making custom layouts <em>discoverable</em> by keyboard configuration GUI.  </p>
</dd>
</dl>
<h2><a class="anchor" id="xkbcomp"></a>
xkbcomp</h2>
<dl>
<dt><code>xkbcomp -xkb /path/to/keymap/file -</code> </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli compile-keymap --keymap /path/to/keymap/file</div>
</div><!-- fragment -->  </dd>
<dt><code>xkbcomp -xkb $DISPLAY -</code> </dt>
<dd><p class="startdd"></p>
<dl>
<dt>Wayland session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap-wayland</div>
</div><!-- fragment -->  </dd>
<dt>X11 session </dt>
<dd><p class="startdd"></p>
<div class="fragment"><div class="line">xkbcli dump-keymap-x11</div>
</div><!-- fragment -->  </dd>
</dl>
</dd>
<dt><code>xkbcomp - $DISPLAY</code> </dt>
<dd></dd>
<dt><code>xkbcomp /path/to/keymap/file $DISPLAY</code> </dt>
<dd><p class="startdd"></p>
<p class="enddd">No equivalent: <code>xkbcli</code> does not modify the display server keymap. One must use the tools <em>specific</em> to each display server in order order to achieve it. Please have a look at <a class="el" href="user-configuration.html">User-configuration</a>, which enables making custom layouts <em>discoverable</em> by keyboard configuration GUI.  </p>
</dd>
</dl>
<h1><a class="anchor" id="api-1"></a>
API</h1>
<h2><a class="anchor" id="modifiers"></a>
Modifiers</h2>
<h3><a class="anchor" id="how-to-get-the-virtual-to-real-modifiers-mappings"></a>
How to get the virtual to real modifiers mappings?</h3>
<p>The <a class="el" href="keymap-text-format-v1.html#virtual-modifier-def">virtual modifiers</a> mappings to <a class="el" href="keymap-text-format-v1.html#real-modifier-def">real modifiers</a> is an implementation detail. However, some applications may require it in order to interface with legacy code.</p>
<h4><a class="anchor" id="libxkbcommon--110"></a>
libxkbcommon â‰¥ 1.10</h4>
<p>Use the dedicated function <code><a class="el" href="group__components.html#ga5054d57a49a205cee0a01f4079f2fbf7" title="Get the mapping of a modifier by name.">xkb_keymap::xkb_keymap_mod_get_mask()</a></code>.</p>
<h4><a class="anchor" id="libxkbcommon--19"></a>
libxkbcommon â‰¤ 1.9</h4>
<p>Use the following snippet:</p>
<div class="fragment"><div class="line"><span class="comment">// Find the real modifier mapping of the virtual modifier `LevelThree`</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="xkbcommon-names_8h.html">xkbcommon/xkbcommon-names.h</a>&gt;</span></div>
<div class="line"><span class="keyword">const</span> <a class="code hl_typedef" href="xkbcommon_8h.html#a638bf7a52db06f383ce5a4ef99dfe539">xkb_mod_index_t</a> levelThree_idx = xkb_keymap_mod_get_index(keymap, <a class="code hl_define" href="group__virtual-modifier-names.html#gab7e939dd1d78f2abbee84ef149221eae">XKB_VMOD_NAME_LEVEL3</a>);</div>
<div class="line"><span class="keyword">const</span> <a class="code hl_typedef" href="xkbcommon_8h.html#a41b3ee62ae73ec041b68165bf97869e8">xkb_mod_mask_t</a> levelThree = UINT32_C(1) &lt;&lt; levelThree_idx;</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structxkb__state.html">xkb_state</a>* state = <a class="code hl_function" href="group__state.html#ga7981d274ae2e1d720bd55e0d81a4da5c">xkb_state_new</a>(keymap);</div>
<div class="line">assert(state); <span class="comment">// Please handle error properly</span></div>
<div class="line"><a class="code hl_function" href="group__state.html#gae59cdbcc380013e9f12db359728fa098">xkb_state_update_mask</a>(state, levelThree, 0, 0, 0, 0, 0);</div>
<div class="line"><span class="keyword">const</span> <a class="code hl_typedef" href="xkbcommon_8h.html#a41b3ee62ae73ec041b68165bf97869e8">xkb_mod_mask_t</a> levelThree_mapping = <a class="code hl_function" href="group__state.html#gacfdacf066f449b36550e366b398effb8">xkb_state_serialize_mods</a>(state, <a class="code hl_enumvalue" href="group__state.html#gga04e8eac0666cc64dee6f0d5a7a773a03a2357b9f2490e89ab2d549695ea49de4f">XKB_STATE_MODS_EFFECTIVE</a>);</div>
<div class="line"><a class="code hl_function" href="group__state.html#ga3f905c1383b32dcceb5feb9b9fdd0ce4">xkb_state_unref</a>(state);</div>
<div class="ttc" id="agroup__state_html_ga3f905c1383b32dcceb5feb9b9fdd0ce4"><div class="ttname"><a href="group__state.html#ga3f905c1383b32dcceb5feb9b9fdd0ce4">xkb_state::xkb_state_unref</a></div><div class="ttdeci">XKB_EXPORT void xkb_state_unref(struct xkb_state *state)</div><div class="ttdoc">Release a reference on a keybaord state object, and possibly free it.</div></div>
<div class="ttc" id="agroup__state_html_ga7981d274ae2e1d720bd55e0d81a4da5c"><div class="ttname"><a href="group__state.html#ga7981d274ae2e1d720bd55e0d81a4da5c">xkb_state::xkb_state_new</a></div><div class="ttdeci">XKB_EXPORT struct xkb_state * xkb_state_new(struct xkb_keymap *keymap)</div><div class="ttdoc">Create a new keyboard state object.</div></div>
<div class="ttc" id="agroup__state_html_gacfdacf066f449b36550e366b398effb8"><div class="ttname"><a href="group__state.html#gacfdacf066f449b36550e366b398effb8">xkb_state::xkb_state_serialize_mods</a></div><div class="ttdeci">XKB_EXPORT xkb_mod_mask_t xkb_state_serialize_mods(struct xkb_state *state, enum xkb_state_component components)</div><div class="ttdoc">The counterpart to xkb_state_update_mask for modifiers, to be used on the server side of serializatio...</div></div>
<div class="ttc" id="agroup__state_html_gae59cdbcc380013e9f12db359728fa098"><div class="ttname"><a href="group__state.html#gae59cdbcc380013e9f12db359728fa098">xkb_state::xkb_state_update_mask</a></div><div class="ttdeci">XKB_EXPORT enum xkb_state_component xkb_state_update_mask(struct xkb_state *state, xkb_mod_mask_t depressed_mods, xkb_mod_mask_t latched_mods, xkb_mod_mask_t locked_mods, xkb_layout_index_t depressed_layout, xkb_layout_index_t latched_layout, xkb_layout_index_t locked_layout)</div><div class="ttdoc">Update a keyboard state from a set of explicit masks.</div></div>
<div class="ttc" id="agroup__state_html_gga04e8eac0666cc64dee6f0d5a7a773a03a2357b9f2490e89ab2d549695ea49de4f"><div class="ttname"><a href="group__state.html#gga04e8eac0666cc64dee6f0d5a7a773a03a2357b9f2490e89ab2d549695ea49de4f">XKB_STATE_MODS_EFFECTIVE</a></div><div class="ttdeci">@ XKB_STATE_MODS_EFFECTIVE</div><div class="ttdoc">Effective modifiers, i.e.</div><div class="ttdef"><b>Definition</b> xkbcommon.h:1476</div></div>
<div class="ttc" id="agroup__virtual-modifier-names_html_gab7e939dd1d78f2abbee84ef149221eae"><div class="ttname"><a href="group__virtual-modifier-names.html#gab7e939dd1d78f2abbee84ef149221eae">XKB_VMOD_NAME_LEVEL3</a></div><div class="ttdeci">#define XKB_VMOD_NAME_LEVEL3</div><div class="ttdef"><b>Definition</b> xkbcommon-names.h:60</div></div>
<div class="ttc" id="astructxkb__state_html"><div class="ttname"><a href="structxkb__state.html">xkb_state</a></div><div class="ttdoc">Opaque keyboard state object.</div></div>
<div class="ttc" id="axkbcommon-names_8h_html"><div class="ttname"><a href="xkbcommon-names_8h.html">xkbcommon-names.h</a></div><div class="ttdoc">Predefined names for common modifiers and LEDs.</div></div>
<div class="ttc" id="axkbcommon_8h_html_a41b3ee62ae73ec041b68165bf97869e8"><div class="ttname"><a href="xkbcommon_8h.html#a41b3ee62ae73ec041b68165bf97869e8">xkb_mod_mask_t</a></div><div class="ttdeci">uint32_t xkb_mod_mask_t</div><div class="ttdoc">A mask of modifier indices.</div><div class="ttdef"><b>Definition</b> xkbcommon.h:225</div></div>
<div class="ttc" id="axkbcommon_8h_html_a638bf7a52db06f383ce5a4ef99dfe539"><div class="ttname"><a href="xkbcommon_8h.html#a638bf7a52db06f383ce5a4ef99dfe539">xkb_mod_index_t</a></div><div class="ttdeci">uint32_t xkb_mod_index_t</div><div class="ttdoc">Index of a modifier.</div><div class="ttdef"><b>Definition</b> xkbcommon.h:223</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
